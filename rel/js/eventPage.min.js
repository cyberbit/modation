var alarmRunning=!1,msgFunctions={},cacheKeys=["notifData","blobs","options"];function initSongs(){var a=new JSZip;$.getJSON(global.path.songs,function(t){var o=t.data,e=0,i=o.length;console.log("found %o songs",o.length),$.each(o,function(t,n){console.log("processing %o...",n.title),console.log("song meta: %o",n),$.getJSON(global.path.songs+"/"+n.id,function(t){e++;var o=atob(t.data.data);a.file(n.title+".sng",o),e==i&&a.generateAsync({type:"blob"}).then(function(t){saveAs(t,"songs.zip")})})})})}$(function(){function g(t){return t.matchAny({group:global.regex.groupLink,track:global.regex.trackLink})}function m(t,o,n){n=n||g(t);var e=global.watchlistModel[n];e.link=t;var i=$(o);if("track"==n){var a=parseInt(i.find(".stats .likes").text()),c=parseInt(i.find(".stats .downloads").text()),s=parseInt(i.find(".stats .comments").text());$.extend(e,{likes:a,downloads:c,comments:s})}else if("group"==n){var l=(i.find(".comments .comment:first .content > p").html()||"").hashCode(),r=parseInt(i.find(".stats a[href*=members] b").text()),f=parseInt(i.find(".stats a[href*=followers] b").text()),m=parseInt(i.find(".stats a[href*=tracks] b").text());$.extend(e,{lastComment:l,members:r,followers:f,tracks:m})}return{updates:e,type:n}}function t(i){var a=chrome.extension.getViews({type:"popup"}),c=localJSON("options")||{};modapi.login(function(o){if("feed"==i.name)try{if(o.success)alarmRunning?console.info("Alarm running, notification handler cancelled"):a.length?console.info("Popup open, notification handler cancelled"):(x("modation_login",""),alarmRunning=!0,console.log("Modation :: Check notifications"),$.get(global.path.feed,function(t){var k=$(t.deres()).find("aside").find(".notifications .notification"),v=[],w=[];k.find("a").attr("href",function(t,o){return global.path.home+o});var y=0;k.each(function(t,o){var n=$(o),e=n.find(".actions").children(),i=n.clone();i.find("time, .clear, .actions").remove();var a=i.find("a");i.find(".author").remove();var c="modation"+n.find(".clear").attr("href").match(/(?:\/)(\d+)/)[1],s=n.find("time").text(),l=n.find(".author"),r=l.text(),f=l.attr("href"),m=i.text().trim(),d=a.last().attr("href"),u=n.find(".clear").attr("href"),g=[];if(e.each(function(){g.push({title:$(this).text(),link:$(this).attr("href"),data:$(this).data()})}),d.match(global.regex.messageLink)){if(-1!=$.inArray(d,v))return;v.push(d)}w.push(c);var h=d.match(global.regex.groupLink),p=localJSON("blobs")||{};function b(t){var o={type:"basic",iconUrl:t,title:r,message:m,contextMessage:s,buttons:g.map(function(t){return{title:t.title}})};function n(){x(c,{notif:o,link:d,clear:u,actions:g}),++y==k.length&&S()}x(c)?n():chrome.notifications.create(c,o,function(){n()})}p[h?d:f]?b(p[h?d:f]):$.get(h?d:f,function(t){var o=$(t).find((h?".top .inner .container":"aside")+" img").attr("src");getDataUri("img/newiconflat128.png",o,function(t){var o=localJSON("blobs")||{};o[h?d:f]=t,localJSON("blobs",o),b(t)})})});var o=Object.keys(x()).filter(function(t){return t.match(/modation(\d)+/)});$.each(o.diff(w),function(t,o){chrome.notifications.clear(o),x(o,"")}),0===y&&S(),alarmRunning=!1}));else{console.warn("Could not login to Soundation"),crapi.badge({title:"Please login to view notifications",color:"gray",text:"?"});var t=[{title:"Login with Facebook",link:global.path.home+"/users/auth/facebook",data:{}},{title:"Login with Google",link:global.path.home+"/users/auth/google_oauth2",data:{}}],n={type:"basic",iconUrl:"img/newiconflat128.png",title:"Login to Soundation",message:"Click here to login, or use one of the buttons below.",buttons:t.map(function(t){return{title:t.title}})},e="modation_login";x(e)||chrome.notifications.create(e,n,function(){x(e,{notif:n,link:global.path.login,actions:t})}),alarmRunning=!1}}catch(t){console.error("Unknown error occurred: %o",t),alarmRunning=!1}else"watchlist"==i.name&&c.watchlist&&crapi.clone(["watchlist"],function(t){if(o.success){var d="undefined"==typeof testWatchlist?t.watchlist:testWatchlist,r=[],u=[],f=0;$.each(d,function(c,s){r[c]=s,u[c]={};var l=g(s.link);u[c].type=l,$.get(s.link,function(t){var o=$(t),n=m(s.link,o,l).updates;if("track"==l)u[c].title=o.find(".title").text().trim(),global.debug&&console.log("track %o: current %o, new %o",s.link,{likes:s.likes,downloads:s.downloads,comments:s.comments},n);else if("group"==l){var e=o.find(".comments .comment:first"),i=e.find(".comment-author"),a=e.find(".content > p");u[c].title=o.find(".group-hero-container-info > h2").text(),u[c].commentBody=a.text(),u[c].commentAuthor=i.text(),u[c].commentAuthorLink=i.find("a").attr("href"),global.debug&&console.log("group %o: current %o, new %o",s.link,{lastComment:s.lastComment,members:s.members,followers:s.followers,tracks:s.tracks},n)}r[c]=$.extend({},r[c],n)}).always(function(){if(++f==d.length){var m=[];$.each(r,function(t,o){var n=d[t],e=u[t];if(m[t]=[],"track"==e.type){var i=o.likes-n.likes,a=o.downloads-n.downloads,c=o.comments-n.comments;i&&m[t].push(i+" like"+(1==Math.abs(i)?"":"s")),a&&m[t].push(a+" download"+(1==Math.abs(a)?"":"s")),c&&m[t].push(c+" comment"+(1==Math.abs(c)?"":"s")),global.debug&&console.log("changes for track %o: %o",o.link,m[t])}else if("group"==e.type){var s=o.followers-n.followers,l=o.lastComment!==n.lastComment&&e.commentBody,r=o.members-n.members,f=o.tracks-n.tracks;l&&m[t].push("New comment from @"+e.commentAuthor),s&&m[t].push(s+" follower"+(1==Math.abs(s)?"":"s")),r&&m[t].push(r+" member"+(1==Math.abs(r)?"":"s")),f&&m[t].push(f+" track"+(1==Math.abs(f)?"":"s")),global.debug&&console.log("changes for group %o: %o",o.link,m[t])}}),f=0,$.each(m,function(t,o){var n=d[t],e="modationwatch"+n.link.hashCode(),i={type:"basic",iconUrl:"img/newiconflat128.png",title:u[t].title,message:o.join(", ")};function a(){++f,x(e,{notif:i,link:n.link}),f==m.length&&(crapi.updateAll({watchlist:r}),S())}o.length?x(e)?a():chrome.notifications.create(e,i,function(){a()}):++f})}})})}else console.info("Not logged in, skipping watchlist")})})}function x(t,o){var n=localStorage.notifData,e=n?$.parseJSON(n):{};if(void 0===t)return e;void 0===o&&(o=!1);var i=e[t];return""===o?delete e[t]:o&&(e[t]=o),localStorage.notifData=JSON.stringify(e),i}function S(){var t=Object.keys(x()).length,o=0===t?"No new notifications :(":t+" new notification"+(1<t?"s":"");crapi.badge({title:o,color:"red",text:t?String(t):""})}function o(){$.each(cacheKeys,function(t,o){delete localStorage[o]}),console.info("Cache cleared")}chrome.runtime.onInstalled.addListener(function(t){var a;o(),a=t,crapi.clone($.extend(!0,{},global.storageModel,{options:global.optionDefaults}),function(e){var i=crapi.manifest().version;function t(){var t=moment().format();localStorage.installed=t,localStorage.version=i,localJSON("options",e.options);var o={type:"basic",iconUrl:"img/newiconflat128.png",title:"Modation has updated!",message:"Click here to see what's new.",contextMessage:("update"==a.reason?"v"+a.previousVersion+" => ":"")+"v"+i},n="modation_update";chrome.notifications.create(n,o,function(){x(n,{notif:o,link:"http://djmarcolesco.me/modation/",actions:[]})})}e.version||(crapi.storage("local").clear(),crapi.storage("sync").clear(),console.info("No storage version, clearing storage")),e.version!==i||"update"==a.reason?crapi.updateAll($.extend(!0,{},global.storageModel,e,{version:i}),function(){console.info("Updated storage model"),t()}):t()})}),chrome.runtime.onStartup.addListener(function(){o(),crapi.clone({options:global.optionDefaults},function(t){console.log("cache options"),localJSON("options",t.options)}),S()}),chrome.runtime.onMessage.addListener(function(t,o,n){if(msgFunctions[t.action]&&msgFunctions[t.action](t,o,n),!0===t.async)return!0}),msgFunctions.confirm=function(t,o,n){n(confirm(t.msg))},msgFunctions.rememberMe=void(chrome.cookies&&chrome.cookies.onChanged.addListener(function(t){"explicit"!=t.cause&&localJSON("options").rememberMe&&chrome.cookies.get({url:global.path.cookie,name:global.cookie},function(t){(t=t||{}).session&&chrome.cookies.set({url:global.path.cookie,name:global.cookie,value:t.value,domain:t.domain,path:t.path,secure:t.secure,httpOnly:t.httpOnly,expirationDate:moment().add(1,"w").unix()},function(){})})})),msgFunctions.getSelf=function(t,o,n){chrome.management.getSelf(function(t){n(t)})},chrome.alarms.create("feed",{delayInMinutes:modapi.manifest.debug?0:1,periodInMinutes:1}),chrome.alarms.create("watchlist",{delayInMinutes:modapi.manifest.debug?0:1,periodInMinutes:10}),chrome.alarms.onAlarm.addListener(t),handle($("body"),"alarm.initAlarms",function(){t({name:"feed"}),t({name:"watchlist"})}),function(){function i(o,t,n){if(void 0!==n){var e=x(t).actions[n];e.data.method?$.post(e.link,{_method:e.data.method,authenticity_token:modapi.token()}):o=e.link}chrome.windows.getCurrent(function(t){chrome.tabs.create({windowId:t.id,url:o}),chrome.windows.update(t.id,{focused:!0})}),a(t)}function a(t){chrome.notifications.clear(t),x(t).clear&&$.post(x(t).clear,{_method:"delete",authenticity_token:modapi.token()}),x(t,""),S()}chrome.notifications.onClicked.addListener(function(t){var o=x(t);o&&i(o.link,t)}),chrome.notifications.onButtonClicked.addListener(function(t,o){var n=x(t);if(n){var e=n.actions[o];e.data.confirm?confirm(e.data.confirm)&&i(n.link,t,o):i(n.link,t,o)}}),chrome.notifications.onClosed.addListener(function(t,o){o&&a(t)}),msgFunctions.showAllNotifications=function(){var t;t=x(),$.each(t,function(t,o){chrome.notifications.create(t,o.notif,function(){})}),t.modation_login||S()}}(),msgFunctions.watchlistItemType=function(t,o,n){n(g(t.link))},msgFunctions.parseWatchlistItem=function(t,o,n){n(m(t.link,t.html,t.type))}});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV2ZW50UGFnZS5qcyJdLCJuYW1lcyI6WyJhbGFybVJ1bm5pbmciLCJtc2dGdW5jdGlvbnMiLCJjYWNoZUtleXMiLCJpbml0U29uZ3MiLCJ6aXAiLCJKU1ppcCIsIiQiLCJnZXRKU09OIiwiZ2xvYmFsIiwicGF0aCIsInNvbmdzIiwiZCIsImRhdGEiLCJwcm9jZXNzZWQiLCJ0b3RhbCIsImxlbmd0aCIsImNvbnNvbGUiLCJsb2ciLCJlYWNoIiwiaSIsInYiLCJ0aXRsZSIsImlkIiwic25nIiwiYXRvYiIsImZpbGUiLCJnZW5lcmF0ZUFzeW5jIiwidHlwZSIsInRoZW4iLCJibG9iIiwic2F2ZUFzIiwid2F0Y2hsaXN0SXRlbVR5cGUiLCJsaW5rIiwibWF0Y2hBbnkiLCJncm91cCIsInJlZ2V4IiwiZ3JvdXBMaW5rIiwidHJhY2siLCJ0cmFja0xpbmsiLCJwYXJzZVdhdGNobGlzdEl0ZW0iLCJodG1sIiwidXBkYXRlcyIsIndhdGNobGlzdE1vZGVsIiwiJGh0bWwiLCJsaWtlcyIsInBhcnNlSW50IiwiZmluZCIsInRleHQiLCJkb3dubG9hZHMiLCJjb21tZW50cyIsImV4dGVuZCIsImxhc3RDb21tZW50IiwiaGFzaENvZGUiLCJtZW1iZXJzIiwiZm9sbG93ZXJzIiwidHJhY2tzIiwiYWxhcm1IYW5kbGVyIiwiYWxhcm0iLCJ2aWV3cyIsImNocm9tZSIsImV4dGVuc2lvbiIsImdldFZpZXdzIiwib3B0aW9ucyIsImxvY2FsSlNPTiIsIm1vZGFwaSIsImxvZ2luIiwibWUiLCJuYW1lIiwic3VjY2VzcyIsImluZm8iLCJub3RpZkRhdGEiLCJnZXQiLCJmZWVkIiwiJG5vdGlmaWNhdGlvbnMiLCJkZXJlcyIsIm1lc3NhZ2VMaW5rcyIsInNlcnZlck5vdGlmcyIsImF0dHIiLCJob21lIiwiZSIsIiRub3RpZiIsIiRhY3Rpb25zIiwiY2hpbGRyZW4iLCIkbXNnIiwiY2xvbmUiLCJyZW1vdmUiLCIkbGlua3MiLCJtYXRjaCIsInRpbWUiLCIkYXV0aG9yIiwiZnJvbSIsImZyb21MaW5rIiwibXNnIiwidHJpbSIsImxhc3QiLCJjbGVhciIsImFjdGlvbnMiLCJwdXNoIiwidGhpcyIsIm1lc3NhZ2VMaW5rIiwiaW5BcnJheSIsImlzR3JvdXAiLCJibG9icyIsIl9jb250aW51ZSIsIm5vdGlmIiwiaWNvblVybCIsIm1lc3NhZ2UiLCJjb250ZXh0TWVzc2FnZSIsImJ1dHRvbnMiLCJtYXAiLCJfdXBkYXRlRGF0YSIsInVwZGF0ZUJhZGdlIiwibm90aWZpY2F0aW9ucyIsImNyZWF0ZSIsImltZyIsImdldERhdGFVcmkiLCJsb2NhbE5vdGlmcyIsIk9iamVjdCIsImtleXMiLCJmaWx0ZXIiLCJkaWZmIiwid2FybiIsImNyYXBpIiwiYmFkZ2UiLCJjb2xvciIsImVycm9yIiwid2F0Y2hsaXN0IiwidGVzdFdhdGNobGlzdCIsIm1ldGEiLCJudW1Qcm9jZXNzZWQiLCJkZWJ1ZyIsIiRsYXN0Q29tbWVudCIsIiRsYXN0Q29tbWVudEF1dGhvciIsIiRsYXN0Q29tbWVudEJvZHkiLCJjb21tZW50Qm9keSIsImNvbW1lbnRBdXRob3IiLCJjb21tZW50QXV0aG9yTGluayIsImFsd2F5cyIsImNoYW5nZXMiLCJjdXJyZW50IiwibWV0dW0iLCJNYXRoIiwiYWJzIiwiam9pbiIsInVwZGF0ZUFsbCIsInZhbHVlIiwibm90aWZzSlNPTiIsImxvY2FsU3RvcmFnZSIsIm5vdGlmcyIsInBhcnNlSlNPTiIsIkpTT04iLCJzdHJpbmdpZnkiLCJTdHJpbmciLCJjbGVhckNhY2hlIiwicnVudGltZSIsIm9uSW5zdGFsbGVkIiwiYWRkTGlzdGVuZXIiLCJkZXRhaWxzIiwic3RvcmFnZU1vZGVsIiwib3B0aW9uRGVmYXVsdHMiLCJ2ZXJzaW9uIiwibWFuaWZlc3QiLCJub3ciLCJtb21lbnQiLCJmb3JtYXQiLCJpbnN0YWxsZWQiLCJyZWFzb24iLCJwcmV2aW91c1ZlcnNpb24iLCJzdG9yYWdlIiwib25TdGFydHVwIiwib25NZXNzYWdlIiwic2VuZGVyIiwicmVzcG9uc2UiLCJhY3Rpb24iLCJhc3luYyIsImNvbmZpcm0iLCJyZW1lbWJlck1lIiwiY29va2llcyIsIm9uQ2hhbmdlZCIsImNhdXNlIiwidXJsIiwiY29va2llIiwic2Vzc2lvbiIsInNldCIsImRvbWFpbiIsInNlY3VyZSIsImh0dHBPbmx5IiwiZXhwaXJhdGlvbkRhdGUiLCJhZGQiLCJ1bml4IiwiZ2V0U2VsZiIsIm1hbmFnZW1lbnQiLCJyZXN1bHQiLCJhbGFybXMiLCJkZWxheUluTWludXRlcyIsInBlcmlvZEluTWludXRlcyIsIm9uQWxhcm0iLCJoYW5kbGUiLCJfZm9sbG93IiwiYnRuIiwibWV0aG9kIiwicG9zdCIsIl9tZXRob2QiLCJhdXRoZW50aWNpdHlfdG9rZW4iLCJ0b2tlbiIsIndpbmRvd3MiLCJnZXRDdXJyZW50Iiwid2luZG93IiwidGFicyIsIndpbmRvd0lkIiwidXBkYXRlIiwiZm9jdXNlZCIsIl9jbGVhciIsIm9uQ2xpY2tlZCIsIm5vdGlmSWQiLCJvbkJ1dHRvbkNsaWNrZWQiLCJvbkNsb3NlZCIsInVzZXIiLCJzaG93QWxsTm90aWZpY2F0aW9ucyIsIm1vZGF0aW9uX2xvZ2luIiwiaW5pdE5vdGlmcyJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBSUEsY0FBZSxFQUdmQyxhQUFlLEdBR2ZDLFVBQVksQ0FBQyxZQUFhLFFBQVMsV0FFdkMsU0FBU0MsWUFDUixJQUFJQyxFQUFNLElBQUlDLE1BRWRDLEVBQUVDLFFBQVFDLE9BQU9DLEtBQUtDLE1BQU8sU0FBVUMsR0FDdEMsSUFBSUQsRUFBUUMsRUFBRUMsS0FDVkMsRUFBWSxFQUNaQyxFQUFRSixFQUFNSyxPQUVsQkMsUUFBUUMsSUFBSSxpQkFBa0JQLEVBQU1LLFFBR3BDVCxFQUFFWSxLQUFLUixFQUFPLFNBQVVTLEVBQUdDLEdBQzFCSixRQUFRQyxJQUFJLG1CQUFvQkcsRUFBRUMsT0FDbENMLFFBQVFDLElBQUksZ0JBQWlCRyxHQUc3QmQsRUFBRUMsUUFBUUMsT0FBT0MsS0FBS0MsTUFBUSxJQUFNVSxFQUFFRSxHQUFJLFNBQVVYLEdBQ25ERSxJQUVBLElBQUlVLEVBQU1D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T3VFLGdCQUFnQjVHLEtBbjdCN0I2RyxHQTZTQzNOLGFBQWE4QixrQkFBb0IsU0FBUzZELEVBQUsrRSxFQUFRQyxHQUN0REEsRUFBUzdJLEVBQWtCNkQsRUFBSTVELFFBR2hDL0IsYUFBYXNDLG1CQUFxQixTQUFTcUQsRUFBSytFLEVBQVFDLEdBQ3ZEQSxFQUFTckksRUFBbUJxRCxFQUFJNUQsS0FBTTRELEVBQUlwRCxLQUFNb0QsRUFBSWpFIiwiZmlsZSI6ImV2ZW50UGFnZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL1N3aXRjaCBmb3IgYWxhcm0gc3RhdGVcclxudmFyIGFsYXJtUnVubmluZyA9IGZhbHNlO1xyXG5cclxuLy9TdG9yYWdlIGZvciBydW50aW1lIGV2ZW50IGZ1bmN0aW9uc1xyXG52YXIgbXNnRnVuY3Rpb25zID0ge307XHJcblxyXG4vLyBTdG9yYWdlIGNhY2hlIGtleXNcclxudmFyIGNhY2hlS2V5cyA9IFtcIm5vdGlmRGF0YVwiLCBcImJsb2JzXCIsIFwib3B0aW9uc1wiXTtcclxuXHJcbmZ1bmN0aW9uIGluaXRTb25ncygpIHtcclxuXHR2YXIgemlwID0gbmV3IEpTWmlwKCk7XHJcblxyXG5cdCQuZ2V0SlNPTihnbG9iYWwucGF0aC5zb25ncywgZnVuY3Rpb24gKGQpIHtcclxuXHRcdHZhciBzb25ncyA9IGQuZGF0YTtcclxuXHRcdHZhciBwcm9jZXNzZWQgPSAwO1xyXG5cdFx0dmFyIHRvdGFsID0gc29uZ3MubGVuZ3RoO1xyXG5cclxuXHRcdGNvbnNvbGUubG9nKCdmb3VuZCAlbyBzb25ncycsIHNvbmdzLmxlbmd0aCk7XHJcblxyXG5cdFx0Ly8gSXRlcmF0ZSBzb25nc1xyXG5cdFx0JC5lYWNoKHNvbmdzLCBmdW5jdGlvbiAoaSwgdikge1xyXG5cdFx0XHRjb25zb2xlLmxvZygncHJvY2Vzc2luZyAlby4uLicsIHYudGl0bGUpO1xyXG5cdFx0XHRjb25zb2xlLmxvZygnc29uZyBtZXRhOiAlbycsIHYpO1xyXG5cclxuXHRcdFx0Ly8gR2V0IHNvbmcgZGF0YVxyXG5cdFx0XHQkLmdldEpTT04oZ2xvYmFsLnBhdGguc29uZ3MgKyAnLycgKyB2LmlkLCBmdW5jdGlvbiAoZCkge1xyXG5cdFx0XHRcdHByb2Nlc3NlZCsrO1xyXG5cclxuXHRcdFx0XHR2YXIgc25nID0gYXRvYihkLmRhdGEuZGF0YSk7XHJcblxyXG5cdFx0XHRcdHppcC5maWxlKHYudGl0bGUgKyAnLnNuZycsIHNuZyk7XHJcblxyXG5cdFx0XHRcdC8vIE9uY2UgYWxsIGl0ZW1zIGFyZSBwcm9jZXNzZWQsIGV4cG9ydCBzb25nc1xyXG5cdFx0XHRcdGlmIChwcm9jZXNzZWQgPT0gdG90YWwpIHtcclxuXHRcdFx0XHRcdF9leHBvcnRaaXAoKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcblxyXG5cdGZ1bmN0aW9uIF9leHBvcnRaaXAoKSB7XHJcblx0XHQvLyBFeHBvcnQgWklQIGZpbGVcclxuXHRcdHppcC5nZW5lcmF0ZUFzeW5jKHsgdHlwZTogXCJibG9iXCIgfSkudGhlbihmdW5jdGlvbiAoYmxvYikge1xyXG5cdFx0ICAgIHNhdmVBcyhibG9iLCBcInNvbmdzLnppcFwiKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuJChmdW5jdGlvbigpIHtcclxuXHQvL0luaXRpYWxpemUgYWxsIHRoZSB0aGluZ3NcclxuXHRpbml0RXZlbnRzKCk7XHJcblx0aW5pdEFsYXJtcygpO1xyXG5cdGluaXROb3RpZnMoKTtcclxuXHRpbml0V2F0Y2hsaXN0KCk7XHJcblx0Ly9pbml0Q29va2llcygpO1xyXG5cclxuXHQvL0luaXRpYWxpemUgcnVudGltZSBldmVudCBoYW5kbGVyXHJcblx0ZnVuY3Rpb24gaW5pdEV2ZW50cygpIHtcclxuXHRcdC8vIFJ1bnRpbWUgaW5zdGFsbGVkIGhhbmRsZXJcclxuXHRcdGNocm9tZS5ydW50aW1lLm9uSW5zdGFsbGVkLmFkZExpc3RlbmVyKGZ1bmN0aW9uKGRldGFpbHMpIHtcclxuICAgICAgICAgICAgY2xlYXJDYWNoZSgpO1xyXG5cdFx0XHRpbml0VXBkYXRlKGRldGFpbHMpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gUnVudGltZSBzdGFydHVwIGhhbmRsZXJcclxuXHRcdGNocm9tZS5ydW50aW1lLm9uU3RhcnR1cC5hZGRMaXN0ZW5lcihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY2xlYXJDYWNoZSgpO1xyXG5cdFx0XHRjYWNoZU9wdGlvbnMoKTtcclxuXHRcdFx0dXBkYXRlQmFkZ2UoKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFJ1bnRpbWUgbWVzc2FnZSBoYW5kbGVyXHJcblx0XHRjaHJvbWUucnVudGltZS5vbk1lc3NhZ2UuYWRkTGlzdGVuZXIoZnVuY3Rpb24obXNnLCBzZW5kZXIsIHJlc3BvbnNlKSB7XHJcblx0XHRcdC8vIFBhc3MgbWVzc2FnZSBkYXRhIHRvIGV2ZW50IGhhbmRsZXJcclxuXHRcdFx0aWYgKG1zZ0Z1bmN0aW9uc1ttc2cuYWN0aW9uXSkgbXNnRnVuY3Rpb25zW21zZy5hY3Rpb25dKG1zZywgc2VuZGVyLCByZXNwb25zZSk7XHJcblxyXG5cdFx0XHQvLyBBbGxvdyBhc3luY2hyb25vdXMgbWVzc2FnZVxyXG5cdFx0XHQvLyAoc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8yMDA3Nzg1NC8zNDAyODU0KVxyXG5cdFx0XHRpZiAobXNnLmFzeW5jID09PSB0cnVlKSByZXR1cm4gdHJ1ZTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFJlbW90ZSBjb25maXJtIGhhbmRsZXJcclxuXHRcdG1zZ0Z1bmN0aW9ucy5jb25maXJtID0gZnVuY3Rpb24obXNnLCBzZW5kZXIsIHJlc3BvbnNlKSB7XHJcblx0XHRcdHJlc3BvbnNlKGNvbmZpcm0obXNnLm1zZykpO1xyXG5cdFx0fTtcclxuXHJcblx0XHQvLyBcIlJlbWVtYmVyIG1lXCIgaGFuZGxlclxyXG5cdFx0KG1zZ0Z1bmN0aW9ucy5yZW1lbWJlck1lID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vIENvb2tpZSBjaGFuZ2UgaGFuZGxlclxyXG5cdFx0XHRpZiAoY2hyb21lLmNvb2tpZXMpIGNocm9tZS5jb29raWVzLm9uQ2hhbmdlZC5hZGRMaXN0ZW5lcihmdW5jdGlvbihpbmZvKSB7XHJcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImNvb2tpZSBpbmZvOiAlb1wiLCBpbmZvKTtcclxuXHJcblx0XHRcdFx0aWYgKGluZm8uY2F1c2UgIT0gXCJleHBsaWNpdFwiKSBpbml0Q29va2llcygpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0oKSk7XHJcblxyXG5cdFx0Ly8gUmV0dXJuIG1hbmFnZW1lbnQgaW5mb3JtYXRpb25cclxuXHRcdG1zZ0Z1bmN0aW9ucy5nZXRTZWxmID0gZnVuY3Rpb24obXNnLCBzZW5kZXIsIHJlc3BvbnNlKSB7XHJcblx0XHRcdC8vIHJlc3BvbnNlKFsxLDIsM10pO1xyXG5cdFx0XHRjaHJvbWUubWFuYWdlbWVudC5nZXRTZWxmKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuXHRcdFx0XHQvLyByZXNwb25zZShbMSwyLDNdKTtcclxuXHRcdFx0XHQvLyBjb25zb2xlLmxvZygnZXZlbnRQYWdlOiAlbycsIHJlc3VsdCk7XHJcblx0XHRcdFx0cmVzcG9uc2UocmVzdWx0KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0Ly9Jbml0aWFsaXplIHVwZGF0ZVxyXG5cdGZ1bmN0aW9uIGluaXRVcGRhdGUoZGV0YWlscykge1xyXG5cdFx0Ly9jb25zb2xlLmxvZyhcImluaXRVcGRhdGU6ICVvXCIsIGRldGFpbHMpO1xyXG5cclxuXHRcdC8vIENsb25lIHN0b3JhZ2VcclxuXHRcdGNyYXBpLmNsb25lKCQuZXh0ZW5kKHRydWUsIHt9LCBnbG9iYWwuc3RvcmFnZU1vZGVsLCB7b3B0aW9uczogZ2xvYmFsLm9wdGlvbkRlZmF1bHRzfSksIGZ1bmN0aW9uKGQpIHtcclxuXHRcdFx0dmFyIHZlcnNpb24gPSBjcmFwaS5tYW5pZmVzdCgpLnZlcnNpb247XHJcblxyXG5cdFx0XHQvLyBObyBzdG9yYWdlIHZlcnNpb25cclxuXHRcdFx0aWYgKCFkLnZlcnNpb24pIHtcclxuXHRcdFx0XHQvLyBDbGVhciBhbGwgc3RvcmFnZVxyXG5cdFx0XHRcdGNyYXBpLnN0b3JhZ2UoXCJsb2NhbFwiKS5jbGVhcigpO1xyXG5cdFx0XHRcdGNyYXBpLnN0b3JhZ2UoXCJzeW5jXCIpLmNsZWFyKCk7XHJcblxyXG5cdFx0XHRcdGNvbnNvbGUuaW5mbyhcIk5vIHN0b3JhZ2UgdmVyc2lvbiwgY2xlYXJpbmcgc3RvcmFnZVwiKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gU3RvcmFnZSBhbmQgYXBwIHZlcnNpb25zIGRvbid0IG1hdGNoXHJcblx0XHRcdGlmIChkLnZlcnNpb24gIT09IHZlcnNpb24gfHwgZGV0YWlscy5yZWFzb24gPT0gXCJ1cGRhdGVcIikge1xyXG5cdFx0XHRcdC8vIFVwZGF0ZSBzdG9yYWdlIG1vZGVsXHJcblx0XHRcdFx0Y3JhcGkudXBkYXRlQWxsKCQuZXh0ZW5kKHRydWUsIHt9LCBnbG9iYWwuc3RvcmFnZU1vZGVsLCBkLCB7dmVyc2lvbjogdmVyc2lvbn0pLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUuaW5mbyhcIlVwZGF0ZWQgc3RvcmFnZSBtb2RlbFwiKTtcclxuXHJcblx0XHRcdFx0XHRfY29udGludWUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gU3RvcmFnZSBhbmQgYXBwIHZlcnNpb25zIG1hdGNoXHJcblx0XHRcdGVsc2UgX2NvbnRpbnVlKCk7XHJcblxyXG5cdFx0XHRmdW5jdGlvbiBfY29udGludWUoKSB7XHJcblx0XHRcdFx0Ly9TZXQgdXAgaW5zdGFsbGF0aW9uIG1ldGFkYXRhXHJcblx0XHRcdFx0dmFyIG5vdyA9IG1vbWVudCgpLmZvcm1hdCgpO1xyXG5cdFx0XHRcdGxvY2FsU3RvcmFnZS5pbnN0YWxsZWQgPSBub3c7XHJcblx0XHRcdFx0bG9jYWxTdG9yYWdlLnZlcnNpb24gPSB2ZXJzaW9uO1xyXG5cclxuXHRcdFx0XHQvLyBDYWNoZSBvcHRpb25zXHJcblx0XHRcdFx0bG9jYWxKU09OKFwib3B0aW9uc1wiLCBkLm9wdGlvbnMpO1xyXG5cclxuXHRcdFx0XHQvL1Nob3cgbmV3IGluc3RhbGwgbm90aWZpY2F0aW9uXHJcblx0XHRcdFx0dmFyIG5vdGlmID0ge1xyXG5cdFx0XHRcdFx0dHlwZTogXCJiYXNpY1wiLFxyXG5cdFx0XHRcdFx0aWNvblVybDogXCJpbWcvbmV3aWNvbmZsYXQxMjgucG5nXCIsXHJcblx0XHRcdFx0XHR0aXRsZTogXCJNb2RhdGlvbiBoYXMgdXBkYXRlZCFcIixcclxuXHRcdFx0XHRcdG1lc3NhZ2U6IFwiQ2xpY2sgaGVyZSB0byBzZWUgd2hhdCdzIG5ldy5cIixcclxuXHRcdFx0XHRcdGNvbnRleHRNZXNzYWdlOiAoZGV0YWlscy5yZWFzb24gPT0gXCJ1cGRhdGVcIiA/IFwidlwiICsgZGV0YWlscy5wcmV2aW91c1ZlcnNpb24gKyBcIiA9PiBcIiA6IFwiXCIpICsgXCJ2XCIgKyB2ZXJzaW9uXHJcblx0XHRcdFx0fTtcclxuXHJcblx0XHRcdFx0Ly9TdG9yYWdlIGZvciBub3RpZiBJRFxyXG5cdFx0XHRcdHZhciBpZCA9IFwibW9kYXRpb25fdXBkYXRlXCI7XHJcblxyXG5cdFx0XHRcdC8vVXBkYXRlIG5vdGlmaWNhdGlvbiwgb3IgY3JlYXRlIGlmIG5lZWRlZFxyXG5cdFx0XHRcdGNocm9tZS5ub3RpZmljYXRpb25zLmNyZWF0ZShpZCwgbm90aWYsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly9pZiAoIXVwZGF0ZWQpIGNocm9tZS5ub3RpZmljYXRpb25zLmNyZWF0ZShpZCwgbm90aWYpO1xyXG5cclxuXHRcdFx0XHRcdC8vVXBkYXRlIG5vdGlmaWNhdGlvbiBkYXRhXHJcblx0XHRcdFx0XHRub3RpZkRhdGEoaWQsIHtcclxuXHRcdFx0XHRcdFx0bm90aWY6IG5vdGlmLFxyXG5cdFx0XHRcdFx0XHRsaW5rOiBcImh0dHA6Ly9kam1hcmNvbGVzY28ubWUvbW9kYXRpb24vXCIsXHJcblx0XHRcdFx0XHRcdGFjdGlvbnM6IFtdXHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvLyBJbml0aWFsaXplIGFsYXJtc1xyXG5cdGZ1bmN0aW9uIGluaXRBbGFybXMoKSB7XHJcblx0XHQvLyBGZWVkIGFsYXJtXHJcblx0XHRjaHJvbWUuYWxhcm1zLmNyZWF0ZShcImZlZWRcIiwge1xyXG5cdFx0XHRkZWxheUluTWludXRlczogKG1vZGFwaS5tYW5pZmVzdC5kZWJ1ZyA/IDAgOiAxKSxcclxuXHRcdFx0cGVyaW9kSW5NaW51dGVzOiAxXHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBXYXRjaGxpc3QgYWxhcm1cclxuXHRcdGNocm9tZS5hbGFybXMuY3JlYXRlKFwid2F0Y2hsaXN0XCIsIHtcclxuXHRcdFx0ZGVsYXlJbk1pbnV0ZXM6IChtb2RhcGkubWFuaWZlc3QuZGVidWcgPyAwIDogMSksXHJcblx0XHRcdHBlcmlvZEluTWludXRlczogMTBcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEFsYXJtIGhhbmRsZXJcclxuXHRcdGNocm9tZS5hbGFybXMub25BbGFybS5hZGRMaXN0ZW5lcihhbGFybUhhbmRsZXIpO1xyXG5cclxuXHRcdC8vIE1hbnVhbGx5IHJ1biBhbGwgYWxhcm1zOiAkKFwiYm9keVwiKS50cmlnZ2VyKFwiYWxhcm1cIilcclxuXHRcdGhhbmRsZSgkKFwiYm9keVwiKSwgXCJhbGFybS5pbml0QWxhcm1zXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRhbGFybUhhbmRsZXIoe25hbWU6IFwiZmVlZFwifSk7XHJcblx0XHRcdGFsYXJtSGFuZGxlcih7bmFtZTogXCJ3YXRjaGxpc3RcIn0pO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvL0luaXRpYWxpemUgbm90aWZpY2F0aW9uc1xyXG5cdGZ1bmN0aW9uIGluaXROb3RpZnMoKSB7XHJcblx0XHQvL0NsaWNrIGhhbmRsZXJcclxuXHRcdGNocm9tZS5ub3RpZmljYXRpb25zLm9uQ2xpY2tlZC5hZGRMaXN0ZW5lcihmdW5jdGlvbihub3RpZklkKSB7XHJcblx0XHRcdHZhciBkYXRhID0gbm90aWZEYXRhKG5vdGlmSWQpO1xyXG5cclxuXHRcdFx0Ly9Ob3RpZmljYXRpb24gZGF0YSBleGlzdHNcclxuXHRcdFx0aWYgKGRhdGEpIHtcclxuXHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiY2xpY2tlZCBub3RpZmljYXRpb246ICVvLCB0cmF2ZWxpbmcgdG8gJW9cIiwgZGF0YS5ub3RpZiwgZGF0YS5saW5rKTtcclxuXHJcblx0XHRcdFx0Ly9Gb2xsb3cgbGluayBhbmQgY2xlYXIgbm90aWZpY2F0aW9uXHJcblx0XHRcdFx0X2ZvbGxvdyhkYXRhLmxpbmssIG5vdGlmSWQpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHQvL0J1dHRvbiBoYW5kbGVyXHJcblx0XHRjaHJvbWUubm90aWZpY2F0aW9ucy5vbkJ1dHRvbkNsaWNrZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24obm90aWZJZCwgaSkge1xyXG5cdFx0XHR2YXIgZGF0YSA9IG5vdGlmRGF0YShub3RpZklkKTtcclxuXHJcblx0XHRcdC8vTm90aWZpY2F0aW9uIGRhdGEgZXhpc3RzXHJcblx0XHRcdGlmIChkYXRhKSB7XHJcblx0XHRcdFx0dmFyIGJ0biA9IGRhdGEuYWN0aW9uc1tpXTtcclxuXHJcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImNsaWNrZWQgYnV0dG9uOiAlb1wiLCBidG4pO1xyXG5cclxuXHRcdFx0XHQvL0NvbmZpcm1hdGlvbiByZXF1aXJlZFxyXG5cdFx0XHRcdGlmIChidG4uZGF0YS5jb25maXJtKSB7XHJcblx0XHRcdFx0XHRpZiAoY29uZmlybShidG4uZGF0YS5jb25maXJtKSkge1xyXG5cdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwiYWN0aW9uIGNvbmZpcm1lZFwiKTtcclxuXHJcblx0XHRcdFx0XHRcdC8vRm9sbG93IGxpbmsgYW5kIGNsZWFyIG5vdGlmaWNhdGlvblxyXG5cdFx0XHRcdFx0XHRfZm9sbG93KGRhdGEubGluaywgbm90aWZJZCwgaSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvL0NvbmZpcm1hdGlvbiBub3QgcmVxdWlyZWRcclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdC8vRm9sbG93IGxpbmsgYW5kIGNsZWFyIG5vdGlmaWNhdGlvblxyXG5cdFx0XHRcdFx0X2ZvbGxvdyhkYXRhLmxpbmssIG5vdGlmSWQsIGkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly9DbG9zZSBoYW5kbGVyXHJcblx0XHRjaHJvbWUubm90aWZpY2F0aW9ucy5vbkNsb3NlZC5hZGRMaXN0ZW5lcihmdW5jdGlvbihub3RpZklkLCB1c2VyKSB7XHJcblx0XHRcdGlmICh1c2VyKSB7XHJcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImNsb3NlZCBieSB1c2VyOiAlb1wiLCBub3RpZkRhdGEobm90aWZJZCkpO1xyXG5cclxuXHRcdFx0XHQvL0NsZWFyIG5vdGlmaWNhdGlvblxyXG5cdFx0XHRcdF9jbGVhcihub3RpZklkKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly9TaG93IGFsbCBub3RpZmljYXRpb25zIGhhbmRsZXJcclxuXHRcdG1zZ0Z1bmN0aW9ucy5zaG93QWxsTm90aWZpY2F0aW9ucyA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRzaG93QWxsTm90aWZzKCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGZ1bmN0aW9uIF9mb2xsb3cobGluaywgaWQsIGkpIHtcclxuXHRcdFx0Ly9EbyBhY3Rpb24sIGlmIG5lZWRlZFxyXG5cdFx0XHRpZiAodHlwZW9mIGkgIT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0XHRcdHZhciBidG4gPSBub3RpZkRhdGEoaWQpLmFjdGlvbnNbaV07XHJcblxyXG5cdFx0XHRcdC8vTm8gbWV0aG9kLCBmb2xsb3cgYWN0aW9uIGxpbmtcclxuXHRcdFx0XHRpZiAoIWJ0bi5kYXRhLm1ldGhvZCkgbGluayA9IGJ0bi5saW5rO1xyXG5cclxuXHRcdFx0XHQvL01ldGhvZCBleGlzdHMsIHJ1biBhY3Rpb24gc2VwZXJhdGVseVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0JC5wb3N0KGJ0bi5saW5rLCB7X21ldGhvZDogYnRuLmRhdGEubWV0aG9kLCBhdXRoZW50aWNpdHlfdG9rZW46IG1vZGFwaS50b2tlbigpfSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvL0ZvbGxvdyBsaW5rXHJcblx0XHRcdGNocm9tZS53aW5kb3dzLmdldEN1cnJlbnQoZnVuY3Rpb24od2luZG93KSB7XHJcblx0XHRcdFx0Ly9DcmVhdGUgdGFiXHJcblx0XHRcdFx0Y2hyb21lLnRhYnMuY3JlYXRlKHtcclxuXHRcdFx0XHRcdHdpbmRvd0lkOiB3aW5kb3cuaWQsXHJcblx0XHRcdFx0XHR1cmw6IGxpbmtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0Ly9Gb2N1cyB3aW5kb3dcclxuXHRcdFx0XHRjaHJvbWUud2luZG93cy51cGRhdGUod2luZG93LmlkLCB7Zm9jdXNlZDogdHJ1ZX0pO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vQ2xlYXIgbm90aWZpY2F0aW9uXHJcblx0XHRcdF9jbGVhcihpZCk7XHJcblx0XHR9XHJcblxyXG5cdFx0ZnVuY3Rpb24gX2NsZWFyKGlkKSB7XHJcblx0XHRcdGNocm9tZS5ub3RpZmljYXRpb25zLmNsZWFyKGlkKTtcclxuXHJcblx0XHRcdC8vQ2xlYXIgcmVtb3RlIG5vdGlmaWNhdGlvbiwgaWYgbmVlZGVkXHJcblx0XHRcdGlmIChub3RpZkRhdGEoaWQpLmNsZWFyKSAkLnBvc3Qobm90aWZEYXRhKGlkKS5jbGVhciwge19tZXRob2Q6IFwiZGVsZXRlXCIsIGF1dGhlbnRpY2l0eV90b2tlbjogbW9kYXBpLnRva2VuKCl9KTtcclxuXHJcblx0XHRcdC8vQ2xlYXIgbm90aWYgZGF0YVxyXG5cdFx0XHRub3RpZkRhdGEoaWQsIFwiXCIpO1xyXG5cclxuXHRcdFx0Ly9VcGRhdGUgYmFkZ2VcclxuXHRcdFx0dXBkYXRlQmFkZ2UoKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGluaXRDb29raWVzKCkge1xyXG4gICAgICAgIHZhciBvcHRpb25zID0gbG9jYWxKU09OKFwib3B0aW9uc1wiKTtcclxuXHJcblx0XHQvL2NvbnNvbGUubG9nKFwiaW5pdENvb2tpZXM6ICVvXCIsIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpKTtcclxuXHJcbiAgICAgICAgLyovLyBPcHRpb24gbm90IGNhY2hlZFxyXG4gICAgICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5yZW1lbWJlck1lID09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgY3JhcGkuY2xvbmUoe29wdGlvbnM6IGdsb2JhbC5vcHRpb25EZWZhdWx0c30sIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgICAgIC8vIENhY2hlIG9wdGlvblxyXG4gICAgICAgICAgICAgICAgb3B0aW9ucy5yZW1lbWJlck1lID0gZC5vcHRpb25zLnJlbWVtYmVyTWU7XHJcbiAgICAgICAgICAgICAgICBsb2NhbEpTT04oXCJvcHRpb25zXCIsIG9wdGlvbnMpO1xyXG5cclxuICAgICAgICAgICAgICAgIF9jb250aW51ZShkLm9wdGlvbnMpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE9wdGlvbiBjYWNoZWRcclxuICAgICAgICBlbHNlIHsqL1xyXG4gICAgICAgICAgICBfY29udGludWUob3B0aW9ucyk7XHJcbiAgICAgICAgLyp9Ki9cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX2NvbnRpbnVlKG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgLy8gUmVtZW1iZXIgbWUgb3B0aW9uIGVuYWJsZWRcclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMucmVtZW1iZXJNZSkge1xyXG4gICAgICAgICAgICAgICAgY2hyb21lLmNvb2tpZXMuZ2V0KHt1cmw6IGdsb2JhbC5wYXRoLmNvb2tpZSwgbmFtZTogZ2xvYmFsLmNvb2tpZX0sIGZ1bmN0aW9uKGNvb2tpZSkge1xyXG5cdFx0XHRcdFx0Y29va2llID0gY29va2llIHx8IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBTZXNzaW9uIGNvb2tpZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjb29raWUuc2Vzc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaHJvbWUuY29va2llcy5zZXQoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBnbG9iYWwucGF0aC5jb29raWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBnbG9iYWwuY29va2llLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGNvb2tpZS52YWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvbWFpbjogY29va2llLmRvbWFpbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGNvb2tpZS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VjdXJlOiBjb29raWUuc2VjdXJlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHR0cE9ubHk6IGNvb2tpZS5odHRwT25seSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyYXRpb25EYXRlOiBtb21lbnQoKS5hZGQoMSwgXCJ3XCIpLnVuaXgoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJjb29raWU6ICVvLCBlcnJvcjogJW9cIiwgY29va2llLCBjaHJvbWUucnVudGltZS5sYXN0RXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcblx0ZnVuY3Rpb24gaW5pdFdhdGNobGlzdCgpIHtcclxuXHRcdC8qKlxyXG5cdFx0ICogVXNhZ2U6XHJcblx0XHQgKiBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZSh7YWN0aW9uOiBcInBhcnNlV2F0Y2hsaXN0SXRlbVwiLCBsaW5rOiBsb2NhdGlvbi5ocmVmLCBodG1sOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuaW5uZXJIVE1MfSwgZnVuY3Rpb24ocmVzdWx0KSB7XHJcblx0XHQgKiAgICAgY29uc29sZS5sb2coXCIlb1wiLCByZXN1bHQpO1xyXG5cdFx0ICogfSlcclxuXHRcdCAqL1xyXG5cdFx0bXNnRnVuY3Rpb25zLndhdGNobGlzdEl0ZW1UeXBlID0gZnVuY3Rpb24obXNnLCBzZW5kZXIsIHJlc3BvbnNlKSB7XHJcblx0XHRcdHJlc3BvbnNlKHdhdGNobGlzdEl0ZW1UeXBlKG1zZy5saW5rKSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdG1zZ0Z1bmN0aW9ucy5wYXJzZVdhdGNobGlzdEl0ZW0gPSBmdW5jdGlvbihtc2csIHNlbmRlciwgcmVzcG9uc2UpIHtcclxuXHRcdFx0cmVzcG9uc2UocGFyc2VXYXRjaGxpc3RJdGVtKG1zZy5saW5rLCBtc2cuaHRtbCwgbXNnLnR5cGUpKTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHQvLyBEZXRlcm1pbmUgd2F0Y2hsaXN0IHR5cGVcclxuXHRmdW5jdGlvbiB3YXRjaGxpc3RJdGVtVHlwZShsaW5rKSB7XHJcblx0XHRyZXR1cm4gbGluay5tYXRjaEFueSh7XHJcblx0XHRcdGdyb3VwOiBnbG9iYWwucmVnZXguZ3JvdXBMaW5rLFxyXG5cdFx0XHR0cmFjazogZ2xvYmFsLnJlZ2V4LnRyYWNrTGlua1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvLyBQYXJzZSBhbmQgcmV0dXJuIG1ldGFkYXRhIGZyb20gd2F0Y2hhYmxlIHBhZ2VcclxuXHRmdW5jdGlvbiBwYXJzZVdhdGNobGlzdEl0ZW0obGluaywgaHRtbCwgdHlwZSkge1xyXG5cdFx0dHlwZSA9IHR5cGUgfHwgd2F0Y2hsaXN0SXRlbVR5cGUobGluayk7XHJcblxyXG5cdFx0Ly8gRW5mb3JjZSB3YXRjaGxpc3QgbW9kZWxcclxuXHRcdHZhciB1cGRhdGVzID0gZ2xvYmFsLndhdGNobGlzdE1vZGVsW3R5cGVdO1xyXG5cdFx0dXBkYXRlcy5saW5rID0gbGluaztcclxuXHJcblx0XHR2YXIgJGh0bWwgPSAkKGh0bWwpO1xyXG5cclxuXHRcdC8vIFRyYWNrIGhhbmRsZXJcclxuXHRcdGlmICh0eXBlID09IFwidHJhY2tcIikge1xyXG5cdFx0XHR2YXIgbGlrZXMgPSBwYXJzZUludCgkaHRtbC5maW5kKFwiLnN0YXRzIC5saWtlc1wiKS50ZXh0KCkpO1xyXG5cdFx0XHR2YXIgZG93bmxvYWRzID0gcGFyc2VJbnQoJGh0bWwuZmluZChcIi5zdGF0cyAuZG93bmxvYWRzXCIpLnRleHQoKSk7XHJcblx0XHRcdHZhciBjb21tZW50cyA9IHBhcnNlSW50KCRodG1sLmZpbmQoXCIuc3RhdHMgLmNvbW1lbnRzXCIpLnRleHQoKSk7XHJcblxyXG5cdFx0XHQvLyBTdG9yZSB1cGRhdGVzXHJcblx0XHRcdCQuZXh0ZW5kKHVwZGF0ZXMsIHtcclxuXHRcdFx0XHRsaWtlczogbGlrZXMsXHJcblx0XHRcdFx0ZG93bmxvYWRzOiBkb3dubG9hZHMsXHJcblx0XHRcdFx0Y29tbWVudHM6IGNvbW1lbnRzXHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEdyb3VwIGhhbmRsZXJcclxuXHRcdGVsc2UgaWYgKHR5cGUgPT0gXCJncm91cFwiKSB7XHJcblx0XHRcdC8qKlxyXG5cdFx0XHQgKiBIZXJlLCBJJ20gdXNpbmcgdGhlIGhhc2ggb2YgdGhlIGNvbW1lbnQgYm9keSB0byBkZXRlcm1pbmUgaWYgdGhlIHRvcFxyXG5cdFx0XHQgKiBjb21tZW50IGlzIG5ldy4gSXQncyBub3QgaWRlYWwsIGJ1dCB0aGVyZSBpcyBzdWNoIHZhcmlhbmNlIGluIG90aGVyXHJcblx0XHRcdCAqIG1ldGhvZHMgdGhhdCBJJ3ZlIGRlY2lkZWQgdG8gZ28gdGhpcyB3YXkuIFRoZXJlIGFyZSBhIGZldyBkcmF3YmFja3M6XHJcblx0XHRcdCAqICAtIElmIHNvbWVvbmUgcG9zdHMgYSBuZXcgY29tbWVudCB3aXRoIGV4YWN0bHkgdGhlIHNhbWUgdGV4dCBhcyB0aGVcclxuXHRcdFx0ICogICAgcHJldmlvdXMgY29tbWVudCwgaXQgd2lsbCBub3QgYmUgZGV0ZWN0ZWRcclxuXHRcdFx0ICogIC0gSWYgYSBjb21tZW50IGlzIGRlbGV0ZWQgb3IgZmxhZ2dlZCBhbmQgaXMgc3RpbGwgYXQgdGhlIHRvcCBvZiB0aGVcclxuXHRcdFx0ICogICAgdGhyZWFkLCBpdCB3aWxsIGJlIGRldGVjdGVkIGFzIGEgbmV3IGNvbW1lbnRcclxuXHRcdFx0ICogIC0gSWYgYSBjb21tZW50IGJvZHkgY2Fubm90IGJlIGRldGVybWluZWQsIGEgYmxhbmsgc3RyaW5nIGlzIHVzZWQsXHJcblx0XHRcdCAqICAgIHdoaWNoIGNvdWxkIGNvbmZ1c2UgdGhlIHBhcnNlciBhbmQgY2F1c2UgYSBkZXRlY3Rpb24gbWlzc1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBUaGVyZSBhcmUgYWR2YW50YWdlcywgdGhvdWdoOlxyXG5cdFx0XHQgKiAgKyBObyBjb21wbGV4LCBidWdneSBJRCBkZXRlcm1pbmF0aW9uXHJcblx0XHRcdCAqICArIE5vdCBhZmZlY3RlZCBieSBsb2dpbiBzdGF0dXMgKGV4Y2VwdCBwcml2YXRlIGdyb3VwcyBhbmQgdHJhY2tzKVxyXG5cdFx0XHQgKiAgKyBJZ25vcmVzIHVzZXIgY2hhbmdlcyAocHJvZmlsZSBpbWFnZSwgdXNlcm5hbWUsIGxpbmssIGV0Yy4pXHJcblx0XHRcdCAqXHJcblx0XHRcdCAqID09PT09PT09PT09PT09PT1cclxuXHRcdFx0ICpcclxuXHRcdFx0ICogSG93ZXZlciwgdXNpbmcgYSBjb3VudCBmb3IgZGV0ZXJtaW5pbmcgbmV3IGNvbW1lbnRzIGhhcyBhIGJ1bmNoIG9mXHJcblx0XHRcdCAqIGFkdmFudGFnZXMgYXMgd2VsbDpcclxuXHRcdFx0ICogICsgQWJpbGl0eSB0byBkZXRlY3QgbXVsdGlwbGUgbmV3IGNvbW1lbnRzXHJcblx0XHRcdCAqICArIFNpbXBsZXIgcGFyc2luZ1xyXG5cdFx0XHQgKlxyXG5cdFx0XHQgKiBTb21lIGRpc2FkdmFudGFnZXM6XHJcblx0XHRcdCAqICAtIE5lZ2F0aXZlIGNoYW5nZXMgaW4gY29tbWVudHMgd291bGQgaGF2ZSB0byBiZSBzcGVjaWFsbHkgaGFuZGxlZFxyXG5cdFx0XHQgKiAgLSBHcm91cHMgZG8gbm90IGhhdmUgYW4gb2J2aW91cyBjb21tZW50IGNvdW50ZXIsIHNvIGl0IHdvdWxkIG5lZWQgdG9cclxuXHRcdFx0ICogICAgY2FsY3VsYXRlZCB2aWEgY29tbWVudCBwYWdlcyAocG90ZW50aWFsbHkgc2xvdyBhbmQgYnVnZ3kpXHJcblx0XHRcdCAqL1xyXG5cclxuXHRcdFx0dmFyIGxhc3RDb21tZW50Q29udGVudCA9ICRodG1sLmZpbmQoXCIuY29tbWVudHMgLmNvbW1lbnQ6Zmlyc3QgLmNvbnRlbnQgPiBwXCIpLmh0bWwoKSB8fCBcIlwiO1xyXG5cdFx0XHR2YXIgbGFzdENvbW1lbnQgPSBsYXN0Q29tbWVudENvbnRlbnQuaGFzaENvZGUoKTtcclxuXHRcdFx0dmFyIG1lbWJlcnMgPSBwYXJzZUludCgkaHRtbC5maW5kKFwiLnN0YXRzIGFbaHJlZio9bWVtYmVyc10gYlwiKS50ZXh0KCkpO1xyXG5cdFx0XHR2YXIgZm9sbG93ZXJzID0gcGFyc2VJbnQoJGh0bWwuZmluZChcIi5zdGF0cyBhW2hyZWYqPWZvbGxvd2Vyc10gYlwiKS50ZXh0KCkpO1xyXG5cdFx0XHR2YXIgdHJhY2tzID0gcGFyc2VJbnQoJGh0bWwuZmluZChcIi5zdGF0cyBhW2hyZWYqPXRyYWNrc10gYlwiKS50ZXh0KCkpO1xyXG5cclxuXHRcdFx0Ly8gU3RvcmUgdXBkYXRlc1xyXG5cdFx0XHQkLmV4dGVuZCh1cGRhdGVzLCB7XHJcblx0XHRcdFx0bGFzdENvbW1lbnQ6IGxhc3RDb21tZW50LFxyXG5cdFx0XHRcdG1lbWJlcnM6IG1lbWJlcnMsXHJcblx0XHRcdFx0Zm9sbG93ZXJzOiBmb2xsb3dlcnMsXHJcblx0XHRcdFx0dHJhY2tzOiB0cmFja3NcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0dXBkYXRlczogdXBkYXRlcyxcclxuXHRcdFx0dHlwZTogdHlwZVxyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdC8vTmV3IGFsYXJtIGhhbmRsZXJcclxuXHRmdW5jdGlvbiBhbGFybUhhbmRsZXIoYWxhcm0pIHtcclxuXHRcdHZhciB2aWV3cyA9IGNocm9tZS5leHRlbnNpb24uZ2V0Vmlld3Moe3R5cGU6IFwicG9wdXBcIn0pO1xyXG5cdFx0dmFyIG9wdGlvbnMgPSBsb2NhbEpTT04oXCJvcHRpb25zXCIpIHx8IHt9O1xyXG5cclxuICAgICAgICAvL0xvZ2luXHJcbiAgICAgICAgbW9kYXBpLmxvZ2luKGZ1bmN0aW9uKG1lKSB7XHJcbiAgICAgICAgICAgIC8vRmVlZCBhbGFybSBoYW5kbGVyXHJcbiAgICAgICAgICAgIGlmIChhbGFybS5uYW1lID09IFwiZmVlZFwiKSB7XHJcbiAgICAgICAgICAgICAgICAvL0hhbmRsZSB1bmtub3duIGVycm9yc1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAvL1VzZXIgaXMgbm90IGxvZ2dlZCBpblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbWUuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL0xvZyBmYWlsdXJlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybihcIkNvdWxkIG5vdCBsb2dpbiB0byBTb3VuZGF0aW9uXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9VcGRhdGUgYmFkZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3JhcGkuYmFkZ2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6IFwiUGxlYXNlIGxvZ2luIHRvIHZpZXcgbm90aWZpY2F0aW9uc1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IFwiZ3JheVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDogXCI/XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9ucyA9IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJMb2dpbiB3aXRoIEZhY2Vib29rXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogZ2xvYmFsLnBhdGguaG9tZSArIFwiL3VzZXJzL2F1dGgvZmFjZWJvb2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJMb2dpbiB3aXRoIEdvb2dsZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbms6IGdsb2JhbC5wYXRoLmhvbWUgKyBcIi91c2Vycy9hdXRoL2dvb2dsZV9vYXV0aDJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiB7fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5vdGlmID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJiYXNpY1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWNvblVybDogXCJpbWcvbmV3aWNvbmZsYXQxMjgucG5nXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogXCJMb2dpbiB0byBTb3VuZGF0aW9uXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkNsaWNrIGhlcmUgdG8gbG9naW4sIG9yIHVzZSBvbmUgb2YgdGhlIGJ1dHRvbnMgYmVsb3cuXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25zOiBhY3Rpb25zLm1hcChmdW5jdGlvbih2KSB7IHJldHVybiB7dGl0bGU6IHYudGl0bGV9OyB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9TdG9yYWdlIGZvciBub3RpZiBJRFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaWQgPSBcIm1vZGF0aW9uX2xvZ2luXCI7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL05vdGlmaWNhdGlvbiBub3Qgc2hvd24geWV0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbm90aWZEYXRhKGlkKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9VcGRhdGUgbm90aWZpY2F0aW9uLCBvciBjcmVhdGUgaWYgbmVlZGVkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHJvbWUubm90aWZpY2F0aW9ucy5jcmVhdGUoaWQsIG5vdGlmLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmICghdXBkYXRlZCkgY2hyb21lLm5vdGlmaWNhdGlvbnMuY3JlYXRlKGlkLCBub3RpZik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVXBkYXRlIG5vdGlmaWNhdGlvbiBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZEYXRhKGlkLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmOiBub3RpZixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogZ2xvYmFsLnBhdGgubG9naW4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnM6IGFjdGlvbnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1NldCBhbGFybSBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGFybVJ1bm5pbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vQWxhcm0gaXMgcnVubmluZ1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFsYXJtUnVubmluZykgY29uc29sZS5pbmZvKFwiQWxhcm0gcnVubmluZywgbm90aWZpY2F0aW9uIGhhbmRsZXIgY2FuY2VsbGVkXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvL1BvcHVwIGlzIG9wZW5cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh2aWV3cy5sZW5ndGgpIGNvbnNvbGUuaW5mbyhcIlBvcHVwIG9wZW4sIG5vdGlmaWNhdGlvbiBoYW5kbGVyIGNhbmNlbGxlZFwiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9Qb3B1cCBpcyBub3Qgb3BlblxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBDbGVhciBsb2dpbiBub3RpZmljYXRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgbm90aWZEYXRhKFwibW9kYXRpb25fbG9naW5cIiwgXCJcIik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvL1NldCBhbGFybSBzdGF0ZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhbGFybVJ1bm5pbmcgPSB0cnVlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJNb2RhdGlvbiA6OiBDaGVjayBub3RpZmljYXRpb25zXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy9HcmFiIGZlZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgJC5nZXQoZ2xvYmFsLnBhdGguZmVlZCwgZnVuY3Rpb24oaHRtbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRodG1sID0gJChodG1sLmRlcmVzKCkvKi5yZXBsYWNlKC88dGltZT4uKjxcXC90aW1lPi9pZywgXCJcIikqLyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGFzaWRlID0gJGh0bWwuZmluZChcImFzaWRlXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRub3RpZmljYXRpb25zID0gJGFzaWRlLmZpbmQoXCIubm90aWZpY2F0aW9ucyAubm90aWZpY2F0aW9uXCIpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU3RvcmFnZSBmb3IgbWVzc2FnZSBsaW5rc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VMaW5rcyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU3RvcmFnZSBmb3Igc2VydmVyIG5vdGlmaWNhdGlvbiBJRHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXJ2ZXJOb3RpZnMgPSBbXTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0FkZCBob3N0bmFtZSB0byBsaW5rc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG5vdGlmaWNhdGlvbnMuZmluZChcImFcIikuYXR0cihcImhyZWZcIiwgZnVuY3Rpb24oaSwgdikge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIGdsb2JhbC5wYXRoLmhvbWUgKyB2O1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0b3JhZ2UgZm9yIG51bWJlciBvZiBub3RpZmljYXRpb25zIHByb2Nlc3NlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHByb2Nlc3NlZCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9JdGVyYXRlIG5vdGlmaWNhdGlvbnNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRub3RpZmljYXRpb25zLmVhY2goZnVuY3Rpb24oaSwgZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vR3JhYiBlbGVtZW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkbm90aWYgPSAkKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkYWN0aW9ucyA9ICRub3RpZi5maW5kKFwiLmFjdGlvbnNcIikuY2hpbGRyZW4oKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG1zZyA9ICRub3RpZi5jbG9uZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtc2cuZmluZChcInRpbWUsIC5jbGVhciwgLmFjdGlvbnNcIikucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRsaW5rcyA9ICRtc2cuZmluZChcImFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1zZy5maW5kKFwiLmF1dGhvclwiKS5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9QYXJzZSBlbGVtZW50c1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpZCA9IFwibW9kYXRpb25cIiArICRub3RpZi5maW5kKFwiLmNsZWFyXCIpLmF0dHIoXCJocmVmXCIpLm1hdGNoKC8oPzpcXC8pKFxcZCspLylbMV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRpbWUgPSAkbm90aWYuZmluZChcInRpbWVcIikudGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkYXV0aG9yID0gJG5vdGlmLmZpbmQoXCIuYXV0aG9yXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmcm9tID0gJGF1dGhvci50ZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZyb21MaW5rID0gJGF1dGhvci5hdHRyKFwiaHJlZlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbXNnID0gJG1zZy50ZXh0KCkudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rID0gJGxpbmtzLmxhc3QoKS5hdHRyKFwiaHJlZlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2xlYXIgPSAkbm90aWYuZmluZChcIi5jbGVhclwiKS5hdHRyKFwiaHJlZlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9ucyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhY3Rpb25zLmVhY2goZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJCh0aGlzKS50ZXh0KCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rOiAkKHRoaXMpLmF0dHIoXCJocmVmXCIpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogJCh0aGlzKS5kYXRhKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE1hdGNoIG1lc3NhZ2UgbGlua3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluay5tYXRjaChnbG9iYWwucmVnZXgubWVzc2FnZUxpbmspKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFByZXZlbnQgZHVwbGljYXRlIG1lc3NhZ2Ugbm90aWZpY2F0aW9uIChpc3N1ZSAjNjMpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkLmluQXJyYXkobGluaywgbWVzc2FnZUxpbmtzKSAhPSAtMSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVtZW1iZXIgbGlua1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlua3MucHVzaChsaW5rKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCBub3RpZmljYXRpb24gSUQgdG8gc2VydmVyIGxpc3RcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2ZXJOb3RpZnMucHVzaChpZCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gRGV0ZXJtaW5lIGlmIG5vdGlmaWNhdGlvbiBpcyBncm91cC1yZWxhdGVkXHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgaXNHcm91cCA9IGxpbmsubWF0Y2goZ2xvYmFsLnJlZ2V4Lmdyb3VwTGluayk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBibG9icyA9IGxvY2FsSlNPTihcImJsb2JzXCIpIHx8IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBCbG9iIGlzIGNhY2hlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChibG9ic1soaXNHcm91cCA/IGxpbmsgOiBmcm9tTGluayldKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250aW51ZShibG9ic1soaXNHcm91cCA/IGxpbmsgOiBmcm9tTGluayldKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsb2IgaXMgbm90IGNhY2hlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHcmFiIGF1dGhvciBwcm9maWxlIHBhZ2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJC5nZXQoKGlzR3JvdXAgPyBsaW5rIDogZnJvbUxpbmspLCBmdW5jdGlvbihodG1sKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGh0bWwgPSAkKGh0bWwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGltZyA9ICRodG1sLmZpbmQoKGlzR3JvdXAgPyBcIi50b3AgLmlubmVyIC5jb250YWluZXJcIiA6IFwiYXNpZGVcIikgKyBcIiBpbWdcIikuYXR0cihcInNyY1wiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgYmxvYiBVUkxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldERhdGFVcmkoXCJpbWcvbmV3aWNvbmZsYXQxMjgucG5nXCIsIGltZywgZnVuY3Rpb24oYmxvYikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBibG9icyA9IGxvY2FsSlNPTihcImJsb2JzXCIpIHx8IHt9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDYWNoZSBibG9iXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmxvYnNbKGlzR3JvdXAgPyBsaW5rIDogZnJvbUxpbmspXSA9IGJsb2I7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxKU09OKFwiYmxvYnNcIiwgYmxvYnMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL19jb250aW51ZShcImltZy9uZXdpY29uZmxhdDEyOC5wbmdcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRpbnVlKGJsb2IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gX2NvbnRpbnVlKGJsb2IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXQgdXAgbm90aWZpY2F0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBub3RpZiA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYmFzaWNcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGljb25Vcmw6IGJsb2IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogZnJvbSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1zZyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHRNZXNzYWdlOiB0aW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uczogYWN0aW9ucy5tYXAoZnVuY3Rpb24odikgeyByZXR1cm4ge3RpdGxlOiB2LnRpdGxlfTsgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vTm90aWZpY2F0aW9uIG5vdCBzaG93biB5ZXRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFub3RpZkRhdGEoaWQpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaHJvbWUubm90aWZpY2F0aW9ucy5jcmVhdGUoaWQsIG5vdGlmLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmICghdXBkYXRlZCkgY2hyb21lLm5vdGlmaWNhdGlvbnMuY3JlYXRlKGlkLCBub3RpZik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF91cGRhdGVEYXRhKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9Ob3RpZmljYXRpb24gc2hvd25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdXBkYXRlRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1N0b3JlIG5vdGlmaWNhdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBfdXBkYXRlRGF0YSgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coXCJ1cGRhdGUgZGF0YTogJW9cIiwgaWQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vVXBkYXRlIG5vdGlmaWNhdGlvbiBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZkRhdGEoaWQsIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBub3RpZjogbm90aWYsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGluazogbGluayxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhcjogY2xlYXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aW9uczogYWN0aW9uc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKytwcm9jZXNzZWQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gUHJvY2Vzc2VkIGZpbmFsIG5vdGlmaWNhdGlvbiwgdXBkYXRlIGJhZGdlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJvY2Vzc2VkID09ICRub3RpZmljYXRpb25zLmxlbmd0aCkgdXBkYXRlQmFkZ2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vR2V0IGFsbCBsb2NhbCBmZWVkIG5vdGlmaWNhdGlvbnMgKHJlZ2V4IGZpbHRlcnMgb3V0IHdhdGNobGlzdCBpdGVtcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsb2NhbE5vdGlmcyA9IE9iamVjdC5rZXlzKG5vdGlmRGF0YSgpKS5maWx0ZXIoZnVuY3Rpb24odikge1xyXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHYubWF0Y2goL21vZGF0aW9uKFxcZCkrLyk7XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcImxvY2FsOiAlbywgc2VydmVyOiAlbywgZGlmZjogJW9cIiwgbG9jYWxOb3RpZnMsIHNlcnZlck5vdGlmcywgbG9jYWxOb3RpZnMuZGlmZihzZXJ2ZXJOb3RpZnMpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL0Rpc21pc3Mgbm90aWZpY2F0aW9ucyBubyBsb25nZXIgb24gc2VydmVyIChpc3N1ZSAjNjQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkLmVhY2gobG9jYWxOb3RpZnMuZGlmZihzZXJ2ZXJOb3RpZnMpLCBmdW5jdGlvbihpLCB2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hyb21lLm5vdGlmaWNhdGlvbnMuY2xlYXIodik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vQ2xlYXIgbm90aWYgZGF0YVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vdGlmRGF0YSh2LCBcIlwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vIG5vdGlmaWNhdGlvbnMgd2VyZSBwcm9jZXNzZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwcm9jZXNzZWQgPT09IDApIHVwZGF0ZUJhZGdlKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXQgYWxhcm0gc3RhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsYXJtUnVubmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy9SZXBvcnQgZXJyb3IgYW5kIHN0b3AgcnVubmluZ1xyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiVW5rbm93biBlcnJvciBvY2N1cnJlZDogJW9cIiwgZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vU2V0IGFsYXJtIHN0YXRlXHJcbiAgICAgICAgICAgICAgICAgICAgYWxhcm1SdW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcblx0XHRcdC8vIFdhdGNobGlzdCBhbGFybSBoYW5kbGVyXHJcblx0XHRcdGVsc2UgaWYgKGFsYXJtLm5hbWUgPT0gXCJ3YXRjaGxpc3RcIiAmJiBvcHRpb25zLndhdGNobGlzdCkge1xyXG5cdFx0XHRcdC8vIEdyYWIgY3VycmVudCB3YXRjaGxpc3RcclxuXHRcdFx0XHRjcmFwaS5jbG9uZShbXCJ3YXRjaGxpc3RcIl0sIGZ1bmN0aW9uKGQpIHtcclxuXHRcdFx0XHRcdC8qdmFyIHRlc3RXYXRjaGxpc3QgPSBbXHJcblx0XHRcdFx0XHRcdC8vIFRyYWNrIHcvIGNvbW1lbnRzXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRsaW5rOiBcImh0dHBzOi8vc291bmRhdGlvbi5jb20vdXNlci9jeWJlcmJpdC90cmFjay9hbi1ob3VyXCIsXHJcblx0XHRcdFx0XHRcdFx0bGlrZXM6IDAsXHJcblx0XHRcdFx0XHRcdFx0ZG93bmxvYWRzOiAwLFxyXG5cdFx0XHRcdFx0XHRcdGNvbW1lbnRzOiAwXHJcblx0XHRcdFx0XHRcdH0sXHJcblxyXG5cdFx0XHRcdFx0XHQvLyBHcm91cCB3LyBjb21tZW50c1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0bGluazogXCJodHRwczovL3NvdW5kYXRpb24uY29tL2dyb3VwL3RlYW0tc291bmRhdGlvblwiLFxyXG5cdFx0XHRcdFx0XHRcdGxhc3RDb21tZW50OiBcIlwiLFxyXG5cdFx0XHRcdFx0XHRcdG1lbWJlcnM6IDAsXHJcblx0XHRcdFx0XHRcdFx0Zm9sbG93ZXJzOiAwLFxyXG5cdFx0XHRcdFx0XHRcdHRyYWNrczogMFxyXG5cdFx0XHRcdFx0XHR9LFxyXG5cclxuXHRcdFx0XHRcdFx0Ly8gVHJhY2sgdy8gbm8gY29tbWVudHNcclxuXHRcdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRcdGxpbms6IFwiaHR0cHM6Ly9zb3VuZGF0aW9uLmNvbS91c2VyL2N5YmVyYml0L3RyYWNrL3NkZi0zXCIsXHJcblx0XHRcdFx0XHRcdFx0bGlrZXM6IDAsXHJcblx0XHRcdFx0XHRcdFx0ZG93bmxvYWRzOiAwLFxyXG5cdFx0XHRcdFx0XHRcdGNvbW1lbnRzOiAwXHJcblx0XHRcdFx0XHRcdH0sXHJcblxyXG5cdFx0XHRcdFx0XHQvLyBUcmFjayB3LyBiYWQgbGlua1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0bGluazogXCJodHRwczovL3NvdW5kYXRpb24uY29tL3VzZXIvY3liZXJiaXQvdHJhY2svdGhpcy10cmFjay1pcy1pbnZhbGlkXCIsXHJcblx0XHRcdFx0XHRcdFx0bGlrZXM6IDAsXHJcblx0XHRcdFx0XHRcdFx0ZG93bmxvYWRzOiAwLFxyXG5cdFx0XHRcdFx0XHRcdGNvbW1lbnRzOiAwXHJcblx0XHRcdFx0XHRcdH0sXHJcblxyXG5cdFx0XHRcdFx0XHQvLyBHcm91cCB3LyBubyBjb21tZW50c1xyXG5cdFx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdFx0bGluazogXCJodHRwczovL3NvdW5kYXRpb24uY29tL2dyb3VwL25vLWNvbW1lbnRcIixcclxuXHRcdFx0XHRcdFx0XHRsYXN0Q29tbWVudDogXCJcIixcclxuXHRcdFx0XHRcdFx0XHRtZW1iZXJzOiAwLFxyXG5cdFx0XHRcdFx0XHRcdGZvbGxvd2VyczogMCxcclxuXHRcdFx0XHRcdFx0XHR0cmFja3M6IDBcclxuXHRcdFx0XHRcdFx0fSxcclxuXHJcblx0XHRcdFx0XHRcdC8vIEdyb3VwIHcvIGNvbW1lbnRzIGRpc2FibGVkXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRsaW5rOiBcImh0dHBzOi8vc291bmRhdGlvbi5jb20vZ3JvdXAvcHRzXCIsXHJcblx0XHRcdFx0XHRcdFx0bGFzdENvbW1lbnQ6IFwiXCIsXHJcblx0XHRcdFx0XHRcdFx0bWVtYmVyczogMCxcclxuXHRcdFx0XHRcdFx0XHRmb2xsb3dlcnM6IDAsXHJcblx0XHRcdFx0XHRcdFx0dHJhY2tzOiAwXHJcblx0XHRcdFx0XHRcdH0sXHJcblxyXG5cdFx0XHRcdFx0XHQvLyBQcml2YXRlIGdyb3VwIHcvIGNvbW1lbnRzXHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRsaW5rOiBcImh0dHBzOi8vc291bmRhdGlvbi5jb20vZ3JvdXAvcHJpdmF0ZWx5LW93bmVkXCIsXHJcblx0XHRcdFx0XHRcdFx0bGFzdENvbW1lbnQ6IFwiXCIsXHJcblx0XHRcdFx0XHRcdFx0bWVtYmVyczogMCxcclxuXHRcdFx0XHRcdFx0XHRmb2xsb3dlcnM6IDAsXHJcblx0XHRcdFx0XHRcdFx0dHJhY2tzOiAwXHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdF07Ki9cclxuXHJcblx0XHRcdFx0XHQvLyBVc2VyIGlzIG5vdCBsb2dnZWQgaW5cclxuXHRcdFx0XHRcdGlmICghbWUuc3VjY2Vzcykge1xyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmluZm8oXCJOb3QgbG9nZ2VkIGluLCBza2lwcGluZyB3YXRjaGxpc3RcIik7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0Ly8gVXNlciBpcyBsb2dnZWQgaW5cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBTdG9yYWdlIGZvciB3YXRjaGxpc3QgYW5kIG1ldGFkYXRhXHJcblx0XHRcdFx0XHRcdHZhciB3YXRjaGxpc3QgPSAodHlwZW9mIHRlc3RXYXRjaGxpc3QgPT0gXCJ1bmRlZmluZWRcIiA/ICBkLndhdGNobGlzdCA6IHRlc3RXYXRjaGxpc3QpO1xyXG5cdFx0XHRcdFx0XHR2YXIgcHJvY2Vzc2VkID0gW107XHJcblx0XHRcdFx0XHRcdHZhciBtZXRhID0gW107XHJcblxyXG5cdFx0XHRcdFx0XHQvLyBTdG9yYWdlIGZvciB3YXRjaGxpc3QgcHJvY2Nlc3NpbmcgY291bnRlclxyXG5cdFx0XHRcdFx0XHR2YXIgbnVtUHJvY2Vzc2VkID0gMDtcclxuXHJcblx0XHRcdFx0XHRcdC8vIEl0ZXJhdGUgd2F0Y2hsaXN0XHJcblx0XHRcdFx0XHRcdCQuZWFjaCh3YXRjaGxpc3QsIGZ1bmN0aW9uKGksIHYpIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBTZXQgbmV4dCBwcm9jZXNzZWQgaXRlbSBhcyBjdXJyZW50IHZlcnNpb25cclxuXHRcdFx0XHRcdFx0XHRwcm9jZXNzZWRbaV0gPSB2O1xyXG5cdFx0XHRcdFx0XHRcdG1ldGFbaV0gPSB7fTtcclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gU3RvcmUgdHlwZSBpbiBtZXRhZGF0YVxyXG5cdFx0XHRcdFx0XHRcdHZhciB0eXBlID0gd2F0Y2hsaXN0SXRlbVR5cGUodi5saW5rKTtcclxuXHRcdFx0XHRcdFx0XHRtZXRhW2ldLnR5cGUgPSB0eXBlO1xyXG5cclxuXHRcdFx0XHRcdFx0XHQvLyBHcmFiIHBhZ2VcclxuXHRcdFx0XHRcdFx0XHQkLmdldCh2LmxpbmssIGZ1bmN0aW9uKGh0bWwpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciAkaHRtbCA9ICQoaHRtbCk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gUGFyc2UgaXRlbVxyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIGluZm8gPSBwYXJzZVdhdGNobGlzdEl0ZW0odi5saW5rLCAkaHRtbCwgdHlwZSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3RvcmFnZSBmb3IgaXRlbSB1cGRhdGVzIHRvIG1lcmdlIGxhdGVyXHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgdXBkYXRlcyA9IGluZm8udXBkYXRlcztcclxuXHJcblx0XHRcdFx0XHRcdFx0XHQvLyBUcmFjayBoYW5kbGVyXHJcblx0XHRcdFx0XHRcdFx0XHRpZiAodHlwZSA9PSBcInRyYWNrXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU3RvcmUgbWV0YSBpbmZvcm1hdGlvblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRtZXRhW2ldLnRpdGxlID0gJGh0bWwuZmluZChcIi50aXRsZVwiKS50ZXh0KCkudHJpbSgpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGdsb2JhbC5kZWJ1ZykgY29uc29sZS5sb2coXCJ0cmFjayAlbzogY3VycmVudCAlbywgbmV3ICVvXCIsIHYubGluaywge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpa2VzOiB2Lmxpa2VzLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGRvd25sb2Fkczogdi5kb3dubG9hZHMsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29tbWVudHM6IHYuY29tbWVudHNcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSwgdXBkYXRlcyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gR3JvdXAgaGFuZGxlclxyXG5cdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZiAodHlwZSA9PSBcImdyb3VwXCIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0LyoqXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqIEhlcmUsIEknbSB1c2luZyB0aGUgaGFzaCBvZiB0aGUgY29tbWVudCBib2R5IHRvIGRldGVybWluZSBpZiB0aGUgdG9wXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqIGNvbW1lbnQgaXMgbmV3LiBJdCdzIG5vdCBpZGVhbCwgYnV0IHRoZXJlIGlzIHN1Y2ggdmFyaWFuY2UgaW4gb3RoZXJcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogbWV0aG9kcyB0aGF0IEkndmUgZGVjaWRlZCB0byBnbyB0aGlzIHdheS4gVGhlcmUgYXJlIGEgZmV3IGRyYXdiYWNrczpcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogIC0gSWYgc29tZW9uZSBwb3N0cyBhIG5ldyBjb21tZW50IHdpdGggZXhhY3RseSB0aGUgc2FtZSB0ZXh0IGFzIHRoZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiAgICBwcmV2aW91cyBjb21tZW50LCBpdCB3aWxsIG5vdCBiZSBkZXRlY3RlZFxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiAgLSBJZiBhIGNvbW1lbnQgaXMgZGVsZXRlZCBvciBmbGFnZ2VkIGFuZCBpcyBzdGlsbCBhdCB0aGUgdG9wIG9mIHRoZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiAgICB0aHJlYWQsIGl0IHdpbGwgYmUgZGV0ZWN0ZWQgYXMgYSBuZXcgY29tbWVudFxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiAgLSBJZiBhIGNvbW1lbnQgYm9keSBjYW5ub3QgYmUgZGV0ZXJtaW5lZCwgYSBibGFuayBzdHJpbmcgaXMgdXNlZCxcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogICAgd2hpY2ggY291bGQgY29uZnVzZSB0aGUgcGFyc2VyIGFuZCBjYXVzZSBhIGRldGVjdGlvbiBtaXNzXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqIFRoZXJlIGFyZSBhZHZhbnRhZ2VzLCB0aG91Z2g6XHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqICArIE5vIGNvbXBsZXgsIGJ1Z2d5IElEIGRldGVybWluYXRpb25cclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogICsgTm90IGFmZmVjdGVkIGJ5IGxvZ2luIHN0YXR1cyAoZXhjZXB0IHByaXZhdGUgZ3JvdXBzIGFuZCB0cmFja3MpXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqICArIElnbm9yZXMgdXNlciBjaGFuZ2VzIChwcm9maWxlIGltYWdlLCB1c2VybmFtZSwgbGluaywgZXRjLilcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICpcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogPT09PT09PT09PT09PT09PVxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKlxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiBIb3dldmVyLCB1c2luZyBhIGNvdW50IGZvciBkZXRlcm1pbmluZyBuZXcgY29tbWVudHMgaGFzIGEgYnVuY2ggb2ZcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogYWR2YW50YWdlcyBhcyB3ZWxsOlxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiAgKyBBYmlsaXR5IHRvIGRldGVjdCBtdWx0aXBsZSBuZXcgY29tbWVudHNcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogICsgU2ltcGxlciBwYXJzaW5nXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqIFNvbWUgZGlzYWR2YW50YWdlczpcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogIC0gTmVnYXRpdmUgY2hhbmdlcyBpbiBjb21tZW50cyB3b3VsZCBoYXZlIHRvIGJlIHNwZWNpYWxseSBoYW5kbGVkXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqICAtIEdyb3VwcyBkbyBub3QgaGF2ZSBhbiBvYnZpb3VzIGNvbW1lbnQgY291bnRlciwgc28gaXQgd291bGQgbmVlZCB0b1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiAgICBjYWxjdWxhdGVkIHZpYSBjb21tZW50IHBhZ2VzIChwb3RlbnRpYWxseSBzbG93IGFuZCBidWdneSlcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICovXHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgJGxhc3RDb21tZW50ID0gJGh0bWwuZmluZChcIi5jb21tZW50cyAuY29tbWVudDpmaXJzdFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyICRsYXN0Q29tbWVudEF1dGhvciA9ICRsYXN0Q29tbWVudC5maW5kKFwiLmNvbW1lbnQtYXV0aG9yXCIpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgJGxhc3RDb21tZW50Qm9keSA9ICRsYXN0Q29tbWVudC5maW5kKFwiLmNvbnRlbnQgPiBwXCIpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU3RvcmUgbWV0YSBpbmZvcm1hdGlvblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRtZXRhW2ldLnRpdGxlID0gJGh0bWwuZmluZChcIi5ncm91cC1oZXJvLWNvbnRhaW5lci1pbmZvID4gaDJcIikudGV4dCgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRtZXRhW2ldLmNvbW1lbnRCb2R5ID0gJGxhc3RDb21tZW50Qm9keS50ZXh0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdG1ldGFbaV0uY29tbWVudEF1dGhvciA9ICRsYXN0Q29tbWVudEF1dGhvci50ZXh0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdG1ldGFbaV0uY29tbWVudEF1dGhvckxpbmsgPSAkbGFzdENvbW1lbnRBdXRob3IuZmluZCgnYScpLmF0dHIoXCJocmVmXCIpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGdsb2JhbC5kZWJ1ZykgY29uc29sZS5sb2coXCJncm91cCAlbzogY3VycmVudCAlbywgbmV3ICVvXCIsIHYubGluaywge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxhc3RDb21tZW50OiB2Lmxhc3RDb21tZW50LFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdG1lbWJlcnM6IHYubWVtYmVycyxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmb2xsb3dlcnM6IHYuZm9sbG93ZXJzLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRyYWNrczogdi50cmFja3NcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSwgdXBkYXRlcyk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gTWVyZ2UgY3VycmVudCBhbmQgbmV3IHdhdGNobGlzdCByZXN1bHRzXHJcblx0XHRcdFx0XHRcdFx0XHRwcm9jZXNzZWRbaV0gPSAkLmV4dGVuZCh7fSwgcHJvY2Vzc2VkW2ldLCB1cGRhdGVzKTtcclxuXHRcdFx0XHRcdFx0XHR9KS5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRcdFx0XHQrK251bVByb2Nlc3NlZDtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHQvLyBEZXRlY3QgZW5kIG9mIHdhdGNobGlzdFxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKG51bVByb2Nlc3NlZCA9PSB3YXRjaGxpc3QubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBjaGFuZ2VzID0gW107XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHQvKipcclxuXHRcdFx0XHRcdFx0XHRcdFx0ICogVGhlc2UgY2FuIGJlIG9wdGltaXNlZCBieSBjb21iaW5pbmcgdGhlXHJcblx0XHRcdFx0XHRcdFx0XHRcdCAqIHR3byAkLmVhY2ggcm91dGluZXMsIGJ1dCB0aGF0IGNhbiBiZSBhblxyXG5cdFx0XHRcdFx0XHRcdFx0XHQgKiBlYXN5IHBpY2sgZm9yIGFub3RoZXIgdGltZS5cclxuXHRcdFx0XHRcdFx0XHRcdFx0ICovXHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBJdGVyYXRlIHByb2Nlc3NlZCBpdGVtcyBhbmQgZGV0ZXJtaW5lIGNoYW5nZXNcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5lYWNoKHByb2Nlc3NlZCwgZnVuY3Rpb24oaSwgdikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBjdXJyZW50ID0gd2F0Y2hsaXN0W2ldO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBtZXR1bSA9IG1ldGFbaV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hhbmdlc1tpXSA9IFtdO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAobWV0dW0udHlwZSA9PSBcInRyYWNrXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlrZXMgPSB2Lmxpa2VzIC0gY3VycmVudC5saWtlcztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBkb3dubG9hZHMgPSB2LmRvd25sb2FkcyAtIGN1cnJlbnQuZG93bmxvYWRzO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGNvbW1lbnRzID0gdi5jb21tZW50cyAtIGN1cnJlbnQuY29tbWVudHM7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGxpa2VzKSBjaGFuZ2VzW2ldLnB1c2gobGlrZXMgKyBcIiBsaWtlXCIgKyAoTWF0aC5hYnMobGlrZXMpID09IDEgPyBcIlwiIDogXCJzXCIpKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChkb3dubG9hZHMpIGNoYW5nZXNbaV0ucHVzaChkb3dubG9hZHMgKyBcIiBkb3dubG9hZFwiICsgKE1hdGguYWJzKGRvd25sb2FkcykgPT0gMSA/IFwiXCIgOiBcInNcIikpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNvbW1lbnRzKSBjaGFuZ2VzW2ldLnB1c2goY29tbWVudHMgKyBcIiBjb21tZW50XCIgKyAoTWF0aC5hYnMoY29tbWVudHMpID09IDEgPyBcIlwiIDogXCJzXCIpKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLmRlYnVnKSBjb25zb2xlLmxvZyhcImNoYW5nZXMgZm9yIHRyYWNrICVvOiAlb1wiLCB2LmxpbmssIGNoYW5nZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlIGlmIChtZXR1bS50eXBlID09IFwiZ3JvdXBcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmb2xsb3dlcnMgPSB2LmZvbGxvd2VycyAtIGN1cnJlbnQuZm9sbG93ZXJzO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGxhc3RDb21tZW50ID0gKHYubGFzdENvbW1lbnQgIT09IGN1cnJlbnQubGFzdENvbW1lbnQpID8gbWV0dW0uY29tbWVudEJvZHkgOiBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBtZW1iZXJzID0gdi5tZW1iZXJzIC0gY3VycmVudC5tZW1iZXJzO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHRyYWNrcyA9IHYudHJhY2tzIC0gY3VycmVudC50cmFja3M7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGxhc3RDb21tZW50KSBjaGFuZ2VzW2ldLnB1c2goXCJOZXcgY29tbWVudCBmcm9tIEBcIiArIG1ldHVtLmNvbW1lbnRBdXRob3IpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGZvbGxvd2VycykgY2hhbmdlc1tpXS5wdXNoKGZvbGxvd2VycyArIFwiIGZvbGxvd2VyXCIgKyAoTWF0aC5hYnMoZm9sbG93ZXJzKSA9PSAxID8gXCJcIiA6IFwic1wiKSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAobWVtYmVycykgY2hhbmdlc1tpXS5wdXNoKG1lbWJlcnMgKyBcIiBtZW1iZXJcIiArIChNYXRoLmFicyhtZW1iZXJzKSA9PSAxID8gXCJcIiA6IFwic1wiKSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodHJhY2tzKSBjaGFuZ2VzW2ldLnB1c2godHJhY2tzICsgXCIgdHJhY2tcIiArIChNYXRoLmFicyh0cmFja3MpID09IDEgPyBcIlwiIDogXCJzXCIpKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoZ2xvYmFsLmRlYnVnKSBjb25zb2xlLmxvZyhcImNoYW5nZXMgZm9yIGdyb3VwICVvOiAlb1wiLCB2LmxpbmssIGNoYW5nZXNbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEdlbmVyYXRlIG5vdGlmaWNhdGlvbnNcclxuXHRcdFx0XHRcdFx0XHRcdFx0bnVtUHJvY2Vzc2VkID0gMDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0JC5lYWNoKGNoYW5nZXMsIGZ1bmN0aW9uKGksIHYpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgY3VycmVudCA9IHdhdGNobGlzdFtpXTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgaWQgPSBcIm1vZGF0aW9ud2F0Y2hcIiArIGN1cnJlbnQubGluay5oYXNoQ29kZSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBtZXR1bSA9IG1ldGFbaV07XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vU2V0IHVwIG5vdGlmaWNhdGlvblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBub3RpZiA9IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6IFwiYmFzaWNcIixcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGljb25Vcmw6IFwiaW1nL25ld2ljb25mbGF0MTI4LnBuZ1wiLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dGl0bGU6IG1ldHVtLnRpdGxlLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0bWVzc2FnZTogdi5qb2luKFwiLCBcIilcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDaGFuZ2VzIGV4aXN0XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHYubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBOb3RpZmljYXRpb24gbm90IHNob3duIHlldFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFub3RpZkRhdGEoaWQpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNocm9tZS5ub3RpZmljYXRpb25zLmNyZWF0ZShpZCwgbm90aWYsIGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdF91cGRhdGVEYXRhKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vTm90aWZpY2F0aW9uIHNob3duXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0X3VwZGF0ZURhdGEoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIE5vIGNoYW5nZXNcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlICsrbnVtUHJvY2Vzc2VkO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBTdG9yZSBub3RpZmljYXRpb25cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRmdW5jdGlvbiBfdXBkYXRlRGF0YSgpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdCsrbnVtUHJvY2Vzc2VkO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vVXBkYXRlIG5vdGlmaWNhdGlvbiBkYXRhXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRub3RpZkRhdGEoaWQsIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bm90aWY6IG5vdGlmLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRsaW5rOiBjdXJyZW50LmxpbmtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdC8vIEdlbmVyYXRlZCBmaW5hbCBub3RpZmljYXRpb24sIHVwZGF0ZSBzdG9yYWdlIGFuZCBiYWRnZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKG51bVByb2Nlc3NlZCA9PSBjaGFuZ2VzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBVcGRhdGUgd2F0Y2hsaXN0IHN0b3JhZ2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y3JhcGkudXBkYXRlQWxsKHt3YXRjaGxpc3Q6IHByb2Nlc3NlZH0pO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gVXBkYXRlIGJhZGdlXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHVwZGF0ZUJhZGdlKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblx0fVxyXG5cclxuXHQvL0dldC9zZXQgbm90aWZpY2F0aW9uIGRhdGFcclxuXHRmdW5jdGlvbiBub3RpZkRhdGEoaWQsIHZhbHVlKSB7XHJcblx0XHR2YXIgbm90aWZzSlNPTiA9IGxvY2FsU3RvcmFnZS5ub3RpZkRhdGE7XHJcblx0XHR2YXIgbm90aWZzID0gKG5vdGlmc0pTT04pID8gJC5wYXJzZUpTT04obm90aWZzSlNPTikgOiB7fTtcclxuXHJcblx0XHRpZiAodHlwZW9mIGlkID09IFwidW5kZWZpbmVkXCIpIHJldHVybiBub3RpZnM7XHJcblx0XHRpZiAodHlwZW9mIHZhbHVlID09IFwidW5kZWZpbmVkXCIpIHZhbHVlID0gZmFsc2U7XHJcblx0XHR2YXIgbm90aWYgPSBub3RpZnNbaWRdO1xyXG5cclxuXHRcdC8vIERlbGV0ZSBub3RpZmljYXRpb24gZGF0YVxyXG5cdFx0aWYgKHZhbHVlID09PSBcIlwiKSBkZWxldGUgbm90aWZzW2lkXTtcclxuXHJcblx0XHQvLyBTZXQgbm90aWZpY2F0aW9uIGRhdGFcclxuXHRcdGVsc2UgaWYgKHZhbHVlKSBub3RpZnNbaWRdID0gdmFsdWU7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIHN0b3JhZ2VcclxuXHRcdGxvY2FsU3RvcmFnZS5ub3RpZkRhdGEgPSBKU09OLnN0cmluZ2lmeShub3RpZnMpO1xyXG5cclxuXHRcdHJldHVybiBub3RpZjtcclxuXHR9XHJcblxyXG5cdC8vU2hvdyBhbGwgbm90aWZpY2F0aW9uc1xyXG5cdGZ1bmN0aW9uIHNob3dBbGxOb3RpZnMoKSB7XHJcblx0XHR2YXIgbm90aWZzID0gbm90aWZEYXRhKCk7XHJcblxyXG5cdFx0JC5lYWNoKG5vdGlmcywgZnVuY3Rpb24oaSwgdikge1xyXG5cdFx0XHRjaHJvbWUubm90aWZpY2F0aW9ucy5jcmVhdGUoaSwgdi5ub3RpZiwgZnVuY3Rpb24oKXt9KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSBiYWRnZSBpZiBubyBsb2dpbiBub3RpZmljYXRpb25cclxuXHRcdGlmICghbm90aWZzLm1vZGF0aW9uX2xvZ2luKSB1cGRhdGVCYWRnZSgpO1xyXG5cdH1cclxuXHJcblx0Ly9VcGRhdGUgYmFkZ2VcclxuXHRmdW5jdGlvbiB1cGRhdGVCYWRnZSgpIHtcclxuXHRcdC8vY29uc29sZS5sb2coXCJ1cGRhdGVCYWRnZTogJW9cIiwgbm90aWZEYXRhKCkpO1xyXG5cclxuXHRcdHZhciBub3RpZnMgPSBPYmplY3Qua2V5cyhub3RpZkRhdGEoKSkubGVuZ3RoO1xyXG5cdFx0dmFyIHRpdGxlID0gKG5vdGlmcyA9PT0gMCA/IFwiTm8gbmV3IG5vdGlmaWNhdGlvbnMgOihcIiA6IG5vdGlmcyArIFwiIG5ldyBub3RpZmljYXRpb25cIiArIChub3RpZnMgPiAxID8gXCJzXCIgOiBcIlwiKSk7XHJcblxyXG5cdFx0Ly9VcGRhdGUgYmFkZ2VcclxuXHRcdGNyYXBpLmJhZGdlKHtcclxuXHRcdFx0dGl0bGU6IHRpdGxlLFxyXG5cdFx0XHRjb2xvcjogXCJyZWRcIixcclxuXHRcdFx0dGV4dDogbm90aWZzID8gU3RyaW5nKG5vdGlmcykgOiBcIlwiXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG4gICAgLy8gQ2xlYXIgbG9jYWxTdG9yYWdlIGNhY2hlXHJcbiAgICBmdW5jdGlvbiBjbGVhckNhY2hlKCkge1xyXG4gICAgICAgICQuZWFjaChjYWNoZUtleXMsIGZ1bmN0aW9uKGksIHYpIHtcclxuICAgICAgICAgICAgZGVsZXRlIGxvY2FsU3RvcmFnZVt2XTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc29sZS5pbmZvKFwiQ2FjaGUgY2xlYXJlZFwiKTtcclxuICAgIH1cclxuXHJcblx0Ly8gQ2FjaGUgb3B0aW9uc1xyXG5cdGZ1bmN0aW9uIGNhY2hlT3B0aW9ucygpIHtcclxuXHRcdC8vIENsb25lIHN0b3JhZ2Ugd2l0aCBkZWZhdWx0c1xyXG5cdFx0Y3JhcGkuY2xvbmUoe29wdGlvbnM6IGdsb2JhbC5vcHRpb25EZWZhdWx0c30sIGZ1bmN0aW9uKGQpIHtcclxuXHRcdFx0Ly8gQ2FjaGUgb3B0aW9uc1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcImNhY2hlIG9wdGlvbnNcIik7XHJcblx0XHRcdGxvY2FsSlNPTihcIm9wdGlvbnNcIiwgZC5vcHRpb25zKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufSk7XHJcblxyXG4vKiBDaGVja3MgZm9yIG5ldyBpbnN0YWxscyAqL1xyXG4vKmZ1bmN0aW9uIGluc3RhbGxfbm90aWNlKCkge1xyXG5cdHZhciBtYW5pZmVzdCA9IGNocm9tZS5ydW50aW1lLmdldE1hbmlmZXN0KCk7XHJcblxyXG4gICAgaWYgKGxvY2FsU3RvcmFnZVsndmVyc2lvbiddID09IG1hbmlmZXN0LnZlcnNpb24pIHJldHVybjtcclxuXHJcbiAgICB2YXIgbm93ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICBsb2NhbFN0b3JhZ2VbJ2luc3RhbGxfdGltZSddID0gbm93O1xyXG4gICAgbG9jYWxTdG9yYWdlWyd2ZXJzaW9uJ10gPSBtYW5pZmVzdC52ZXJzaW9uO1xyXG4gICAgY2hyb21lLnRhYnMuY3JlYXRlKHt1cmw6IFwib3B0aW9ucy5odG1sI2Fib3V0XCJ9KTtcclxufSovXHJcblxyXG4vL2luc3RhbGxfbm90aWNlKCk7XHJcbi8vd2F0Y2hsaXN0KCk7XHJcbi8vdmFyIGhhc2hlcyA9IFtdO1xyXG5cclxuLy9IYW5kbGVyIGZvciBjb250ZW50IHNjcmlwdCBtZXNzYWdlclxyXG4vKmNocm9tZS5ydW50aW1lLm9uTWVzc2FnZS5hZGRMaXN0ZW5lcihmdW5jdGlvbihyZXF1ZXN0LCBzZW5kZXIsIHNlbmRSZXNwb25zZSkge1xyXG5cdC8qY29uc29sZS5sb2coXCJyZXF1ZXN0OiAlT1wiLCByZXF1ZXN0KTtcclxuXHRjb25zb2xlLmxvZyhcInNlbmRlcjogJU9cIiwgc2VuZGVyKTsqXHJcblxyXG5cdC8vUmVxdWVzdGVkIHRvIHBhdXNlIGV2ZXJ5dGhpbmdcclxuXHRpZiAocmVxdWVzdC5hY3Rpb24gPT0gXCJtb2RhdGlvbi1wYXVzZS1ldmVyeXRoaW5nXCIpIHtcclxuXHRcdC8vR3JhYiBhbGwgdGFic1xyXG5cdFx0Y2hyb21lLnRhYnMucXVlcnkoe3VybDogXCJodHRwOi8vKi5zb3VuZGF0aW9uLmNvbS8qXCJ9LCBmdW5jdGlvbih0YWJzKSB7XHJcblx0XHRcdC8vSXRlcmF0ZSB0YWJzXHJcblx0XHRcdCQuZWFjaCh0YWJzLCBmdW5jdGlvbihpLCB0YWIpIHtcclxuXHRcdFx0XHQvL1NlbmQgcGF1c2UgbWVzc2FnZSB0byB0YWJcclxuXHRcdFx0XHRjaHJvbWUudGFicy5zZW5kTWVzc2FnZSh0YWIuaWQsIHthY3Rpb246IFwibW9kYXRpb24tcGF1c2VcIiwgZ3VpZDogcmVxdWVzdC5ndWlkfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuXHRcdFx0XHRcdC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH1cclxufSk7Ki9cclxuXHJcbi8vQWxhcm0gaGFuZGxlclxyXG4vKmZ1bmN0aW9uIGFsYXJtSGFuZGxlcihhbGFybSkge1xyXG5cdHZhciB2aWV3cyA9IGNocm9tZS5leHRlbnNpb24uZ2V0Vmlld3Moe3R5cGU6IFwicG9wdXBcIn0pO1xyXG5cclxuXHQvL0dyYWIgc3RvcmFnZVxyXG5cdGNyYXBpLmNsb25lKGZ1bmN0aW9uKGQpIHtcclxuXHRcdC8vTG9naW5cclxuXHRcdG1vZGFwaS5sb2dpbihmdW5jdGlvbihtZSkge1xyXG5cdFx0XHQvL0ZlZWQgYWxhcm0gaGFuZGxlclxyXG5cdFx0XHRpZiAoYWxhcm0ubmFtZSA9PSBcImZlZWRcIikge1xyXG5cdFx0XHRcdC8vQWxhcm0gaXMgcnVubmluZ1xyXG5cdFx0XHRcdGlmIChhbGFybVJ1bm5pbmcpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUuaW5mbyhcIkFsYXJtIHJ1bm5pbmcsIG5vdGlmaWNhdGlvbiBoYW5kbGVyIGNhbmNlbGxlZFwiKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vQWxhcm0gaXMgbm90IHJ1bm5pbmdcclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdC8vUG9wdXAgaXMgb3BlblxyXG5cdFx0XHRcdFx0aWYgKHZpZXdzLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0XHQvL0xvZyBzdGF0dXNcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5pbmZvKFwiUG9wdXAgb3Blbiwgbm90aWZpY2F0aW9uIGhhbmRsZXIgY2FuY2VsbGVkXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vUG9wdXAgaXMgbm90IG9wZW5cclxuXHRcdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvL1NldCBhbGFybSBzdGF0ZVxyXG5cdFx0XHRcdFx0XHRhbGFybVJ1bm5pbmcgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRcdFx0Ly9CZWdpbiB0cmFjZSBncm91cFxyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIk1vZGF0aW9uIDo6IENoZWNrIG5vdGlmaWNhdGlvbnNcIik7XHJcblxyXG5cdFx0XHRcdFx0XHQvL1VzZXIgaXMgbm90IGxvZ2dlZCBpblxyXG5cdFx0XHRcdFx0XHRpZiAoIW1lLnN1Y2Nlc3MpIHtcclxuXHRcdFx0XHRcdFx0XHQvL0xvZyBmYWlsdXJlXHJcblx0XHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ291bGQgbm90IGxvZ2luIHRvIFNvdW5kYXRpb25cIik7XHJcblxyXG5cdFx0XHRcdFx0XHRcdGNyYXBpLmJhZGdlKHtcclxuXHRcdFx0XHRcdFx0XHRcdHRpdGxlOiBcIlBsZWFzZSBsb2dpbiB0byB2aWV3IG5vdGlmaWNhdGlvbnNcIixcclxuXHRcdFx0XHRcdFx0XHRcdGNvbG9yOiBcImdyYXlcIixcclxuXHRcdFx0XHRcdFx0XHRcdHRleHQ6IFwiP1wiXHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vU2V0IGFsYXJtIHN0YXRlXHJcblx0XHRcdFx0XHRcdFx0YWxhcm1SdW5uaW5nID0gZmFsc2U7XHJcblx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdC8vVXNlciBpcyBsb2dnZWQgaW5cclxuXHRcdFx0XHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0JC5nZXQoZ2xvYmFsLnBhdGguZmVlZCwgZnVuY3Rpb24oaHRtbCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly9QYXJzZSBIVE1MIHRvIHJlbW92ZSBpbWFnZXMgYW5kIHRpbWluZyB2YWx1ZXNcclxuXHRcdFx0XHRcdFx0XHRcdGh0bWwgPSBodG1sLnJlcGxhY2UoLzxpbWdcXGJbXj5dKj4vaWcsICcnKS5yZXBsYWNlKC88c3BhbiBjbGFzcz1cXFwidGltZVxcXCI+Lio8XFwvc3Bhbj4vaWcsICcnKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgJGh0bWwgPSAkKGh0bWwpO1xyXG5cdFx0XHRcdFx0XHRcdFx0dmFyICRhc2lkZSA9ICRodG1sLmZpbmQoJ2FzaWRlJyk7XHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgYXNpZGVIYXNoID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdHZhciBmZWVkQWxlcnRzID0gMDtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHQvL1BhcnNlIGZlZWRcclxuXHRcdFx0XHRcdFx0XHRcdGlmICgkYXNpZGUubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vSGFzaCBub3RpZmljYXRpb25zIGZvciBDaHJvbWUgcG9wdXBcclxuXHRcdFx0XHRcdFx0XHRcdFx0dmFyIGFzaWRlSFRNTCA9ICRhc2lkZVswXS5vdXRlckhUTUw7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGFzaWRlSGFzaCA9IFN0cmluZyhhc2lkZUhUTUwuaGFzaENvZGUoKSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL0dyYWIgbnVtYmVyIG9mIGZlZWQgbm90aWZpY2F0aW9uc1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgZmVlZExpbmsgPSAkaHRtbC5maW5kKFwiYVtocmVmPScvZmVlZCddXCIpWzBdLmlubmVyVGV4dDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0ZmVlZEFsZXJ0cyA9IHBhcnNlSW50KGZlZWRMaW5rLm1hdGNoKC8oXFxkKykvKSkgfHwgMDtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHQvL1VuYWJsZSB0byBwYXJzZSBmZWVkXHJcblx0XHRcdFx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9Mb2cgZmFpbHVyZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJVbmFibGUgdG8gcGFyc2UgZmVlZCBub3RpZmljYXRpb25zLCBjb250aW51aW5nIHRvIHdhdGNobGlzdFwiKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHQvL0dlbmVyYXRlIGluaXRpYWwgYWxlcnRzXHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgaW5pdGlhbEFsZXJ0cyA9IF9nZW5lcmF0ZUFsZXJ0cyhkW21lLmVtYWlsXSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly9UcmFjZSBpbml0aWFsIGFsZXJ0c1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc29sZS5sb2coXCJJbml0aWFsIGFsZXJ0czpcIiwgaW5pdGlhbEFsZXJ0cyk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly9HcmFiIGN1cnJlbnQgdXNlcidzIHByb2ZpbGVcclxuXHRcdFx0XHRcdFx0XHRcdC8qJC5nZXQoZ2xvYmFsLnBhdGgucHJvZmlsZSwgZnVuY3Rpb24oaHRtbCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL1N0b3JhZ2UgZm9yIHByb2ZpbGUgbGlua1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgcHJvZmlsZUxpbmsgPSAkKGh0bWwpLmZpbmQoXCIucHVibGljLXVybFwiKS50ZXh0KCkucmVwbGFjZShcImh0dHA6Ly9zb3VuZGF0aW9uLmNvbVwiLCBcIlwiKVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9Ud2VhayB1c2VyIG9iamVjdCB0byBhZGQgcHJvZmlsZSBsaW5rXHJcblx0XHRcdFx0XHRcdFx0XHRcdG1lLnByb2ZpbGUgPSBwcm9maWxlTGluaztcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vQ2hlY2sgd2F0Y2hsaXN0XHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vVW5hdmFpbGFibGUgaW4gMi4wXHJcblx0XHRcdFx0XHRcdFx0XHRcdGNoZWNrX3dhdGNobGlzdChtZSwgdHJ1ZSwgZnVuY3Rpb24oZGF0YSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vUmUtZ2VuZXJhdGUgYWxlcnRzXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIHJlZ2VuQWxlcnRzID0gX2dlbmVyYXRlQWxlcnRzKGRhdGEpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvL1RyYWNlIHJlLWdlbmVyYXRlZCBhbGVydHNcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjb25zb2xlLmxvZyhcIlJlLWdlbmVyYXRlZCBhbGVydHM6XCIsIHJlZ2VuQWxlcnRzKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9TZXQgYWxhcm0gc3RhdGVcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhbGFybVJ1bm5pbmcgPSBmYWxzZTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHR9KTsqXHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0Ly9TZXQgYWxhcm0gc3RhdGVcclxuXHRcdFx0XHRcdFx0XHRcdGFsYXJtUnVubmluZyA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdGZ1bmN0aW9uIF9nZW5lcmF0ZUFsZXJ0cyhkYXRhKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhciB3YXRjaGxpc3RBbGVydHMgPSBkYXRhWyd3YXRjaGxpc3QtcXVldWUnXS5sZW5ndGg7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBhbGVydHMgPSBmZWVkQWxlcnRzOy8vICsgd2F0Y2hsaXN0QWxlcnRzO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2YXIgYWxlcnRTdHJpbmcgPSBcIlwiO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9Tb3VuZGF0aW9uIG5vdGlmcyBoYW5kbGVyXHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChmZWVkQWxlcnRzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGF1dGhvcnMgPSBbXTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9HcmFiIGF1dGhvcnNcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQkYXNpZGUuZmluZCgnYS5hdXRob3InKS5lYWNoKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YXV0aG9yID0gJCh0aGlzKS50ZXh0KCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoYXV0aG9ycy5pbmRleE9mKGF1dGhvcikgPT0gLTEpIGF1dGhvcnMucHVzaChhdXRob3IpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvL0luaXRpYWxpemUgYXV0aG9yIHN0cmluZ1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBhdXRob3JDb3VudCA9IGF1dGhvcnMubGVuZ3RoXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIG90aGVycyA9IGF1dGhvckNvdW50IC0gMztcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhbGVydFN0cmluZyA9IGZlZWRBbGVydHMgKyBcIiBuZXcgZnJvbSBcIjtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9JdGVyYXRlIGF1dGhvcnNcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgaSA9IDA7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICg7IGkgPCAyICYmIGkgPCAoYXV0aG9yQ291bnQgLSAxKTsgKytpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhbGVydFN0cmluZyArPSBhdXRob3JzW2ldICsgXCIsIFwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9BZGQgZmluYWwgYXV0aG9yXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0YWxlcnRTdHJpbmcgKz0gYXV0aG9yc1tpXTtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9BZGQgb3RoZXJzLCBpZiBuZWVkZWRcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAob3RoZXJzID4gMCkgYWxlcnRTdHJpbmcgKz0gXCIsIHBsdXMgXCIgKyBvdGhlcnMgKyBcIiBvdGhlclwiICsgKG90aGVycyA+IDEgPyBcInNcIiA6IFwiXCIpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoKGhhc2hlcy5pbmRleE9mKGFzaWRlSGFzaCkgPT0gLTEpICYmIGRhdGFbJ2Rlc2t0b3Bfbm90aWZzJ10pIGNocm9tZS5ub3RpZmljYXRpb25zLmNyZWF0ZShhc2lkZUhhc2gsIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHR5cGU6IFwiYmFzaWNcIixcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGljb25Vcmw6IFwiaW1nL2ljb25hcHAucG5nXCIsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aXRsZTogXCJTb3VuZGF0aW9uIE5vdGlmaWNhdGlvbnNcIixcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdG1lc3NhZ2U6IGZlZWRBbGVydHMgKyBcIiBuZXcgbm90aWZpY2F0aW9uXCIgKyAocGFyc2VJbnQoZmVlZEFsZXJ0cykgPiAxID8gXCJzXCIgOiBcIlwiKSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnRleHRNZXNzYWdlOiBhbGVydFN0cmluZy5yZXBsYWNlKC9cXGQqIG5ldyAvLCBcIlwiKVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0sIGZ1bmN0aW9uKG5vdGlmaWNhdGlvbklkKSB7aGFzaGVzLnB1c2goYXNpZGVIYXNoKX0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL05vIFNvdW5kYXRpb24gbm90aWZzXHJcblx0XHRcdFx0XHRcdFx0XHRcdGVsc2UgeyAvKiBEbyBub3RoaW5nICogfVxyXG5cclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly9XYXRjaGxpc3Qgbm90aWZzIGhhbmRsZXJcclxuXHRcdFx0XHRcdFx0XHRcdFx0LyppZiAod2F0Y2hsaXN0QWxlcnRzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0YWxlcnRTdHJpbmcgKz0gKGFsZXJ0U3RyaW5nID8gXCJcXG5cIiA6IFwiXCIpICsgd2F0Y2hsaXN0QWxlcnRzICsgXCIgbmV3IGZyb20gd2F0Y2hsaXN0XCI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH0qXHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0XHQvL0dsb2JhbCBub3RpZnMgaGFuZGxlclxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoYWxlcnRzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9VcGRhZ2UgYmFkZ2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjcmFwaS5iYWRnZSh7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aXRsZTogYWxlcnRTdHJpbmcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb2xvcjogXCJyZWRcIixcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHRleHQ6IFN0cmluZyhhbGVydHMpXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdC8vTm8gZ2xvYmFsIG5vdGlmc1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhbGVydFN0cmluZyA9IFwiTm8gbmV3IG5vdGlmaWNhdGlvbnMgOihcIjtcclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly9VcGRhdGUgYmFkZ2VcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRjcmFwaS5iYWRnZSh7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0aXRsZTogYWxlcnRTdHJpbmcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR0ZXh0OiBcIlwiXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRcdFx0XHRcdHJldHVybiBhbGVydFN0cmluZztcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn0qL1xyXG5cclxuLy9DaGVjayB3YXRjaGxpc3RcclxuLypmdW5jdGlvbiBjaGVja193YXRjaGxpc3QobWUsIHVwZGF0ZSwgY2FsbGJhY2spIHtcclxuXHRpZiAodHlwZW9mIHVwZGF0ZSA9PSBcInVuZGVmaW5lZFwiKSB1cGRhdGUgPSB0cnVlO1xyXG5cdGlmICh0eXBlb2YgY2FsbGJhY2sgPT0gXCJ1bmRlZmluZWRcIikgY2FsbGJhY2sgPSBmdW5jdGlvbigpe307XHJcblxyXG5cdHZhciBlbWFpbCA9IG1lLmVtYWlsO1xyXG5cclxuXHQvL0JlZ2luIHRyYWNlIGdyb3VwXHJcblx0Y29uc29sZS5ncm91cChcIk1vZGF0aW9uIDo6IENoZWNrIHdhdGNobGlzdFwiKTtcclxuXHJcblx0dmFyIHdQYXJzZWQgPSBbXTtcclxuXHR2YXIgd0ZhaWxlZCA9IFtdO1xyXG5cclxuXHRjcmFwaS5jbG9uZShmdW5jdGlvbihkKSB7XHJcblx0XHQvL1VzZSBlbXB0eSBhcnJheSBpZiBubyB3YXRjaGxpc3QgKGlzc3VlICM0MilcclxuXHRcdHZhciB3YXRjaGxpc3QgPSBkW2VtYWlsXVtcIndhdGNobGlzdFwiXSB8fCBbXTtcclxuXHRcdHZhciB3TGVuID0gd2F0Y2hsaXN0Lmxlbmd0aDtcclxuXHRcdHZhciB3Q3QgPSAwO1xyXG5cclxuXHRcdC8vU2tpcCBlbXB0eSB3YXRjaGxpc3QgaXRlcmF0aW9uIChpc3N1ZSAjNDIpXHJcblx0XHRpZiAod0xlbikge1xyXG5cdFx0XHQvL1RyYWNlIHdhdGNobGlzdCBxdWV1ZWluZyBzdGFydFxyXG5cdFx0XHRjb25zb2xlLmdyb3VwKFwiUXVldWVpbmcgd2F0Y2hsaXN0Li4uXCIpO1xyXG5cclxuXHRcdFx0Ly9Db3VudCB1cCBpbnZhbGlkIGxpbmtzIGFuZCBhZGp1c3Qgd0xlbiBhY2NvcmRpbmdseVxyXG5cdFx0XHQkLmVhY2god2F0Y2hsaXN0LCBmdW5jdGlvbihpLCB2KSB7XHJcblx0XHRcdFx0dmFyIGxpbmsgPSB2WydsaW5rJ107XHJcblxyXG5cdFx0XHRcdCQuZ2V0KGdsb2JhbC5wYXRoLmhvbWUgKyBcIi9cIiArIGxpbmssIGZ1bmN0aW9uKGh0bWwpIHtcclxuXHRcdFx0XHRcdHZbJ2h0bWwnXSA9IGh0bWw7XHJcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKFwibGluayBcIiArIGxpbmsgKyBcIiBzdWNjZXNzLCBwdXNoaW5nIHRvIHdQYXJzZWRcIik7XHJcblx0XHRcdFx0XHR3UGFyc2VkW2ldID0gdjtcclxuXHRcdFx0XHR9KS5mYWlsKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyhcImxpbmsgXCIgKyBsaW5rICsgXCIgZmFpbGVkLCBwdXNoaW5nIHRvIHdGYWlsZWRcIik7XHJcblx0XHRcdFx0XHR2WydmYWlsJ10gPSB0cnVlO1xyXG5cdFx0XHRcdFx0d1BhcnNlZFtpXSA9IHY7XHJcblx0XHRcdFx0XHR3RmFpbGVkW2ldID0gdjtcclxuXHRcdFx0XHR9KS5kb25lKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0ZGVsZXRlIHZbJ2ZhaWwnXTtcclxuXHRcdFx0XHR9KS5hbHdheXMoZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRfY29tcGxldGUoKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0ZnVuY3Rpb24gX2NvbXBsZXRlKCkge1xyXG5cdFx0XHRcdFx0Ly9UcmFjZSBxdWV1ZWQgaXRlbSBhbmQgaW5jcmVtZW50IGNvdW50ZXJcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKFwiUXVldWVkIGl0ZW0gJWQgb2YgJWQ6ICVzXCIsICsrd0N0LCB3TGVuLCBsaW5rKTtcclxuXHJcblx0XHRcdFx0XHQvL0lmIGxhc3QgaW5kZXgsIHJ1biBpdGVyYXRpb25cclxuXHRcdFx0XHRcdGlmICh3Q3QgPT0gd0xlbikge1xyXG5cdFx0XHRcdFx0XHQvL0VuZCB0cmFjZSBncm91cFxyXG5cdFx0XHRcdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XHJcblxyXG5cdFx0XHRcdFx0XHQvL0l0ZXJhdGUgaXRlbXNcclxuXHRcdFx0XHRcdFx0X2l0ZXJhdGUoKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vV2F0Y2hsaXN0IGlzIGVtcHR5XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Y29uc29sZS5pbmZvKFwiV2F0Y2hsaXN0IGlzIGVtcHR5LCBieXBhc3Npbmcgd2F0Y2hsaXN0IGNoZWNrXCIpO1xyXG5cclxuXHRcdFx0Ly9FbmQgdHJhY2UgZ3JvdXBcclxuXHRcdFx0Y29uc29sZS5ncm91cEVuZCgpO1xyXG5cclxuXHRcdFx0Ly9SdW4gY2FsbGJhY2tcclxuXHRcdFx0Y2FsbGJhY2soZFtlbWFpbF0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vSXRlcmF0ZSB3YXRjaGxpc3QgaXRlbXNcclxuXHRcdGZ1bmN0aW9uIF9pdGVyYXRlKCkge1xyXG5cdFx0XHQvL1RyYWNlIHdhdGNobGlzdCBpdGVyYXRpb24gc3RhcnRcclxuXHRcdFx0Y29uc29sZS5ncm91cENvbGxhcHNlZChcIkl0ZXJhdGluZyB3YXRjaGxpc3QuLi5cIik7XHJcblxyXG5cdFx0XHR2YXIgd0NoYW5nZWQgPSBbXTtcclxuXHJcblx0XHRcdC8vTG9vcCB0aHJvdWdoIHF1ZXVlZCBpdGVtc1xyXG5cdFx0XHQkLmVhY2god1BhcnNlZCwgZnVuY3Rpb24oaSwgdikge1xyXG5cdFx0XHRcdHZhciB3SXRlbSA9IHY7XHJcblx0XHRcdFx0dmFyIGxpbmsgPSB3SXRlbVsnbGluayddO1xyXG5cdFx0XHRcdHZhciBodG1sID0gd0l0ZW1bJ2h0bWwnXTtcclxuXHRcdFx0XHR2YXIgJGh0bWwgPSAkKGh0bWwpO1xyXG5cdFx0XHRcdHZhciB3TmV3SXRlbSA9IHt9O1xyXG5cdFx0XHRcdHZhciB3Q2hhbmdlZEl0ZW0gPSB7fTtcclxuXHRcdFx0XHR3Q2hhbmdlZEl0ZW0uc3RhdGUgPSB7fTtcclxuXHJcblx0XHRcdFx0Ly9DbGVhciB0ZW1wb3Jhcnkgc291cmNlIHN0b3JhZ2VcclxuXHRcdFx0XHRkZWxldGUgd0l0ZW1bJ2h0bWwnXTtcclxuXHJcblx0XHRcdFx0Ly9UeXBlIHN3aXRjaGVzXHJcblx0XHRcdFx0dmFyIGlzVHJhY2sgPSAobGluay5tYXRjaCgvdXNlclxcLy4qXFwvdHJhY2tcXC8vKSA/IHRydWUgOiBmYWxzZSk7XHJcblx0XHRcdFx0Ly9OT1RFOiBBc3RlcmlzayBpbiB0aGUgLy4vIHRoaW5nISEhISFcclxuXHRcdFx0XHR2YXIgaXNHcm91cCA9IChsaW5rLm1hdGNoKC9ncm91cFxcLy4vKSA/IHRydWUgOiBmYWxzZSk7XHJcblxyXG5cdFx0XHRcdC8vR3JhYiBmaXJzdCBjb21tZW50J3MgYWN0aW9uIGJ1dHRvbnMgdG8gZGV0ZXJtaW5lIElEXHJcblx0XHRcdFx0dmFyICRjQWN0aW9ucyA9ICRodG1sLmZpbmQoXCIuY29tbWVudCAuYWN0aW9uc1wiKS5jaGlsZHJlbihcIi5mbGFnLCAuZGVsZXRlXCIpLmZpcnN0KCk7XHJcblxyXG5cdFx0XHRcdC8vSXMgdHJhY2tcclxuXHRcdFx0XHRpZiAoaXNUcmFjaykge1xyXG5cdFx0XHRcdFx0d05ld0l0ZW1bJ3RpdGxlJ10gPSAkaHRtbC5maW5kKFwiI21haW4gLnRpdGxlXCIpLnRleHQoKTtcclxuXHRcdFx0XHRcdHdOZXdJdGVtWydsaWtlcyddID0gJGh0bWwuZmluZChcIi5zdGF0cyAubGlrZXNcIikudGV4dCgpO1xyXG5cdFx0XHRcdFx0d05ld0l0ZW1bJ2Rvd25sb2FkcyddID0gJGh0bWwuZmluZChcIi5zdGF0cyAuZG93bmxvYWRzXCIpLnRleHQoKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vSXMgZ3JvdXBcclxuXHRcdFx0XHRlbHNlIGlmIChpc0dyb3VwKSB7XHJcblx0XHRcdFx0XHR3TmV3SXRlbVsndGl0bGUnXSA9ICRodG1sLmZpbmQoXCIjZ3JvdXAtaW5mbyBoMlwiKS5odG1sKCk7XHJcblx0XHRcdFx0XHR2YXIgZ3JvdXBJbmZvID0gJGh0bWwuZmluZChcIiNncm91cC1pbmZvIC5pbmZvXCIpLnRleHQoKTtcclxuXHJcblx0XHRcdFx0XHQvL0NhdGNoIG5ldHdvcmsgZXJyb3JzIChpc3N1ZSAjMzEpXHJcblx0XHRcdFx0XHRpZiAoZ3JvdXBJbmZvKSB7XHJcblx0XHRcdFx0XHRcdHdOZXdJdGVtWydtZW1iZXJzJ10gPSBncm91cEluZm8ubWF0Y2goLyhcXGQqKSBtZW1iZXIvKVsxXTtcclxuXHRcdFx0XHRcdFx0d05ld0l0ZW1bJ2ZvbGxvd2luZyddID0gZ3JvdXBJbmZvLm1hdGNoKC8oXFxkKikgZm9sbG93ZXIvKVsxXTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdFx0Ly9Mb2cgZmFpbHVyZVxyXG5cdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJOZXR3b3JrIGNoYW5nZSBkZXRlY3RlZCwgc2tpcHBpbmcgZ3JvdXAgcGFyc2VcIik7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvL0NvbW1lbnRzIGV4aXN0XHJcblx0XHRcdFx0aWYgKCRjQWN0aW9ucy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdHZhciBhdHRyO1xyXG5cdFx0XHRcdFx0c3dpdGNoICgkY0FjdGlvbnMuYXR0cihcImNsYXNzXCIpKSB7XHJcblx0XHRcdFx0XHRcdGNhc2UgXCJmbGFnXCI6XHJcblx0XHRcdFx0XHRcdFx0YXR0ciA9ICRjQWN0aW9ucy5hdHRyKFwib25jbGlja1wiKTtcclxuXHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0Y2FzZSBcImRlbGV0ZVwiOlxyXG5cdFx0XHRcdFx0XHRcdGF0dHIgPSAkY0FjdGlvbnMuYXR0cihcImhyZWZcIik7XHJcblx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBhdHRyICE9IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdFx0XHRcdFx0d05ld0l0ZW1bJ2NvbW1lbnQnXSA9IGF0dHIubWF0Y2goLyhcXGQrKS9nKVswXTtcclxuXHJcblx0XHRcdFx0XHRcdC8vU3RvcmFnZSBmb3IgdXNlciBsaW5rc1xyXG5cdFx0XHRcdFx0XHR2YXIgbXlMaW5rID0gbWUucHJvZmlsZTtcclxuXHRcdFx0XHRcdFx0dmFyIHlvdXJMaW5rID0gJGNBY3Rpb25zLnBhcmVudHMoXCIuY29tbWVudFwiKS5maW5kKFwiaDQgYVwiKS5hdHRyKFwiaHJlZlwiKTtcclxuXHJcblx0XHRcdFx0XHRcdC8vSWYgc2VsZi1jb21tZW50IGRldGVjdGVkLCBieXBhc3Mgbm90aWZpY2F0aW9uIHF1ZXVlXHJcblx0XHRcdFx0XHRcdGlmIChteUxpbmsgPT0geW91ckxpbmspIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zb2xlLmluZm8oXCJEZXRlY3RlZCBzZWxmLWNvbW1lbnQsIGJ5cGFzc2luZyBxdWV1ZSBmb3IgXCIgKyB3TmV3SXRlbVsndGl0bGUnXSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdC8vU2F2ZSBzdGF0ZSBkaXJlY3RseSB0byB3YXRjaGxpc3RcclxuXHRcdFx0XHRcdFx0XHRkW2VtYWlsXVsnd2F0Y2hsaXN0J11baV1bJ2NvbW1lbnQnXSA9IHdOZXdJdGVtWydjb21tZW50J107XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vSW5pdGlhbGl6ZSBjaGVja2VyIHRoaW5nc1xyXG5cdFx0XHRcdHZhciB0aXRsZSA9IHdOZXdJdGVtWyd0aXRsZSddO1xyXG5cdFx0XHRcdHZhciBsaWtlcyA9IHdOZXdJdGVtWydsaWtlcyddO1xyXG5cdFx0XHRcdHZhciBkb3dubG9hZHMgPSB3TmV3SXRlbVsnZG93bmxvYWRzJ107XHJcblx0XHRcdFx0dmFyIG1lbWJlcnMgPSB3TmV3SXRlbVsnbWVtYmVycyddO1xyXG5cdFx0XHRcdHZhciBmb2xsb3dpbmcgPSB3TmV3SXRlbVsnZm9sbG93aW5nJ107XHJcblx0XHRcdFx0dmFyIGNvbW1lbnQgPSB3TmV3SXRlbVsnY29tbWVudCddO1xyXG5cclxuXHRcdFx0XHR3Q2hhbmdlZEl0ZW1bJ2NoYW5nZXMnXSA9IFtdO1xyXG5cclxuXHRcdFx0XHQvL1RpdGxlIGhvb2tcclxuXHRcdFx0XHRpZiAodGl0bGUpIHtcclxuXHRcdFx0XHRcdHdDaGFuZ2VkSXRlbVsndGl0bGUnXSA9IHRpdGxlO1xyXG5cdFx0XHRcdFx0d0NoYW5nZWRJdGVtLnN0YXRlLnRpdGxlID0gdGl0bGU7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvL0xpa2VzIGhvb2tcclxuXHRcdFx0XHRpZiAobGlrZXMgJiYgd0l0ZW1bJ2xpa2VzJ10gIT0gbGlrZXMpIHtcclxuXHRcdFx0XHRcdHZhciBsRGlmID0gbGlrZXMgLSB3SXRlbVsnbGlrZXMnXTtcclxuXHRcdFx0XHRcdHZhciBsRGlmU3RyID0gbERpZjtcclxuXHRcdFx0XHRcdGlmIChsRGlmID4gMCkgbERpZlN0ciA9IFwiK1wiICsgbERpZjtcclxuXHJcblx0XHRcdFx0XHQvL1NldCBsaWtlcyBpbiBzdG9yYWdlXHJcblx0XHRcdFx0XHR3Q2hhbmdlZEl0ZW0uc3RhdGUubGlrZXMgPSBsaWtlcztcclxuXHJcblx0XHRcdFx0XHR2YXIgaXNOZXcgPSB0eXBlb2Ygd0l0ZW1bJ2xpa2VzJ10gPT0gXCJ1bmRlZmluZWRcIjtcclxuXHJcblx0XHRcdFx0XHRpZiAoIWlzTmFOKGxEaWYpIHx8IGlzTmV3KSB7XHJcblx0XHRcdFx0XHRcdGlmIChpc05ldykgbERpZiA9IGxEaWZTdHIgPSBsaWtlcztcclxuXHRcdFx0XHRcdFx0d0NoYW5nZWRJdGVtWydsaWtlcyddID0gbERpZlN0ciArIFwiIGxpa2VcIiArIChNYXRoLmFicyhsRGlmKSA+IDEgfHwgbERpZiA9PSAwID8gXCJzXCIgOiBcIlwiKTtcclxuXHRcdFx0XHRcdFx0d0NoYW5nZWRJdGVtWydjaGFuZ2VzJ10ucHVzaChsRGlmU3RyICsgXCIgbGlrZVwiICsgKE1hdGguYWJzKGxEaWYpID4gMSB8fCBsRGlmID09IDAgPyBcInNcIiA6IFwiXCIpKTtcclxuXHRcdFx0XHRcdFx0Ly9hbGVydCh0aXRsZSArIFwiIDo6IFwiICsgbERpZlN0ciArIFwiIGxpa2VcIiArIChNYXRoLmFicyhsRGlmKSA+IDEgfHwgbERpZiA9PSAwID8gXCJzXCIgOiBcIlwiKSlcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vRG93bmxvYWRzIGhvb2tcclxuXHRcdFx0XHRpZiAoZG93bmxvYWRzICYmIHdJdGVtWydkb3dubG9hZHMnXSAhPSBkb3dubG9hZHMpIHtcclxuXHRcdFx0XHRcdHZhciBkRGlmID0gZG93bmxvYWRzIC0gd0l0ZW1bJ2Rvd25sb2FkcyddO1xyXG5cdFx0XHRcdFx0dmFyIGREaWZTdHIgPSBcIitcIiArIGREaWY7XHJcblxyXG5cdFx0XHRcdFx0Ly9TZXQgZG93bmxvYWRzIGluIHN0b3JhZ2VcclxuXHRcdFx0XHRcdHdDaGFuZ2VkSXRlbS5zdGF0ZS5kb3dubG9hZHMgPSBkb3dubG9hZHM7XHJcblxyXG5cdFx0XHRcdFx0dmFyIGlzTmV3ID0gdHlwZW9mIHdJdGVtWydkb3dubG9hZHMnXSA9PSBcInVuZGVmaW5lZFwiO1xyXG5cclxuXHRcdFx0XHRcdGlmICghaXNOYU4oZERpZikgfHwgaXNOZXcpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGlzTmV3KSBkRGlmID0gZERpZlN0ciA9IGRvd25sb2FkcztcclxuXHRcdFx0XHRcdFx0d0NoYW5nZWRJdGVtWydkb3dubG9hZHMnXSA9IGREaWZTdHIgKyBcIiBkb3dubG9hZFwiICsgKGREaWYgIT09IDEgPyBcInNcIiA6IFwiXCIpO1xyXG5cdFx0XHRcdFx0XHR3Q2hhbmdlZEl0ZW1bJ2NoYW5nZXMnXS5wdXNoKGREaWZTdHIgKyBcIiBkb3dubG9hZFwiICsgKGREaWYgIT09IDEgPyBcInNcIiA6IFwiXCIpKTtcclxuXHRcdFx0XHRcdFx0Ly9hbGVydCh0aXRsZSArIFwiIDo6IFwiICsgZERpZlN0ciArIFwiIGRvd25sb2FkXCIgKyAoZERpZiA+IDEgPyBcInNcIiA6IFwiXCIpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vTWVtYmVycyBob29rXHJcblx0XHRcdFx0aWYgKG1lbWJlcnMgJiYgd0l0ZW1bJ21lbWJlcnMnXSAhPSBtZW1iZXJzKSB7XHJcblx0XHRcdFx0XHR2YXIgbURpZiA9IG1lbWJlcnMgLSB3SXRlbVsnbWVtYmVycyddO1xyXG5cdFx0XHRcdFx0dmFyIG1EaWZTdHIgPSBtRGlmO1xyXG5cdFx0XHRcdFx0aWYgKG1EaWYgPiAwKSBtRGlmU3RyID0gXCIrXCIgKyBtRGlmO1xyXG5cclxuXHRcdFx0XHRcdC8vU2V0IG1lbWJlcnMgaW4gc3RvcmFnZVxyXG5cdFx0XHRcdFx0d0NoYW5nZWRJdGVtLnN0YXRlLm1lbWJlcnMgPSBtZW1iZXJzO1xyXG5cclxuXHRcdFx0XHRcdHZhciBpc05ldyA9IHR5cGVvZiB3SXRlbVsnbWVtYmVycyddID09IFwidW5kZWZpbmVkXCI7XHJcblxyXG5cdFx0XHRcdFx0aWYgKCFpc05hTihtRGlmKSB8fCBpc05ldykge1xyXG5cdFx0XHRcdFx0XHRpZiAoaXNOZXcpIG1EaWYgPSBtRGlmU3RyID0gbWVtYmVycztcclxuXHRcdFx0XHRcdFx0d0NoYW5nZWRJdGVtWydtZW1iZXJzJ10gPSBtRGlmU3RyICsgXCIgbWVtYmVyXCIgKyAoTWF0aC5hYnMobURpZikgPiAxIHx8IG1EaWYgPT0gMCA/IFwic1wiIDogXCJcIik7XHJcblx0XHRcdFx0XHRcdHdDaGFuZ2VkSXRlbVsnY2hhbmdlcyddLnB1c2gobURpZlN0ciArIFwiIG1lbWJlclwiICsgKE1hdGguYWJzKG1EaWYpID4gMSB8fCBtRGlmID09IDAgPyBcInNcIiA6IFwiXCIpKTtcclxuXHRcdFx0XHRcdFx0Ly9hbGVydCh0aXRsZSArIFwiIDo6IFwiICsgbURpZlN0ciArIFwiIG1lbWJlclwiICsgKE1hdGguYWJzKG1EaWYpID4gMSB8fCBtRGlmID09IDAgPyBcInNcIiA6IFwiXCIpKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vRm9sbG93ZXJzIGhvb2tcclxuXHRcdFx0XHRpZiAoZm9sbG93aW5nICYmIHdJdGVtWydmb2xsb3dpbmcnXSAhPSBmb2xsb3dpbmcpIHtcclxuXHRcdFx0XHRcdHZhciBmRGlmID0gZm9sbG93aW5nIC0gd0l0ZW1bJ2ZvbGxvd2luZyddO1xyXG5cdFx0XHRcdFx0dmFyIGZEaWZTdHIgPSBmRGlmO1xyXG5cdFx0XHRcdFx0aWYgKGZEaWYgPiAwKSBmRGlmU3RyID0gXCIrXCIgKyBmRGlmO1xyXG5cclxuXHRcdFx0XHRcdC8vU2V0IGZvbGxvd2luZyBpbiBzdG9yYWdlXHJcblx0XHRcdFx0XHR3Q2hhbmdlZEl0ZW0uc3RhdGUuZm9sbG93aW5nID0gZm9sbG93aW5nO1xyXG5cclxuXHRcdFx0XHRcdHZhciBpc05ldyA9IHR5cGVvZiB3SXRlbVsnZm9sbG93aW5nJ10gPT0gXCJ1bmRlZmluZWRcIjtcclxuXHJcblx0XHRcdFx0XHRpZiAoIWlzTmFOKGZEaWYpIHx8IHR5cGVvZiB3SXRlbVsnZm9sbG93aW5nJ10gPT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0XHRcdFx0XHRpZiAoaXNOZXcpIGZEaWYgPSBmRGlmU3RyID0gZm9sbG93aW5nO1xyXG5cdFx0XHRcdFx0XHR3Q2hhbmdlZEl0ZW1bJ2ZvbGxvd2luZyddID0gZkRpZlN0ciArIFwiIGZvbGxvd2VyXCIgKyAoTWF0aC5hYnMoZkRpZikgPiAxIHx8IGZEaWYgPT0gMCA/IFwic1wiIDogXCJcIik7XHJcblx0XHRcdFx0XHRcdHdDaGFuZ2VkSXRlbVsnY2hhbmdlcyddLnB1c2goZkRpZlN0ciArIFwiIGZvbGxvd2VyXCIgKyAoTWF0aC5hYnMoZkRpZikgPiAxIHx8IGZEaWYgPT0gMCA/IFwic1wiIDogXCJcIikpO1xyXG5cdFx0XHRcdFx0XHQvL2FsZXJ0KHRpdGxlICsgXCIgOjogXCIgKyBmRGlmU3RyICsgXCIgZm9sbG93ZXJcIiArIChNYXRoLmFicyhmRGlmKSA+IDEgfHwgZkRpZiA9PSAwID8gXCJzXCIgOiBcIlwiKSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHQvL0NvbW1lbnRzIGhvb2tcclxuXHRcdFx0XHRpZiAoY29tbWVudCAmJiB3SXRlbVsnY29tbWVudCddICE9IGNvbW1lbnQpIHtcclxuXHRcdFx0XHRcdC8vQlVHRklYOiBBbGVydCB3YXMgZGlzcGxheWluZyBmb3IgZXZlcnkgYWRkZWQgd2F0Y2hsaXN0IGl0ZW1cclxuXHRcdFx0XHRcdC8vaWYgKHR5cGVvZiB3SXRlbVsnY29tbWVudCddICE9IFwidW5kZWZpbmVkXCIpIHtcclxuXHRcdFx0XHRcdFx0d0NoYW5nZWRJdGVtWydjb21tZW50J10gPSBcIk5ldyBjb21tZW50XCI7XHJcblx0XHRcdFx0XHRcdHdDaGFuZ2VkSXRlbVsnY2hhbmdlcyddLnB1c2goXCJOZXcgY29tbWVudFwiKTtcclxuXHRcdFx0XHRcdFx0Ly9hbGVydCh0aXRsZSArIFwiIDo6IE5ldyBjb21tZW50XCIpO1xyXG5cdFx0XHRcdFx0Ly99XHJcblxyXG5cdFx0XHRcdFx0Ly9TZXQgY29tbWVudCBpbiBzdG9yYWdlXHJcblx0XHRcdFx0XHR3Q2hhbmdlZEl0ZW0uc3RhdGUuY29tbWVudCA9IGNvbW1lbnQ7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAod0NoYW5nZWRJdGVtWydjaGFuZ2VzJ10ubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHR3Q2hhbmdlZEl0ZW1bJ2xpbmsnXSA9IGxpbms7XHJcblx0XHRcdFx0XHR3Q2hhbmdlZEl0ZW1bJ2luZGV4J10gPSBpO1xyXG5cclxuXHRcdFx0XHRcdHdDaGFuZ2VkLnB1c2god0NoYW5nZWRJdGVtKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vVHJhY2UgaXRlcmF0aW9uXHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJQYXJzZWQgaXRlbSAlczogJU9cIiwgbGluaywgd0NoYW5nZWRJdGVtKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvL0VuZCB0cmFjZSBncm91cFxyXG5cdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XHJcblxyXG5cdFx0XHQvL1N0b3JlIHdhdGNobGlzdCBxdWV1ZVxyXG5cdFx0XHRkW2VtYWlsXVsnd2F0Y2hsaXN0LXF1ZXVlJ10gPSB3Q2hhbmdlZDtcclxuXHJcblx0XHRcdCQuZWFjaCh3Q2hhbmdlZCwgZnVuY3Rpb24oaSwgaXRlbSkge1xyXG5cdFx0XHRcdHZhciBoYXNoID0gU3RyaW5nKEpTT04uc3RyaW5naWZ5KGl0ZW0pLmhhc2hDb2RlKCkpO1xyXG5cclxuXHRcdFx0XHQvL0dlbmVyYXRlIG5vdGlmaWNhdGlvblxyXG5cdFx0XHRcdGlmICgoaGFzaGVzLmluZGV4T2YoaGFzaCkgPT0gLTEpKSB7XHJcblx0XHRcdFx0XHRjaHJvbWUubm90aWZpY2F0aW9ucy5jcmVhdGUoaGFzaCwge1xyXG5cdFx0XHRcdFx0XHR0eXBlOiBcImJhc2ljXCIsXHJcblx0XHRcdFx0XHRcdGljb25Vcmw6IFwiaW1nL2ljb25hcHAucG5nXCIsXHJcblx0XHRcdFx0XHRcdHRpdGxlOiBcIk1vZGF0aW9uIFdhdGNobGlzdFwiLFxyXG5cdFx0XHRcdFx0XHRtZXNzYWdlOiBpdGVtWyd0aXRsZSddLFxyXG5cdFx0XHRcdFx0XHRjb250ZXh0TWVzc2FnZTogaXRlbVsnY2hhbmdlcyddLmpvaW4oXCIsIFwiKVxyXG5cdFx0XHRcdFx0fSwgZnVuY3Rpb24obklEKXtoYXNoZXMucHVzaChoYXNoKX0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvL0VuZCB0cmFjZSBncm91cFxyXG5cdFx0XHRjb25zb2xlLmdyb3VwRW5kKCk7XHJcblxyXG5cdFx0XHRpZiAodXBkYXRlKSBjcmFwaS51cGRhdGUoZW1haWwsIGRbZW1haWxdLCBjYWxsYmFjayk7XHJcblx0XHRcdGVsc2UgY2FsbGJhY2soZFtlbWFpbF0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59Ki9cclxuXHJcbi8qIENoZWNrIGlmIGRlc2t0b3Agbm90aWZpY2F0aW9ucyBzaG91bGQgYmUgc2hvd24gKi9cclxuLypmdW5jdGlvbiBkb05vdGlmcyhoYXNoKSB7XHJcblx0aWYgKCh0eXBlb2YgaGFzaCA9PSBcInVuZGVmaW5lZFwiKSB8fCAobG9jYWxTdG9yYWdlW2hhc2ggKyBcIi5kZXNrdG9wX25vdGlmc1wiXSA9PSBcIm9uXCIpKSB7IHJldHVybiB0cnVlOyB9XHJcblx0ZWxzZSBpZiAobG9jYWxTdG9yYWdlW2hhc2ggKyBcIi5kZXNrdG9wX25vdGlmc1wiXSA9PSBcIm9mZlwiKSB7IHJldHVybiBmYWxzZTsgfVxyXG5cdHJldHVybiB0cnVlO1xyXG59Ki9cclxuIl19
