function handle(t,o,e,n){void 0===n&&(n=!1);var r=$(t);r.off(o),r.on(o,e)}function getBlob(t,o){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="blob",e.onload=function(){var t=window.URL.createObjectURL(this.response);o(t)},e.send()}function getDataUri(t,c,i){void 0===i&&(i=c,c=!1);var o=new Image;o.onload=function(){var t=document.createElement("canvas");t.width=this.naturalWidth,t.height=this.naturalHeight;var o=t.getContext("2d");if(o.drawImage(this,0,0),c){var e=t.width/2,n=t.height/2,r=new Image;r.onload=function(){o.fillStyle="white",o.fillRect(e,n,e,n),o.drawImage(this,e,n,e,n),s()},r.src=c}else s();function s(){i(t.toDataURL("image/png"))}},o.src=t}function localJSON(t,o){if(void 0===o){var e=localStorage[t];return void 0!==e&&(e=$.parseJSON(e)),e}""===o?delete localStorage[t]:localStorage[t]=JSON.stringify(o)}function showView(t,o,e){void 0===e&&(e=170),0<e?($(t).fadeOut(e),$(o).delay(e).fadeIn(e)):($(t).hide(),$(o).show())}function _factory(t,o){return $(t+" "+o).clone()}function CrAPI(){console.log("%cCrAPI%c :: Init","font-weight: bold; color: green",""),this.DEFAULT_CALLBACK=function(t){return void 0!==t&&t},this.badgeColors={gray:"#9a9a9a",red:"#d00"},this.badgeOptions={title:!1,color:!1,text:!1},void 0===localStorage.crapi_locked&&(localStorage.crapi_locked="")}String.prototype.hashCode=function(){var t,o=0;if(0===this.length)return o;for(t=0,l=this.length;t<l;t++)o=(o<<5)-o+this.charCodeAt(t),o|=0;return o},String.prototype.deres=function(){return this.replace(/img[^>]*>/g,"")},String.prototype.decamel=function(){return this.replace(/(?=[a-zA-z])(?=[A-Z])/g,"-").toLowerCase()},String.prototype.matchAny=function(t){var e=this,n=!1;return $.each(t,function(t,o){if(e.match(o))return n=t,!1}),n},Array.prototype.unique=function(){return this.reduce(function(t,o){return t.indexOf(o)<0&&t.push(o),t},[])},Array.prototype.diff=function(e){return this.reduce(function(t,o){return-1==e.indexOf(o)&&t.push(o),t},[])},crapi=new CrAPI,CrAPI.prototype.manifest=function(){return chrome.runtime.getManifest()},CrAPI.prototype.reload=function(){location.reload()},localJSON("crapi_self")?CrAPI.prototype.self=localJSON("crapi_self"):chrome.runtime.sendMessage({action:"getSelf",async:!0},function(t){localJSON("crapi_self",t),CrAPI.prototype.self=t,global.debug="development"===t.installType}),CrAPI.prototype.lock=function(t){void 0===t&&(t=""),localStorage.crapi_locked=t},CrAPI.prototype.locked=function(){return localStorage.crapi_locked},CrAPI.prototype.storage=function(t){switch(t=void 0===t?"sync":t){case"local":return chrome.storage.local;case"sync":return chrome.storage.sync;default:return!1}},CrAPI.prototype.clone=function(t,o){void 0===t&&(t=null,o=this.DEFAULT_CALLBACK),void 0===o&&(o=t,t=null),this.storage().get(t,function(t){console.log("%cCrAPI%c :: Clone storage: %O","font-weight: bold; color: green","",t),o(t)})},CrAPI.prototype.update=function(t,o,e){void 0===e&&(e=this.DEFAULT_CALLBACK);var n=this;if(n.locked())console.error("%cCrAPI%c :: Storage locked: %o","font-weight: bold; color: green","",this.locked),e(!1);else{var r={};r[t]=o,n.lock("Update storage"),n.storage().set(r,function(){n.lock(),console.log("%cCrAPI%c :: Update storage: %O","font-weight: bold; color: green","",r),e(o)})}},CrAPI.prototype.updateAll=function(t,o){void 0===o&&(o=this.DEFAULT_CALLBACK);var e=this;e.locked()?(console.error("%cCrAPI%c :: Storage locked: %o","font-weight: bold; color: green","",this.locked),o(!1)):(e.lock("Update all"),e.storage().set(t,function(){e.lock(),console.log("%cCrAPI%c :: Update all: %O","font-weight: bold; color: green","",t),o(!0)}))},CrAPI.prototype.badge=function(t){var o=$.extend({},this.badgeOptions,t),e=void 0!==this.badgeColors[o.color]?this.badgeColors[o.color]:o.color;!1!==o.title&&chrome.browserAction.setTitle({title:o.title}),!1!==e&&chrome.browserAction.setBadgeBackgroundColor({color:e}),!1!==o.text&&chrome.browserAction.setBadgeText({text:o.text})},CrAPI.prototype.tests={},CrAPI.prototype.runTests=function(){console.group("== CrAPI Tests ==");try{var t=[];$.each(this.tests,function(){t.push(this)}),console.debug("queue: %o",t);var o=function(){console.debug("== End of Tests =="),console.groupEnd()};for(i=t.length-1;0<=i;i--)o=e(t[i],this,[o]);o()}catch(t){console.error(t),console.groupEnd()}function e(t,o,e){return function(){t.apply(o,e)}}},CrAPI.prototype.tests.storageTest1=function(o){console.groupCollapsed("Test Chrome storage functions");try{var e=this;console.log("storageTest this: %o",this);var n=["test1","test2"],r={test1:"root set",test2:{initial:"data"}},s={test2:{secondary:"data"}};console.debug("Clearing test storage..."),e.storage().remove(n,function(){e.storage().get(n,function(t){console.debug("Blank storage: %s",JSON.stringify(t)),console.debug("Setting testData1: %o",r),e.storage().set(r,function(){e.storage().get(n,function(t){console.debug("Result: %s",JSON.stringify(t)),console.debug("Setting testData2: %o",s),e.storage().set($.extend(!0,{},t,s),function(){e.storage().get(n,function(t){console.debug("Result: %s",JSON.stringify(t)),console.groupEnd(),o()})})})})})})}catch(t){console.error(t),console.groupEnd()}},CrAPI.prototype.tests.storageTest2=function(o){console.groupCollapsed("Test CrAPI storage functions");try{var e=this,n=["test1","test2"],r={test1:"root set",test2:{initial:"data"}},s={test2:{secondary:"data"}};console.debug("Clearing test storage..."),e.storage().remove(n,function(){e.clone(n,function(t){console.debug("Blank storage: %s",JSON.stringify(t)),console.debug("Setting testData1: %o",r),e.updateAll(r,function(){e.clone(n,function(t){console.debug("Result: %s",JSON.stringify(t)),console.debug("Setting testData2: %o",s),e.updateAll($.extend(!0,{},t,s),function(){e.clone(n,function(t){console.debug("Result: %s",JSON.stringify(t)),console.groupEnd(),o()})})})})})})}catch(t){console.error(t),console.groupEnd()}};
modapi=new ModAPI,modapi.manifest=crapi.manifest();var protocol="https://",domain="soundation.com",global={debug:!!crapi.self&&"development"===crapi.self.installType,path:{protocol:protocol,domain:domain,home:protocol+domain,cookie:protocol+domain,login:protocol+domain+"?login=yes",feed:protocol+domain+"/feed",api:protocol+"api."+domain+"/me",songs:protocol+"api."+domain+"/songs",profile:protocol+domain+"/account/profile",messages:protocol+domain+"/account/messages"},cookie:"_soundation_session",storageModel:{options:{},watchlist:[],version:""},optionDefaults:{rememberMe:!1,showAlertsOnTop:!1,watchlist:!1,userTags:!0,userTagLinks:!1,moveCommentBox:!0,groupFilters:!0,moveGroupInvites:!0},regex:{messageLink:/\/account\/messages\/\d+$/,groupLink:/\/group\//,trackLink:/\/user\/.*\/track\//},watchlistModel:{track:{link:"",likes:0,downloads:0,comments:0},group:{link:"",lastComment:"",members:0,followers:0,tracks:0}}};function ModAPI(){console.log("%cModAPI%c :: Init","font-weight: bold; color: #f60",""),this.DEFAULT_CALLBACK=function(){}}ModAPI.prototype.login=function(a){void 0===a&&(a=this.DEFAULT_CALLBACK),console.log("%cModAPI%c :: Login","font-weight: bold; color: #f60",""),$.get(global.path.home,function(o){var e,t=o.deres(),n=$(t),i=n.find(".user-link").attr("href"),s=n.filter("[name=csrf-token]").attr("content");e=function(o){o.link=i,global.token=s,a(o)},$.getJSON(global.path.api).fail(function(){console.error("%cModAPI%c :: Unable to connect to Soundation API","font-weight: bold; color: #f60","")}).success(function(o){var t=o.data||o;t.success=o.success,e(t)})})},ModAPI.prototype.token=function(){return global.token};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNyYXBpLmpzIiwibW9kYXBpLmpzIl0sIm5hbWVzIjpbImhhbmRsZSIsInRhcmdldCIsImV2ZW50IiwiY2FsbGJhY2siLCJ0cmlnZ2VyIiwiJHRhcmdldCIsIiQiLCJvZmYiLCJvbiIsImdldEJsb2IiLCJ1cmwiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJyZXNwb25zZVR5cGUiLCJvbmxvYWQiLCJibG9iIiwid2luZG93IiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwidGhpcyIsInJlc3BvbnNlIiwic2VuZCIsImdldERhdGFVcmkiLCJvdmVybGF5VXJsIiwiaW1hZ2UiLCJJbWFnZSIsImNhbnZhcyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsIndpZHRoIiwibmF0dXJhbFdpZHRoIiwiaGVpZ2h0IiwibmF0dXJhbEhlaWdodCIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiZHJhd0ltYWdlIiwiaGFsZldpZHRoIiwiaGFsZkhlaWdodCIsIm92ZXJsYXkiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIl9jb250aW51ZSIsInNyYyIsInRvRGF0YVVSTCIsImxvY2FsSlNPTiIsImtleSIsImpzb24iLCJ2YWx1ZSIsImxvY2FsU3RvcmFnZSIsInBhcnNlSlNPTiIsIkpTT04iLCJzdHJpbmdpZnkiLCJzaG93VmlldyIsInZpZXciLCJmYWRlIiwiZmFkZU91dCIsImRlbGF5IiwiZmFkZUluIiwiaGlkZSIsInNob3ciLCJfZmFjdG9yeSIsInBhcmVudCIsImNsb25lIiwiQ3JBUEkiLCJjb25zb2xlIiwibG9nIiwiREVGQVVMVF9DQUxMQkFDSyIsImQiLCJiYWRnZUNvbG9ycyIsImdyYXkiLCJyZWQiLCJiYWRnZU9wdGlvbnMiLCJ0aXRsZSIsImNvbG9yIiwidGV4dCIsImNyYXBpX2xvY2tlZCIsIlN0cmluZyIsInByb3RvdHlwZSIsImhhc2hDb2RlIiwiaSIsImhhc2giLCJsZW5ndGgiLCJsIiwiY2hhckNvZGVBdCIsImRlcmVzIiwicmVwbGFjZSIsImRlY2FtZWwiLCJ0b0xvd2VyQ2FzZSIsIm1hdGNoQW55IiwicGF0dGVybnMiLCJ0aGF0IiwibWF0Y2hlZCIsImVhY2giLCJ2IiwibWF0Y2giLCJBcnJheSIsInVuaXF1ZSIsInJlZHVjZSIsInAiLCJjIiwiaW5kZXhPZiIsInB1c2giLCJkaWZmIiwiY29tcGFyZSIsImNyYXBpIiwibWFuaWZlc3QiLCJjaHJvbWUiLCJydW50aW1lIiwiZ2V0TWFuaWZlc3QiLCJyZWxvYWQiLCJsb2NhdGlvbiIsInNlbGYiLCJzZW5kTWVzc2FnZSIsImFjdGlvbiIsImFzeW5jIiwicmVzdWx0IiwiZ2xvYmFsIiwiZGVidWciLCJpbnN0YWxsVHlwZSIsImxvY2siLCJzdGF0ZSIsImxvY2tlZCIsInN0b3JhZ2UiLCJ0eXBlIiwibG9jYWwiLCJzeW5jIiwia2V5cyIsImdldCIsInVwZGF0ZSIsIl90aGlzIiwiZXJyb3IiLCJ1cGRhdGVkU3RvcmFnZSIsInNldCIsInVwZGF0ZUFsbCIsIml0ZW1zIiwiYmFkZ2UiLCJtYXRyaXgiLCJvcHRpb25zIiwiZXh0ZW5kIiwiYnJvd3NlckFjdGlvbiIsInNldFRpdGxlIiwic2V0QmFkZ2VCYWNrZ3JvdW5kQ29sb3IiLCJzZXRCYWRnZVRleHQiLCJ0ZXN0cyIsInJ1blRlc3RzIiwiZ3JvdXAiLCJxdWV1ZSIsIm5leHRGbiIsImdyb3VwRW5kIiwiX3dyYXAiLCJlIiwiZm4iLCJwYXJhbXMiLCJhcHBseSIsInN0b3JhZ2VUZXN0MSIsIm5leHQiLCJncm91cENvbGxhcHNlZCIsInRlc3RLZXlzIiwidGVzdERhdGExIiwidGVzdDEiLCJ0ZXN0MiIsImluaXRpYWwiLCJ0ZXN0RGF0YTIiLCJzZWNvbmRhcnkiLCJyZW1vdmUiLCJzdG9yYWdlVGVzdDIiLCJtb2RhcGkiLCJNb2RBUEkiLCJwcm90b2NvbCIsImRvbWFpbiIsInBhdGgiLCJob21lIiwiY29va2llIiwibG9naW4iLCJmZWVkIiwiYXBpIiwic29uZ3MiLCJwcm9maWxlIiwibWVzc2FnZXMiLCJzdG9yYWdlTW9kZWwiLCJ3YXRjaGxpc3QiLCJ2ZXJzaW9uIiwib3B0aW9uRGVmYXVsdHMiLCJyZW1lbWJlck1lIiwic2hvd0FsZXJ0c09uVG9wIiwidXNlclRhZ3MiLCJ1c2VyVGFnTGlua3MiLCJtb3ZlQ29tbWVudEJveCIsImdyb3VwRmlsdGVycyIsIm1vdmVHcm91cEludml0ZXMiLCJyZWdleCIsIm1lc3NhZ2VMaW5rIiwiZ3JvdXBMaW5rIiwidHJhY2tMaW5rIiwid2F0Y2hsaXN0TW9kZWwiLCJ0cmFjayIsImxpbmsiLCJsaWtlcyIsImRvd25sb2FkcyIsImNvbW1lbnRzIiwibGFzdENvbW1lbnQiLCJtZW1iZXJzIiwiZm9sbG93ZXJzIiwidHJhY2tzIiwiaHRtbCIsInBhcnNlZEh0bWwiLCIkaHRtbCIsInByb2ZpbGVMaW5rIiwiZmluZCIsImF0dHIiLCJ0b2tlbiIsImZpbHRlciIsIm1lIiwiZ2V0SlNPTiIsImZhaWwiLCJzdWNjZXNzIiwiZGF0YSJdLCJtYXBwaW5ncyI6IkFBNkRBLFNBQVNBLE9BQU9DLEVBQVFDLEVBQU9DLEVBQVVDLFFBQ2YsSUFBWEEsSUFBd0JBLEdBQVUsR0FFN0MsSUFBSUMsRUFBVUMsRUFBRUwsR0FFaEJJLEVBQVFFLElBQUlMLEdBQ1pHLEVBQVFHLEdBQUdOLEVBQU9DLEdBSXRCLFNBQVNNLFFBQVFDLEVBQUtQLEdBQ2xCLElBQUlRLEVBQU0sSUFBSUMsZUFDZEQsRUFBSUUsS0FBSyxNQUFPSCxHQUFLLEdBQ3JCQyxFQUFJRyxhQUFlLE9BQ25CSCxFQUFJSSxPQUFTLFdBQ1QsSUFBSUMsRUFBT0MsT0FBT0MsSUFBSUMsZ0JBQWdCQyxLQUFLQyxVQUczQ2xCLEVBQVNhLElBR2JMLEVBQUlXLE9BS1IsU0FBU0MsV0FBV2IsRUFBS2MsRUFBWXJCLFFBQ1YsSUFBWkEsSUFDUEEsRUFBV3FCLEVBQ1hBLEdBQWEsR0FHakIsSUFBSUMsRUFBUSxJQUFJQyxNQUVoQkQsRUFBTVYsT0FBUyxXQUNYLElBQUlZLEVBQVNDLFNBQVNDLGNBQWMsVUFDcENGLEVBQU9HLE1BQVFWLEtBQUtXLGFBQ3BCSixFQUFPSyxPQUFT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LEVBQUV3TSxHQUNWRSxFQUFjRCxFQUFNRSxLQUFLLGNBQWNDLEtBQUssUUFDNUNDLEVBQVFKLEVBQU1LLE9BQU8scUJBQXFCRixLQUFLLFdBNEN2Qy9NLEVBekNSLFNBQVNrTixHQUVaQSxFQUFHaEIsS0FBT1csRUFHVjNGLE9BQU84RixNQUFRQSxFQUlmaE4sRUFBU2tOLElBaUNWL00sRUFBRWdOLFFBQVFqRyxPQUFPc0QsS0FBS0ssS0FBS3VDLEtBQUssV0FFL0J0SixRQUFRa0UsTUFBTSxvREFBcUQsaUNBQWtDLE1BQ25HcUYsUUFBUSxTQUFTQyxHQUNuQixJQUFJSixFQUFLSSxFQUFLQSxNQUFRQSxFQUd0QkosRUFBR0csUUFBVUMsRUFBS0QsUUFHbEJyTixFQUFTa04sUUFVWjdDLE9BQU8xRixVQUFVcUksTUFBUSxXQUFhLE9BQU85RixPQUFPOEYiLCJmaWxlIjoiYXBpLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGV4cG9ydGVkIGhhbmRsZSwgZ2V0QmxvYiwgZ2V0RGF0YVVyaSwgbG9jYWxKU09OLCBzaG93VmlldywgX2ZhY3RvcnkgKi9cclxuXHJcbi8qIVxyXG4gKiBBcHAgaGVscGVycyBhbmQgQ3JBUEkgKENocm9tZSBBUEkgSGVscGVyKVxyXG4gKlxyXG4gKiBAYXV0aG9yIGN5YmVyYml0IChELkouIE1hcmNvbGVzY28pIGRqLm1hcmNvbGVzY29Ab3V0bG9vay5jb21cclxuICogQHZlcnNpb24gMC4xXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIEFwcCBIZWxwZXJzXHJcbiAqL1xyXG5TdHJpbmcucHJvdG90eXBlLmhhc2hDb2RlID0gZnVuY3Rpb24oKXtcclxuICAgIHZhciBoYXNoID0gMCwgaSwgYztcclxuICAgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGhhc2g7XHJcbiAgICBmb3IgKGkgPSAwLCBsID0gdGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcclxuICAgICAgICBjICA9IHRoaXMuY2hhckNvZGVBdChpKTtcclxuICAgICAgICBoYXNoICA9ICgoaGFzaDw8NSktaGFzaCkrYztcclxuICAgICAgICBoYXNoIHw9IDA7IC8vIENvbnZlcnQgdG8gMzJiaXQgaW50ZWdlclxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGhhc2g7XHJcbn07XHJcblxyXG5TdHJpbmcucHJvdG90eXBlLmRlcmVzID0gZnVuY3Rpb24oKSB7XHJcblx0cmV0dXJuIHRoaXMucmVwbGFjZSgvaW1nW14+XSo+L2csIFwiXCIpO1xyXG59O1xyXG5cclxuU3RyaW5nLnByb3RvdHlwZS5kZWNhbWVsID0gZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5yZXBsYWNlKC8oPz1bYS16QS16XSkoPz1bQS1aXSkvZywgXCItXCIpLnRvTG93ZXJDYXNlKCk7XHJcbn07XHJcblxyXG5TdHJpbmcucHJvdG90eXBlLm1hdGNoQW55ID0gZnVuY3Rpb24ocGF0dGVybnMpIHtcclxuICAgIHZhciB0aGF0ID0gdGhpcztcclxuICAgIHZhciBtYXRjaGVkID0gZmFsc2U7XHJcblxyXG4gICAgLy8gSXRlcmF0ZSBwYXR0ZXJucyBhbmQgcmV0dXJuIGtleSBvZiBmaXJzdCBtYXRjaFxyXG4gICAgJC5lYWNoKHBhdHRlcm5zLCBmdW5jdGlvbihpLCB2KSB7XHJcbiAgICAgICAgaWYgKHRoYXQubWF0Y2godikpIHtcclxuICAgICAgICAgICAgbWF0Y2hlZCA9IGk7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gbWF0Y2hlZDtcclxufTtcclxuXHJcbkFycmF5LnByb3RvdHlwZS51bmlxdWUgPSBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB0aGlzLnJlZHVjZShmdW5jdGlvbihwLCBjKSB7XHJcbiAgICAgICAgaWYgKHAuaW5kZXhPZihjKSA8IDApIHAucHVzaChjKTtcclxuICAgICAgICByZXR1cm4gcDtcclxuICAgIH0sIFtdKTtcclxufTtcclxuXHJcbkFycmF5LnByb3RvdHlwZS5kaWZmID0gZnVuY3Rpb24oY29tcGFyZSkge1xyXG5cdHJldHVybiB0aGlzLnJlZHVjZShmdW5jdGlvbihwLCBjKSB7XHJcblx0XHRpZiAoY29tcGFyZS5pbmRleE9mKGMpID09IC0xKSBwLnB1c2goYyk7XHJcblx0XHRyZXR1cm4gcDtcclxuXHR9LCBbXSk7XHJcbn07XHJcblxyXG4vL0FkZC9yZXBsYWNlIGhhbmRsZXJcclxuZnVuY3Rpb24gaGFuZGxlKHRhcmdldCwgZXZlbnQsIGNhbGxiYWNrLCB0cmlnZ2VyKSB7XHJcbiAgICBpZiAodHlwZW9mIHRyaWdnZXIgPT0gXCJ1bmRlZmluZWRcIikgdHJpZ2dlciA9IGZhbHNlO1xyXG5cclxuICAgIHZhciAkdGFyZ2V0ID0gJCh0YXJnZXQpO1xyXG5cclxuICAgICR0YXJnZXQub2ZmKGV2ZW50KTtcclxuICAgICR0YXJnZXQub24oZXZlbnQsIGNhbGxiYWNrKTtcclxufVxyXG5cclxuLy8gR2V0IGJsb2IgVVJMXHJcbmZ1bmN0aW9uIGdldEJsb2IodXJsLCBjYWxsYmFjaykge1xyXG4gICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgeGhyLm9wZW4oXCJHRVRcIiwgdXJsLCB0cnVlKTtcclxuICAgIHhoci5yZXNwb25zZVR5cGUgPSBcImJsb2JcIjtcclxuICAgIHhoci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgYmxvYiA9IHdpbmRvdy5VUkwuY3JlYXRlT2JqZWN0VVJMKHRoaXMucmVzcG9uc2UpO1xyXG5cclxuICAgICAgICAvLyBSdW4gY2FsbGJhY2tcclxuICAgICAgICBjYWxsYmFjayhibG9iKTtcclxuICAgIH07XHJcblxyXG4gICAgeGhyLnNlbmQoKTtcclxufVxyXG5cclxuLy8gR2V0IGRhdGEgVVJJIChvdmVybGF5IHBhcmFtZXRlciBpcyBvcHRpb25hbClcclxuLy8gKHZpYSBodHRwczovL2Rhdmlkd2Fsc2gubmFtZS9jb252ZXJ0LWltYWdlLWRhdGEtdXJpLWphdmFzY3JpcHQpXHJcbmZ1bmN0aW9uIGdldERhdGFVcmkodXJsLCBvdmVybGF5VXJsLCBjYWxsYmFjaykge1xyXG4gICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgY2FsbGJhY2sgPSBvdmVybGF5VXJsO1xyXG4gICAgICAgIG92ZXJsYXlVcmwgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuXHJcbiAgICBpbWFnZS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKTtcclxuICAgICAgICBjYW52YXMud2lkdGggPSB0aGlzLm5hdHVyYWxXaWR0aDsgLy8gb3IgXCJ3aWR0aFwiIGlmIHlvdSB3YW50IGEgc3BlY2lhbC9zY2FsZWQgc2l6ZVxyXG4gICAgICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLm5hdHVyYWxIZWlnaHQ7IC8vIG9yIFwiaGVpZ2h0XCIgaWYgeW91IHdhbnQgYSBzcGVjaWFsL3NjYWxlZCBzaXplXHJcblxyXG4gICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuXHJcbiAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UodGhpcywgMCwgMCk7XHJcblxyXG4gICAgICAgIC8vIERyYXcgb3ZlcmxheVxyXG4gICAgICAgIGlmIChvdmVybGF5VXJsKSB7XHJcbiAgICAgICAgICAgIC8vIENhbGN1bGF0aW9ucyBmb3IgcG9zaXRpb24gYW5kIHNpemVcclxuICAgICAgICAgICAgdmFyIGhhbGZXaWR0aCA9IGNhbnZhcy53aWR0aCAvIDI7XHJcbiAgICAgICAgICAgIHZhciBoYWxmSGVpZ2h0ID0gY2FudmFzLmhlaWdodCAvIDI7XHJcblxyXG4gICAgICAgICAgICB2YXIgb3ZlcmxheSA9IG5ldyBJbWFnZSgpO1xyXG5cclxuICAgICAgICAgICAgb3ZlcmxheS5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIERyYXcgd2hpdGUgYmFja2dyb3VuZCB0byBoYW5kbGUgaW1hZ2VzIHdpdGggdHJhbnNwYXJlbmN5XHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmZpbGxTdHlsZSA9IFwid2hpdGVcIjtcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZmlsbFJlY3QoaGFsZldpZHRoLCBoYWxmSGVpZ2h0LCBoYWxmV2lkdGgsIGhhbGZIZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIERyYXcgb3ZlcmxheVxyXG4gICAgICAgICAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UodGhpcywgaGFsZldpZHRoLCBoYWxmSGVpZ2h0LCBoYWxmV2lkdGgsIGhhbGZIZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgICAgIF9jb250aW51ZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgb3ZlcmxheS5zcmMgPSBvdmVybGF5VXJsO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTm8gb3ZlcmxheVxyXG4gICAgICAgIGVsc2UgX2NvbnRpbnVlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF9jb250aW51ZSgpIHtcclxuICAgICAgICAgICAgLy8gUnVuIGNhbGxiYWNrIHdpdGggZGF0YSBVUkxcclxuICAgICAgICAgICAgY2FsbGJhY2soY2FudmFzLnRvRGF0YVVSTChcImltYWdlL3BuZ1wiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpbWFnZS5zcmMgPSB1cmw7XHJcbn1cclxuXHJcbi8vIEdldC9tb2RpZnkgbG9jYWxTdG9yYWdlIGtleSBhcyBKU09OXHJcbmZ1bmN0aW9uIGxvY2FsSlNPTihrZXksIGpzb24pIHtcclxuICAgIGlmICh0eXBlb2YganNvbiA9PSBcInVuZGVmaW5lZFwiKSB7XHJcbiAgICAgICAgdmFyIHZhbHVlID0gbG9jYWxTdG9yYWdlW2tleV07XHJcblxyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgdmFsdWUgPSAkLnBhcnNlSlNPTih2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKGpzb24gPT09IFwiXCIpIGRlbGV0ZSBsb2NhbFN0b3JhZ2Vba2V5XTtcclxuXHJcbiAgICAgICAgZWxzZSBsb2NhbFN0b3JhZ2Vba2V5XSA9IEpTT04uc3RyaW5naWZ5KGpzb24pO1xyXG4gICAgfVxyXG59XHJcblxyXG4vL0hpZGUgY29udGV4dCwgc2hvdyB2aWV3XHJcbmZ1bmN0aW9uIHNob3dWaWV3KGNvbnRleHQsIHZpZXcsIGZhZGUpIHtcclxuICAgIGlmICh0eXBlb2YgZmFkZSA9PSBcInVuZGVmaW5lZFwiKSBmYWRlID0gMTcwO1xyXG5cclxuICAgIGlmIChmYWRlID4gMCkge1xyXG4gICAgICAgICQoY29udGV4dCkuZmFkZU91dChmYWRlKTtcclxuICAgICAgICAkKHZpZXcpLmRlbGF5KGZhZGUpLmZhZGVJbihmYWRlKTtcclxuICAgIH1cclxuXHJcbiAgICBlbHNlIHtcclxuICAgICAgICAkKGNvbnRleHQpLmhpZGUoKTtcclxuICAgICAgICAkKHZpZXcpLnNob3coKTtcclxuICAgIH1cclxufVxyXG5cclxuLy9DbG9uZSBmYWN0b3J5IGl0ZW1cclxuZnVuY3Rpb24gX2ZhY3RvcnkocGFyZW50LCBrZXkpIHtcclxuXHRyZXR1cm4gJChwYXJlbnQgKyBcIiBcIiArIGtleSkuY2xvbmUoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyQVBJIGhlbHBlcnNcclxuICovXHJcblxyXG4vL0dsb2JhbCBpZGVudGlmaWVyIGZvciBDckFQSSBjbGFzc1xyXG5jcmFwaSA9IG5ldyBDckFQSSgpO1xyXG5cclxuLyoqXHJcbiAqIEdyYWIgZXh0ZW5zaW9uIG1hbmlmZXN0XHJcbiAqXHJcbiAqIEByZXR1cm5zXHR7b2JqZWN0fVx0U2VyaWFsaXphdGlvbiBvZiBmdWxsIG1hbmlmZXN0IGZpbGUgKGZyb20gQVBJIGRvY3MpXHJcbiAqIEBuYW1lXHJcbiAqL1xyXG5DckFQSS5wcm90b3R5cGUubWFuaWZlc3QgPSBmdW5jdGlvbigpIHsgcmV0dXJuIGNocm9tZS5ydW50aW1lLmdldE1hbmlmZXN0KCk7IH07XHJcblxyXG4vKipcclxuICogUmVsb2FkIHRoZSBjdXJyZW50IHBhZ2VcclxuICovXHJcbkNyQVBJLnByb3RvdHlwZS5yZWxvYWQgPSBmdW5jdGlvbigpIHsgbG9jYXRpb24ucmVsb2FkKCk7IH07XHJcblxyXG4vKipcclxuICogUXVpY2stYWNjZXNzIGRlYnVnIHN3aXRjaFxyXG4gKlxyXG4gKiBAdHlwZSBib29sZWFuXHJcbiAqL1xyXG5pZiAoIWxvY2FsSlNPTignY3JhcGlfc2VsZicpKSB7XHJcbiAgICBjaHJvbWUucnVudGltZS5zZW5kTWVzc2FnZSh7IGFjdGlvbjogXCJnZXRTZWxmXCIsIGFzeW5jOiB0cnVlIH0sIGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAvLyBDYWNoZSBtYW5hZ2VtZW50IGluZm9ybWF0aW9uXHJcbiAgICAgICAgbG9jYWxKU09OKCdjcmFwaV9zZWxmJywgcmVzdWx0KTtcclxuXHJcbiAgICAgICAgQ3JBUEkucHJvdG90eXBlLnNlbGYgPSByZXN1bHQ7XHJcblxyXG4gICAgICAgIC8vIFNldCBkZWJ1ZyBmbGFnXHJcbiAgICAgICAgZ2xvYmFsLmRlYnVnID0gcmVzdWx0Lmluc3RhbGxUeXBlID09PSAnZGV2ZWxvcG1lbnQnO1xyXG4gICAgfSk7XHJcbn0gZWxzZSB7XHJcbiAgICBDckFQSS5wcm90b3R5cGUuc2VsZiA9IGxvY2FsSlNPTignY3JhcGlfc2VsZicpO1xyXG59XHJcblxyXG4vKipcclxuICogKFVuKXNldCB3cml0ZSBsb2NrXHJcbiAqL1xyXG5DckFQSS5wcm90b3R5cGUubG9jayA9IGZ1bmN0aW9uKHN0YXRlKSB7XHJcblx0aWYgKHR5cGVvZiBzdGF0ZSA9PSBcInVuZGVmaW5lZFwiKSBzdGF0ZSA9IFwiXCI7XHJcblxyXG5cdGxvY2FsU3RvcmFnZS5jcmFwaV9sb2NrZWQgPSBzdGF0ZTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgbG9jayBzdGF0ZVxyXG4gKi9cclxuQ3JBUEkucHJvdG90eXBlLmxvY2tlZCA9IGZ1bmN0aW9uKCkge1xyXG5cdHJldHVybiBsb2NhbFN0b3JhZ2UuY3JhcGlfbG9ja2VkO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENvbnRhaW5zIHdvcmthcm91bmRzIGZvciB0cmlja3kgYml0cyBpbiB0aGUgQ2hyb21lIEFQSVxyXG4gKi9cclxuZnVuY3Rpb24gQ3JBUEkoKSB7XHJcblx0Y29uc29sZS5sb2coXCIlY0NyQVBJJWMgOjogSW5pdFwiLCBcImZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogZ3JlZW5cIiwgXCJcIik7XHJcblxyXG5cdC8vRGVmYXVsdCBjYWxsYmFjayBmb3IgYWxsIGZ1bmN0aW9uc1xyXG5cdHRoaXMuREVGQVVMVF9DQUxMQkFDSyA9IGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICByZXR1cm4gKHR5cGVvZiBkICE9IFwidW5kZWZpbmVkXCIgPyBkIDogZmFsc2UpO1xyXG4gICAgfTtcclxuXHJcblx0Ly9RdWljayBiYWRnZSBjb2xvcnNcclxuXHR0aGlzLmJhZGdlQ29sb3JzID0ge1xyXG5cdFx0Z3JheTogXCIjOWE5YTlhXCIsXHJcblx0XHRyZWQ6IFwiI2QwMFwiXHJcblx0fTtcclxuXHJcblx0Ly9EZWZhdWx0IGJhZGdlIG9wdGlvbnNcclxuXHR0aGlzLmJhZGdlT3B0aW9ucyA9IHtcclxuXHRcdHRpdGxlOiBmYWxzZSxcclxuXHRcdGNvbG9yOiBmYWxzZSxcclxuXHRcdHRleHQ6IGZhbHNlXHJcblx0fTtcclxuXHJcblx0Ly9TdG9yYWdlIGxvY2sgc3RhdGVcclxuXHRpZiAodHlwZW9mIGxvY2FsU3RvcmFnZS5jcmFwaV9sb2NrZWQgPT0gXCJ1bmRlZmluZWRcIikge1xyXG5cdFx0bG9jYWxTdG9yYWdlLmNyYXBpX2xvY2tlZCA9IFwiXCI7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogR3JhYiBzdG9yYWdlIHNvbHV0aW9uIChzeW5jIG9yIGxvY2FsKVxyXG4gKlxyXG4gKiAkcmV0dXJuc1x0e1N0b3JhZ2VBcmVhfVx0U3RvcmFnZSBzb2x1dGlvbiBmcm9tIGNocm9tZS5zdG9yYWdlXHJcbiAqL1xyXG5DckFQSS5wcm90b3R5cGUuc3RvcmFnZSA9IGZ1bmN0aW9uKHR5cGUpIHtcclxuXHR0eXBlID0gKHR5cGVvZiB0eXBlID09IFwidW5kZWZpbmVkXCIpID8gXCJzeW5jXCIgOiB0eXBlO1xyXG5cclxuXHQvL1BhcnNlIHR5cGVcclxuXHRzd2l0Y2ggKHR5cGUpIHtcclxuXHRcdC8vTG9jYWwgc3RvcmFnZVxyXG5cdFx0Y2FzZSBcImxvY2FsXCI6XHJcblx0XHRcdHJldHVybiBjaHJvbWUuc3RvcmFnZS5sb2NhbDtcclxuXHJcblx0XHQvL1N5bmNlZCBzdG9yYWdlXHJcblx0XHRjYXNlIFwic3luY1wiOlxyXG5cdFx0XHRyZXR1cm4gY2hyb21lLnN0b3JhZ2Uuc3luYztcclxuXHJcblx0XHQvL1Vua25vd24gdHlwZVxyXG5cdFx0ZGVmYXVsdDpcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDbG9uZSBsb2NhbCBzdG9yYWdlXHJcbiAqXHJcbiAqIEBwYXJhbSAgIHtzdHJpbmc9bnVsbH0gICBrZXlzICAgICAgICBQYXNzZWQgZGlyZWN0bHkgYXMgZmlyc3QgcGFyYW1ldGVyIHRvIC5nZXRcclxuICogQHBhcmFtXHR7ZnVuY3Rpb259XHRjYWxsYmFja1x0UmV2aWV2ZXMgY2xvbmVkIHN0b3JhZ2UgYW5kIHJldHVybnMgbW9kaWZpZWQgc3RvcmFnZVxyXG4gKiBAcmV0dXJuc1x0e29iamVjdH1cdFx0XHRcdE1vZGlmaWVkIGNvbnRlbnRzIG9mIHN0b3JhZ2UgZnJvbSBjYWxsYmFja1xyXG4gKi9cclxuQ3JBUEkucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oa2V5cywgY2FsbGJhY2spIHtcclxuICAgIC8vaWYgKHRoaXMuZGVidWcpIGNvbnNvbGUudHJhY2UoXCJjcmFwaS5jbG9uZSBzdGFjayB0cmFjZVwiKTtcclxuXHJcbiAgICBpZiAodHlwZW9mIGtleXMgPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgIGtleXMgPSBudWxsO1xyXG4gICAgICAgIGNhbGxiYWNrID0gdGhpcy5ERUZBVUxUX0NBTExCQUNLO1xyXG4gICAgfVxyXG5cclxuXHRpZiAodHlwZW9mIGNhbGxiYWNrID09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICBjYWxsYmFjayA9IGtleXM7XHJcbiAgICAgICAga2V5cyA9IG51bGw7XHJcbiAgICB9XHJcblxyXG5cdC8vR3JhYiBzdG9yYWdlXHJcblx0dGhpcy5zdG9yYWdlKCkuZ2V0KGtleXMsIGZ1bmN0aW9uKGQpIHtcclxuXHRcdC8vVHJhY2Ugc3RvcmFnZVxyXG5cdFx0Y29uc29sZS5sb2coXCIlY0NyQVBJJWMgOjogQ2xvbmUgc3RvcmFnZTogJU9cIiwgXCJmb250LXdlaWdodDogYm9sZDsgY29sb3I6IGdyZWVuXCIsIFwiXCIsIGQpO1xyXG5cclxuXHRcdC8vUnVuIGNhbGxiYWNrXHJcblx0XHRjYWxsYmFjayhkKTtcclxuXHR9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgc3RvcmFnZSBmb3IgcHJvdmlkZWQga2V5XHJcbiAqXHJcbiAqIEBwYXJhbVx0e1N0cmluZ31cdGtleVx0XHRcdEtleSB0byB1cGRhdGVcclxuICogQHBhcmFtXHR7b2JqZWN0fVx0dmFsdWVcdFx0TmV3IGNvbnRlbnRzIG9mIGtleVxyXG4gKiBAcGFyYW1cdHtmdW5jdGlvbn1cdGNhbGxiYWNrXHRGdW5jdGlvbiB0byBydW4gYWZ0ZXIgdXBkYXRlXHJcbiAqL1xyXG5DckFQSS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSwgY2FsbGJhY2spIHtcclxuXHRpZiAodHlwZW9mIGNhbGxiYWNrID09IFwidW5kZWZpbmVkXCIpIGNhbGxiYWNrID0gdGhpcy5ERUZBVUxUX0NBTExCQUNLO1xyXG5cclxuXHR2YXIgX3RoaXMgPSB0aGlzO1xyXG5cclxuXHQvL1N0b3JhZ2Ugbm90IGxvY2tlZFxyXG5cdGlmICghX3RoaXMubG9ja2VkKCkpIHtcclxuXHRcdHZhciB1cGRhdGVkU3RvcmFnZSA9IHt9O1xyXG5cdFx0dXBkYXRlZFN0b3JhZ2Vba2V5XSA9IHZhbHVlO1xyXG5cclxuXHRcdC8vTG9jayBzdG9yYWdlXHJcblx0XHRfdGhpcy5sb2NrKFwiVXBkYXRlIHN0b3JhZ2VcIik7XHJcblxyXG5cdFx0Ly9VcGRhdGUgc3RvcmFnZVxyXG5cdFx0X3RoaXMuc3RvcmFnZSgpLnNldCh1cGRhdGVkU3RvcmFnZSwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vVW5sb2NrIHN0b3JhZ2VcclxuXHRcdFx0X3RoaXMubG9jaygpO1xyXG5cclxuXHRcdFx0Ly9UcmFjZSB1cGRhdGVkIHN0b3JhZ2VcclxuXHRcdFx0Y29uc29sZS5sb2coXCIlY0NyQVBJJWMgOjogVXBkYXRlIHN0b3JhZ2U6ICVPXCIsIFwiZm9udC13ZWlnaHQ6IGJvbGQ7IGNvbG9yOiBncmVlblwiLCBcIlwiLCB1cGRhdGVkU3RvcmFnZSk7XHJcblxyXG5cdFx0XHQvL1J1biBjYWxsYmFja1xyXG5cdFx0XHRjYWxsYmFjayh2YWx1ZSk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8vU3RvcmFnZSBsb2NrZWRcclxuXHRlbHNlIHtcclxuXHRcdGNvbnNvbGUuZXJyb3IoXCIlY0NyQVBJJWMgOjogU3RvcmFnZSBsb2NrZWQ6ICVvXCIsIFwiZm9udC13ZWlnaHQ6IGJvbGQ7IGNvbG9yOiBncmVlblwiLCBcIlwiLCB0aGlzLmxvY2tlZCk7XHJcblxyXG5cdFx0Ly9SdW4gY2FsbGJhY2tcclxuXHRcdGNhbGxiYWNrKGZhbHNlKTtcclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogVXBkYXRlIGV2ZXJ5dGhpbmcgaW4gc3RvcmFnZVxyXG4gKlxyXG4gKiBAcGFyYW1cdHtvYmplY3R9XHRpdGVtc1x0XHROZXcgY29udGVudHMgb2Ygc3RvcmFnZVxyXG4gKiBAcGFyYW1cdHtmdW5jdGlvbn1cdGNhbGxiYWNrXHRGdW5jdGlvbiB0byBydW4gYWZ0ZXIgdXBkYXRlXHJcbiAqL1xyXG5DckFQSS5wcm90b3R5cGUudXBkYXRlQWxsID0gZnVuY3Rpb24oaXRlbXMsIGNhbGxiYWNrKSB7XHJcblx0aWYgKHR5cGVvZiBjYWxsYmFjayA9PSBcInVuZGVmaW5lZFwiKSBjYWxsYmFjayA9IHRoaXMuREVGQVVMVF9DQUxMQkFDSztcclxuXHJcblx0dmFyIF90aGlzID0gdGhpcztcclxuXHJcblx0Ly9TdG9yYWdlIG5vdCBsb2NrZWRcclxuXHRpZiAoIV90aGlzLmxvY2tlZCgpKSB7XHJcblx0XHQvL0xvY2sgc3RvcmFnZVxyXG5cdFx0X3RoaXMubG9jayhcIlVwZGF0ZSBhbGxcIik7XHJcblxyXG5cdFx0Ly9VcGRhdGUgc3RvcmFnZVxyXG5cdFx0X3RoaXMuc3RvcmFnZSgpLnNldChpdGVtcywgZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vVW5sb2NrIHN0b3JhZ2VcclxuXHRcdFx0X3RoaXMubG9jaygpO1xyXG5cclxuXHRcdFx0Ly9UcmFjZSB1cGRhdGVkIHN0b3JhZ2VcclxuXHRcdFx0Y29uc29sZS5sb2coXCIlY0NyQVBJJWMgOjogVXBkYXRlIGFsbDogJU9cIiwgXCJmb250LXdlaWdodDogYm9sZDsgY29sb3I6IGdyZWVuXCIsIFwiXCIsIGl0ZW1zKTtcclxuXHJcblx0XHRcdC8vUnVuIGNhbGxiYWNrXHJcblx0XHRcdGNhbGxiYWNrKHRydWUpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvL1N0b3JhZ2UgbG9ja2VkXHJcblx0ZWxzZSB7XHJcblx0XHRjb25zb2xlLmVycm9yKFwiJWNDckFQSSVjIDo6IFN0b3JhZ2UgbG9ja2VkOiAlb1wiLCBcImZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogZ3JlZW5cIiwgXCJcIiwgdGhpcy5sb2NrZWQpO1xyXG5cclxuXHRcdC8vUnVuIGNhbGxiYWNrXHJcblx0XHRjYWxsYmFjayhmYWxzZSk7XHJcblx0fVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIE1vZGlmeSBleHRlbnNpb24gYmFkZ2UgZnJvbSBzZXR0aW5ncyBtYXRyaXhcclxuICpcclxuICogQHBhcmFtXHR7b2JqZWN0fVx0bWF0cml4XHRcdEJhZGdlIG9wdGlvbnNcclxuICovXHJcbkNyQVBJLnByb3RvdHlwZS5iYWRnZSA9IGZ1bmN0aW9uKG1hdHJpeCkge1xyXG5cdHZhciBvcHRpb25zID0gJC5leHRlbmQoe30sIHRoaXMuYmFkZ2VPcHRpb25zLCBtYXRyaXgpO1xyXG5cdHZhciBjb2xvciA9ICh0eXBlb2YgdGhpcy5iYWRnZUNvbG9yc1tvcHRpb25zLmNvbG9yXSAhPSBcInVuZGVmaW5lZFwiID8gdGhpcy5iYWRnZUNvbG9yc1tvcHRpb25zLmNvbG9yXSA6IG9wdGlvbnMuY29sb3IpO1xyXG5cclxuXHRpZiAob3B0aW9ucy50aXRsZSAhPT0gZmFsc2UpIGNocm9tZS5icm93c2VyQWN0aW9uLnNldFRpdGxlKHt0aXRsZTogb3B0aW9ucy50aXRsZX0pO1xyXG5cdGlmIChjb2xvciAhPT0gZmFsc2UpIGNocm9tZS5icm93c2VyQWN0aW9uLnNldEJhZGdlQmFja2dyb3VuZENvbG9yKHtjb2xvcjogY29sb3J9KTtcclxuXHRpZiAob3B0aW9ucy50ZXh0ICE9PSBmYWxzZSkgY2hyb21lLmJyb3dzZXJBY3Rpb24uc2V0QmFkZ2VUZXh0KHt0ZXh0OiBvcHRpb25zLnRleHR9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTdG9yYWdlIGZvciBDckFQSSB0ZXN0c1xyXG4gKi9cclxuQ3JBUEkucHJvdG90eXBlLnRlc3RzID0ge307XHJcblxyXG4vKipcclxuICogUnVuIGFsbCB0ZXN0c1xyXG4gKi9cclxuQ3JBUEkucHJvdG90eXBlLnJ1blRlc3RzID0gZnVuY3Rpb24oKSB7XHJcbiAgICBjb25zb2xlLmdyb3VwKFwiPT0gQ3JBUEkgVGVzdHMgPT1cIik7XHJcbiAgICB0cnkge1xyXG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHF1ZXVlID0gW107XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFzc3VtZSBhbiBhcnJheSBvZiBuIGZ1bmN0aW9ucywgd2hlcmUgKCk9ZGlyZWN0IGNhbGwsIFtdPXN0YWNrZWQgY2FsbCwgaT1pbmRleCBvZiBxdWV1ZVxyXG4gICAgICAgICAqICAgRm9yIHRoZSBmaXJzdCBmdW5jdGlvbiwgaXQgc2hvdWxkIGJlIChpICsgMCkuY2FsbChfdGhpcywgW2kgKyAxXSlcclxuICAgICAgICAgKiAgIEZvciB0aGUgbmV4dCBmdW5jdGlvbiwgaXQgc2hvdWxkIGJlIChpICsgMSkuY2FsbChfdGhpcywgW2kgKyAyXSlcclxuICAgICAgICAgKiAgIEZvciB0aGUgc2Vjb25kIHRvIGxhc3QgZnVuY3Rpb24sIGl0IHNob3VsZCBiZSAoaSArIG4gLSAxKS5jYWxsKF90aGlzLCBpICsgbilcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqICAgcXVldWUgY29udGFpbnMgaXRlcmF0ZWQgZnVuY3Rpb25zLiBTdGFjayBuZWVkcyB0byBiZSBnZW5lcmF0ZWQgaW4gcmV2ZXJzZSBxdWV1ZSBvcmRlci5cclxuICAgICAgICAgKi9cclxuXHJcbiAgICAgICAgJC5lYWNoKF90aGlzLnRlc3RzLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgcXVldWUucHVzaCh0aGlzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcInF1ZXVlOiAlb1wiLCBxdWV1ZSk7XHJcblxyXG4gICAgICAgIHZhciBuZXh0Rm4gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIj09IEVuZCBvZiBUZXN0cyA9PVwiKTtcclxuICAgICAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZvciAoaSA9IHF1ZXVlLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XHJcbiAgICAgICAgICAgIG5leHRGbiA9IF93cmFwKHF1ZXVlW2ldLCBfdGhpcywgW25leHRGbl0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbmV4dEZuKCk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gX3dyYXAoZm4sIGNvbnRleHQsIHBhcmFtcykge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgZm4uYXBwbHkoY29udGV4dCwgcGFyYW1zKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59O1xyXG5cclxuLyoqXHJcbiAqIFRlc3QgQ2hyb21lIHN0b3JhZ2UgZnVuY3Rpb25zXHJcbiAqL1xyXG5DckFQSS5wcm90b3R5cGUudGVzdHMuc3RvcmFnZVRlc3QxID0gZnVuY3Rpb24obmV4dCkge1xyXG4gICAgY29uc29sZS5ncm91cENvbGxhcHNlZChcIlRlc3QgQ2hyb21lIHN0b3JhZ2UgZnVuY3Rpb25zXCIpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgICAgICBjb25zb2xlLmxvZyhcInN0b3JhZ2VUZXN0IHRoaXM6ICVvXCIsIHRoaXMpO1xyXG5cclxuICAgICAgICB2YXIgdGVzdEtleXMgPSBbXCJ0ZXN0MVwiLCBcInRlc3QyXCJdO1xyXG4gICAgICAgIHZhciB0ZXN0RGF0YTEgPSB7XHJcbiAgICAgICAgICAgIHRlc3QxOiBcInJvb3Qgc2V0XCIsXHJcbiAgICAgICAgICAgIHRlc3QyOiB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsOiBcImRhdGFcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgdGVzdERhdGEyID0ge1xyXG4gICAgICAgICAgICB0ZXN0Mjoge1xyXG4gICAgICAgICAgICAgICAgc2Vjb25kYXJ5OiBcImRhdGFcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcIkNsZWFyaW5nIHRlc3Qgc3RvcmFnZS4uLlwiKTtcclxuICAgICAgICBfdGhpcy5zdG9yYWdlKCkucmVtb3ZlKHRlc3RLZXlzLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgX3RoaXMuc3RvcmFnZSgpLmdldCh0ZXN0S2V5cywgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIkJsYW5rIHN0b3JhZ2U6ICVzXCIsIEpTT04uc3RyaW5naWZ5KGQpKTtcclxuXHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKFwiU2V0dGluZyB0ZXN0RGF0YTE6ICVvXCIsIHRlc3REYXRhMSk7XHJcbiAgICAgICAgICAgICAgICBfdGhpcy5zdG9yYWdlKCkuc2V0KHRlc3REYXRhMSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RvcmFnZSgpLmdldCh0ZXN0S2V5cywgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKFwiUmVzdWx0OiAlc1wiLCBKU09OLnN0cmluZ2lmeShkKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKFwiU2V0dGluZyB0ZXN0RGF0YTI6ICVvXCIsIHRlc3REYXRhMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnN0b3JhZ2UoKS5zZXQoJC5leHRlbmQodHJ1ZSwge30sIGQsIHRlc3REYXRhMiksIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3RvcmFnZSgpLmdldCh0ZXN0S2V5cywgZnVuY3Rpb24oZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoXCJSZXN1bHQ6ICVzXCIsIEpTT04uc3RyaW5naWZ5KGQpKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICBjb25zb2xlLmdyb3VwRW5kKCk7XHJcbiAgICB9XHJcbn07XHJcblxyXG4vKipcclxuICogVGVzdCBDckFQSSBzdG9yYWdlIGZ1bmN0aW9uc1xyXG4gKi9cclxuQ3JBUEkucHJvdG90eXBlLnRlc3RzLnN0b3JhZ2VUZXN0MiA9IGZ1bmN0aW9uKG5leHQpIHtcclxuICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQoXCJUZXN0IENyQVBJIHN0b3JhZ2UgZnVuY3Rpb25zXCIpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xyXG5cclxuICAgICAgICB2YXIgdGVzdEtleXMgPSBbXCJ0ZXN0MVwiLCBcInRlc3QyXCJdO1xyXG4gICAgICAgIHZhciB0ZXN0RGF0YTEgPSB7XHJcbiAgICAgICAgICAgIHRlc3QxOiBcInJvb3Qgc2V0XCIsXHJcbiAgICAgICAgICAgIHRlc3QyOiB7XHJcbiAgICAgICAgICAgICAgICBpbml0aWFsOiBcImRhdGFcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgICAgICB2YXIgdGVzdERhdGEyID0ge1xyXG4gICAgICAgICAgICB0ZXN0Mjoge1xyXG4gICAgICAgICAgICAgICAgc2Vjb25kYXJ5OiBcImRhdGFcIlxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcIkNsZWFyaW5nIHRlc3Qgc3RvcmFnZS4uLlwiKTtcclxuICAgICAgICBfdGhpcy5zdG9yYWdlKCkucmVtb3ZlKHRlc3RLZXlzLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgX3RoaXMuY2xvbmUodGVzdEtleXMsIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZGVidWcoXCJCbGFuayBzdG9yYWdlOiAlc1wiLCBKU09OLnN0cmluZ2lmeShkKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlNldHRpbmcgdGVzdERhdGExOiAlb1wiLCB0ZXN0RGF0YTEpO1xyXG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlQWxsKHRlc3REYXRhMSwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xvbmUodGVzdEtleXMsIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlJlc3VsdDogJXNcIiwgSlNPTi5zdHJpbmdpZnkoZCkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5kZWJ1ZyhcIlNldHRpbmcgdGVzdERhdGEyOiAlb1wiLCB0ZXN0RGF0YTIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy51cGRhdGVBbGwoJC5leHRlbmQodHJ1ZSwge30sIGQsIHRlc3REYXRhMiksIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xvbmUodGVzdEtleXMsIGZ1bmN0aW9uKGQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmRlYnVnKFwiUmVzdWx0OiAlc1wiLCBKU09OLnN0cmluZ2lmeShkKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZ3JvdXBFbmQoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV4dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgY29uc29sZS5ncm91cEVuZCgpO1xyXG4gICAgfVxyXG59O1xyXG4iLCIvKiFcclxuICogTW9kQVBJIChNb2RhdGlvbiBBUEkpXHJcbiAqXHJcbiAqIEBhdXRob3IgY3liZXJiaXQgKEQuSi4gTWFyY29sZXNjbykgZGoubWFyY29sZXNjb0BvdXRsb29rLmNvbVxyXG4gKiBAdmVyc2lvbiAyLjBcclxuICovXHJcblxyXG4vL0dsb2JhbCBpZGVudGlmaWVyIGZvciBNb2RBUEkgY2xhc3NcclxubW9kYXBpID0gbmV3IE1vZEFQSSgpO1xyXG5cclxuLy9DbG9uZSBtYW5pZmVzdCAod2lsbCBtb3ZlIHRvIENyQVBJKVxyXG5tb2RhcGkubWFuaWZlc3QgPSBjcmFwaS5tYW5pZmVzdCgpO1xyXG5cclxuLy9VUkkgY29uc3RhbnRzXHJcbnZhciBwcm90b2NvbCA9IFwiaHR0cHM6Ly9cIjtcclxudmFyIGRvbWFpbiA9IFwic291bmRhdGlvbi5jb21cIjtcclxuXHJcbi8vRGVmaW5lIGdsb2JhbCB2YXJpYWJsZXNcclxudmFyIGdsb2JhbCA9IHtcclxuXHQvLyBUaGlzIGtleSBpcyBzZXQgY29ycmVjdGx5IGJ5IENyQVBJIFwiYXQgc29tZSBwb2ludFwiIG9uIGZpcnN0IGxvYWQuIFRoaXNcclxuXHQvLyBsb2dpYyBwcm90ZWN0cyBhZ2FpbnN0IGZhdGFsIHJ1bnRpbWUgZXJyb3JzIG9uIGZpcnN0IGluc3RhbGwuXHJcblx0ZGVidWc6IGNyYXBpLnNlbGYgPyBjcmFwaS5zZWxmLmluc3RhbGxUeXBlID09PSAnZGV2ZWxvcG1lbnQnIDogZmFsc2UsXHJcblxyXG5cdC8vIEdlbmVyYXRlZCBwYXRocyBmb3IgY29tbW9uIGxvY2F0aW9uc1xyXG5cdHBhdGg6IHtcclxuXHRcdHByb3RvY29sOiBwcm90b2NvbCxcclxuXHRcdGRvbWFpbjogZG9tYWluLFxyXG5cdFx0aG9tZTogcHJvdG9jb2wgKyBkb21haW4sXHJcblx0XHRjb29raWU6IHByb3RvY29sICsgZG9tYWluLFxyXG5cdFx0bG9naW46IHByb3RvY29sICsgZG9tYWluICsgXCI/bG9naW49eWVzXCIsXHJcblx0XHRmZWVkOiBwcm90b2NvbCArIGRvbWFpbiArIFwiL2ZlZWRcIixcclxuXHRcdGFwaTogcHJvdG9jb2wgKyBcImFwaS5cIiArIGRvbWFpbiArIFwiL21lXCIsXHJcblx0XHRzb25nczogcHJvdG9jb2wgKyBcImFwaS5cIiArIGRvbWFpbiArIFwiL3NvbmdzXCIsXHJcblx0XHRwcm9maWxlOiBwcm90b2NvbCArIGRvbWFpbiArIFwiL2FjY291bnQvcHJvZmlsZVwiLFxyXG5cdFx0bWVzc2FnZXM6IHByb3RvY29sICsgZG9tYWluICsgXCIvYWNjb3VudC9tZXNzYWdlc1wiXHJcblx0fSxcclxuXHJcblx0Ly8gQ29va2llIHRvIGNoYW5nZSBmb3IgUmVtZW1iZXIgTWUgbW9kXHJcblx0Y29va2llOiBcIl9zb3VuZGF0aW9uX3Nlc3Npb25cIixcclxuXHJcblx0Ly8gU3RvcmFnZSBtb2RlbFxyXG5cdHN0b3JhZ2VNb2RlbDoge1xyXG5cdFx0b3B0aW9uczoge30sXHJcblx0XHR3YXRjaGxpc3Q6IFtdLFxyXG5cdFx0dmVyc2lvbjogXCJcIlxyXG5cdH0sXHJcblxyXG5cdC8vIE9wdGlvbiBkZWZhdWx0cyB1c2VkIGZvciB1cGRhdGVzIG9yIG5ldyBpbnN0YWxsc1xyXG5cdG9wdGlvbkRlZmF1bHRzOiB7XHJcblx0XHQvKipcclxuXHRcdCAqIEdsb2JhbFxyXG5cdFx0ICovXHJcblxyXG5cdFx0Ly8gTG9naW5cclxuXHRcdHJlbWVtYmVyTWU6IGZhbHNlLFxyXG5cclxuXHRcdC8qKlxyXG5cdFx0ICogQ29tbXVuaXR5XHJcblx0XHQgKi9cclxuXHJcblx0XHQvLyBHZW5lcmFsXHJcblx0XHRzaG93QWxlcnRzT25Ub3A6IGZhbHNlLFxyXG5cclxuXHRcdC8vIFdhdGNobGlzdFxyXG5cdFx0d2F0Y2hsaXN0OiBmYWxzZSxcclxuXHJcblx0XHQvLyBDb21tZW50c1xyXG5cdFx0dXNlclRhZ3M6IHRydWUsXHJcblx0XHR1c2VyVGFnTGlua3M6IGZhbHNlLFxyXG5cdFx0bW92ZUNvbW1lbnRCb3g6IHRydWUsXHJcblxyXG5cdFx0Ly8gR3JvdXBzXHJcblx0XHRncm91cEZpbHRlcnM6IHRydWUsXHJcblx0XHRtb3ZlR3JvdXBJbnZpdGVzOiB0cnVlXHJcblx0fSxcclxuXHJcblx0Ly8gUmVndWxhciBleHByZXNzaW9ucyB0byBtYXRjaCBjb21tb24gc3RyaW5nc1xyXG5cdHJlZ2V4OiB7XHJcblx0XHRtZXNzYWdlTGluazogL1xcL2FjY291bnRcXC9tZXNzYWdlc1xcL1xcZCskLyxcclxuXHRcdGdyb3VwTGluazogL1xcL2dyb3VwXFwvLyxcclxuXHRcdHRyYWNrTGluazogL1xcL3VzZXJcXC8uKlxcL3RyYWNrXFwvL1xyXG5cdH0sXHJcblxyXG5cdC8vIFdhdGNobGlzdCBtb2RlbFxyXG5cdHdhdGNobGlzdE1vZGVsOiB7XHJcblx0XHR0cmFjazoge1xyXG5cdFx0XHRsaW5rOiBcIlwiLFxyXG5cdFx0XHRsaWtlczogMCxcclxuXHRcdFx0ZG93bmxvYWRzOiAwLFxyXG5cdFx0XHRjb21tZW50czogMFxyXG5cdFx0fSxcclxuXHJcblx0XHRncm91cDoge1xyXG5cdFx0XHRsaW5rOiBcIlwiLFxyXG5cdFx0XHRsYXN0Q29tbWVudDogXCJcIixcclxuXHRcdFx0bWVtYmVyczogMCxcclxuXHRcdFx0Zm9sbG93ZXJzOiAwLFxyXG5cdFx0XHR0cmFja3M6IDBcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogQ29udGFpbnMgaGVscGVyIGZ1bmN0aW9ucyBzcGVjaWZpYyB0byBNb2RhdGlvblxyXG4gKi9cclxuZnVuY3Rpb24gTW9kQVBJKCkge1xyXG5cdGNvbnNvbGUubG9nKFwiJWNNb2RBUEklYyA6OiBJbml0XCIsIFwiZm9udC13ZWlnaHQ6IGJvbGQ7IGNvbG9yOiAjZjYwXCIsIFwiXCIpO1xyXG5cclxuXHQvL0RlZmF1bHQgY2FsbGJhY2sgZm9yIGFsbCBmdW5jdGlvbnNcclxuXHR0aGlzLkRFRkFVTFRfQ0FMTEJBQ0sgPSBmdW5jdGlvbigpe307XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCB1c2VyIGluZm9ybWF0aW9uIGZyb20gU291bmRhdGlvbiBBUElcclxuICpcclxuICogQHJldHVybnNcdHtvYmplY3R9XHRVc2VyIGluZm9ybWF0aW9uXHJcbiAqL1xyXG5Nb2RBUEkucHJvdG90eXBlLmxvZ2luID0gZnVuY3Rpb24oY2FsbGJhY2spIHtcclxuXHRpZiAodHlwZW9mIGNhbGxiYWNrID09IFwidW5kZWZpbmVkXCIpIGNhbGxiYWNrID0gdGhpcy5ERUZBVUxUX0NBTExCQUNLO1xyXG5cclxuXHRjb25zb2xlLmxvZyhcIiVjTW9kQVBJJWMgOjogTG9naW5cIiwgXCJmb250LXdlaWdodDogYm9sZDsgY29sb3I6ICNmNjBcIiwgXCJcIik7XHJcblxyXG5cdC8vUGluZyBTb3VuZGF0aW9uIHRvIHNldCBzZXNzaW9uIGNvb2tpZVxyXG5cdCQuZ2V0KGdsb2JhbC5wYXRoLmhvbWUsIGZ1bmN0aW9uKGh0bWwpIHtcclxuXHRcdHZhciBwYXJzZWRIdG1sID0gaHRtbC5kZXJlcygpO1xyXG5cdFx0dmFyICRodG1sID0gJChwYXJzZWRIdG1sKTtcclxuXHRcdHZhciBwcm9maWxlTGluayA9ICRodG1sLmZpbmQoXCIudXNlci1saW5rXCIpLmF0dHIoXCJocmVmXCIpO1xyXG5cdFx0dmFyIHRva2VuID0gJGh0bWwuZmlsdGVyKFwiW25hbWU9Y3NyZi10b2tlbl1cIikuYXR0cihcImNvbnRlbnRcIik7XHJcblxyXG5cdFx0Ly9HcmFiIFNvdW5kYXRpb24gdXNlclxyXG5cdFx0X21lKGZ1bmN0aW9uKG1lKSB7XHJcblx0XHRcdC8vSW5qZWN0IGFkZGl0aW9uYWwgcHJvcGVydGllc1xyXG5cdFx0XHRtZS5saW5rID0gcHJvZmlsZUxpbms7XHJcblxyXG5cdFx0XHQvL0dsb2JhbGl6ZSB0b2tlblxyXG5cdFx0XHRnbG9iYWwudG9rZW4gPSB0b2tlbjtcclxuXHJcblx0XHRcdC8vUGFzcyB1c2VyIG9iamVjdCB0byBjYWxsYmFja1xyXG5cdFx0XHQvL0FueSBmYWlsdXJlIGhlcmUgc2hvdWxkIGJlIGhhbmRsZWQgaW4gdGhlIGNhbGxiYWNrXHJcblx0XHRcdGNhbGxiYWNrKG1lKTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG5cclxuXHQvL0dyYWIgU291bmRhdGlvbiB1c2VyIChhdHRlbXB0IDEpXHJcblx0LypfbWUoZnVuY3Rpb24obWUpIHtcclxuXHRcdC8vQXR0ZW1wdCAxIGZhaWxlZFxyXG5cdFx0aWYgKCFtZS5zdWNjZXNzKSB7XHJcblx0XHRcdC8vTG9nIGZhaWx1cmVcclxuXHRcdFx0Y29uc29sZS53YXJuKFwiQXR0ZW1wdCAxIGZhaWxlZCEgUGluZ2luZyBTb3VuZGF0aW9uLi4uXCIpO1xyXG5cclxuXHRcdFx0Ly9QaW5nIFNvdW5kYXRpb24gdG8gc2V0IHNlc3Npb24gY29va2llXHJcblx0XHRcdCQuZ2V0KGdsb2JhbC5wYXRoLmhvbWUpLmFsd2F5cyhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHR2YXIgYXJncyA9IGFyZ3VtZW50cztcclxuXHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJsb2dpbiBhcmdzOiAlb1wiLCBhcmdzKTtcclxuXHJcblx0XHRcdFx0X21lKGZ1bmN0aW9uKG1lKSB7XHJcblx0XHRcdFx0XHQvL1Bhc3MgdXNlciBvYmplY3QgdG8gY2FsbGJhY2tcclxuXHRcdFx0XHRcdC8vQW55IGZhaWx1cmUgaGVyZSBzaG91bGQgYmUgaGFuZGxlZCBpbiB0aGUgY2FsbGJhY2tcclxuXHRcdFx0XHRcdGNhbGxiYWNrKG1lKTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly9BdHRlbXB0IDEgc3VjY2VlZGVkXHJcblx0XHRlbHNlIHtcclxuXHRcdFx0Ly9QYXNzIHVzZXIgb2JqZWN0IHRvIGNhbGxiYWNrXHJcblx0XHRcdGNhbGxiYWNrKG1lKTtcclxuXHRcdH1cclxuXHR9KTsqL1xyXG5cclxuXHRmdW5jdGlvbiBfbWUoY2FsbGJhY2spIHtcclxuXHRcdCQuZ2V0SlNPTihnbG9iYWwucGF0aC5hcGkpLmZhaWwoZnVuY3Rpb24oKSB7XHJcblx0XHRcdC8vTG9nIGZhaWx1cmVcclxuXHRcdFx0Y29uc29sZS5lcnJvcihcIiVjTW9kQVBJJWMgOjogVW5hYmxlIHRvIGNvbm5lY3QgdG8gU291bmRhdGlvbiBBUElcIiwgXCJmb250LXdlaWdodDogYm9sZDsgY29sb3I6ICNmNjBcIiwgXCJcIik7XHJcblx0XHR9KS5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0dmFyIG1lID0gZGF0YS5kYXRhIHx8IGRhdGE7XHJcblxyXG5cdFx0XHQvL0luamVjdCBzdWNjZXNzXHJcblx0XHRcdG1lLnN1Y2Nlc3MgPSBkYXRhLnN1Y2Nlc3M7XHJcblxyXG5cdFx0XHQvL1J1biBjYWxsYmFja1xyXG5cdFx0XHRjYWxsYmFjayhtZSk7XHJcblx0XHR9KTtcclxuXHR9XHJcbn07XHJcblxyXG4vKipcclxuICogR2V0IGN1cnJlbnQgYXV0aGVudGljaXR5IHRva2VuXHJcbiAqXHJcbiAqIEByZXR1cm5zXHR7c3RyaW5nfVx0QXV0aGVudGljaXR5IHRva2VuXHJcbiAqL1xyXG5Nb2RBUEkucHJvdG90eXBlLnRva2VuID0gZnVuY3Rpb24oKSB7IHJldHVybiBnbG9iYWwudG9rZW47IH07XHJcbiJdfQ==
