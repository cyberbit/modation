$(function(){$.get(global.path.messages+"/7016",function(b){var a=$(b).find(".main");b=a.find(".messages");a.find("form.new_message").serializeArray();if(b.length){var a=a.find(".pagination").prev("h2").find("a"),f=a.attr("href"),e=$(".discussion");console.info("Loading conversation with %o...",a.text());b=parseMessages(b);$.each(b,function(b,a){var c=_factory(".factory",".modation-message");c.find(".avatar img").attr("src",a.img);c.find(".modation-messages > p").text(a.body);c.find(".name").text(a.user);
c.find(".age").text(a.age);c.addClass(a.link==f?"other":"self");e.append(c)});console.info("Loaded! %o",b)}else console.error("There was a problem parsing the conversation page!")})});
function parseMessages(b){b=$(b);var a=[];b.is(".messages")?b.find(".message").each(function(b,e){var d=$(this),g=d.find("img").first(),c=d.find(".content"),d=c.find("h4").first(),h=c.find(".age"),c=c.find(".body");a.push({img:g.attr("src"),user:d.text(),link:d.find("a").attr("href"),age:h.text(),body:c.html()})}):console.error("Invalid message container!");return a};
