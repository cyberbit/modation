String.prototype.hashCode=function(){var a=0,b,c;if(0==this.length)return a;b=0;for(l=this.length;b<l;b++)c=this.charCodeAt(b),a=(a<<5)-a+c,a|=0;return a};String.prototype.deres=function(){return this.replace(/img[^>]*>/g,"")};String.prototype.decamel=function(){return this.replace(/(?=[a-zA-z])(?=[A-Z])/g,"-").toLowerCase()};Array.prototype.unique=function(){return this.reduce(function(a,b){0>a.indexOf(b)&&a.push(b);return a},[])};
Array.prototype.diff=function(a){return this.reduce(function(b,c){-1==a.indexOf(c)&&b.push(c);return b},[])};function handle(a,b,c,d){a=$(a);a.off(b);a.on(b,c)}function showView(a,b,c){"undefined"==typeof c&&(c=170);$(a).fadeOut(c);$(b).delay(c).fadeIn(c)}function _factory(a,b){return $(a+" "+b).clone()}crapi=new CrAPI;CrAPI.prototype.manifest=function(){return chrome.runtime.getManifest()};CrAPI.prototype.reload=function(){location.reload()};CrAPI.prototype.debug=crapi.manifest().debug;
CrAPI.prototype.lock=function(a){"undefined"==typeof a&&(a="");localStorage.crapi_locked=a};CrAPI.prototype.locked=function(){return localStorage.crapi_locked};function CrAPI(){console.log("%cCrAPI%c :: Init","font-weight: bold; color: green","");this.DEFAULT_CALLBACK=function(a){return"undefined"!=typeof a?a:!1};this.badgeColors={gray:"#9a9a9a",red:"#d00"};this.badgeOptions={title:!1,color:!1,text:!1};"undefined"==typeof localStorage.crapi_locked&&(localStorage.crapi_locked="")}
CrAPI.prototype.storage=function(a){switch("undefined"==typeof a?"sync":a){case "local":return chrome.storage.local;case "sync":return chrome.storage.sync;default:return!1}};CrAPI.prototype.clone=function(a,b){"undefined"==typeof a&&(a=null,b=this.DEFAULT_CALLBACK);"undefined"==typeof b&&(b=a,a=null);this.storage().get(a,function(a){console.log("%cCrAPI%c :: Clone storage: %O","font-weight: bold; color: green","",a);b(a)})};
CrAPI.prototype.update=function(a,b,c){"undefined"==typeof c&&(c=this.DEFAULT_CALLBACK);var d=this;if(d.locked())console.error("%cCrAPI%c :: Storage locked: %o","font-weight: bold; color: green","",this.locked),c(!1);else{var e={};e[a]=b;d.lock("Update storage");d.storage().set(e,function(){d.lock();console.log("%cCrAPI%c :: Update storage: %O","font-weight: bold; color: green","",e);c(b)})}};
CrAPI.prototype.updateAll=function(a,b){"undefined"==typeof b&&(b=this.DEFAULT_CALLBACK);var c=this;c.locked()?(console.error("%cCrAPI%c :: Storage locked: %o","font-weight: bold; color: green","",this.locked),b(!1)):(c.lock("Update all"),c.storage().set(a,function(){c.lock();console.log("%cCrAPI%c :: Update all: %O","font-weight: bold; color: green","",a);b()}))};
CrAPI.prototype.badge=function(a){a=$.extend({},this.badgeOptions,a);var b="undefined"!=typeof this.badgeColors[a.color]?this.badgeColors[a.color]:a.color;!1!==a.title&&chrome.browserAction.setTitle({title:a.title});!1!==b&&chrome.browserAction.setBadgeBackgroundColor({color:b});!1!==a.text&&chrome.browserAction.setBadgeText({text:a.text})};CrAPI.prototype.tests={};
CrAPI.prototype.runTests=function(){function a(a,b,c){return function(){a.apply(b,c)}}console.group("== CrAPI Tests ==");try{var b=[];$.each(this.tests,function(){b.push(this)});console.debug("queue: %o",b);var c=function(a){console.debug("== End of Tests ==");console.groupEnd()};for(i=b.length-1;0<=i;i--)c=a(b[i],this,[c]);c()}catch(d){console.error(d),console.groupEnd()}};
CrAPI.prototype.tests.storageTest1=function(a){console.groupCollapsed("Test Chrome storage functions");try{var b=this;console.log("storageTest this: %o",this);var c=["test1","test2"],d={test1:"root set",test2:{initial:"data"}},e={test2:{secondary:"data"}};console.debug("Clearing test storage...");b.storage().remove(c,function(){b.storage().get(c,function(f){console.debug("Blank storage: %s",JSON.stringify(f));console.debug("Setting testData1: %o",d);b.storage().set(d,function(){b.storage().get(c,
function(d){console.debug("Result: %s",JSON.stringify(d));console.debug("Setting testData2: %o",e);b.storage().set($.extend(!0,{},d,e),function(){b.storage().get(c,function(b){console.debug("Result: %s",JSON.stringify(b));console.groupEnd();a()})})})})})})}catch(f){console.error(f),console.groupEnd()}};
CrAPI.prototype.tests.storageTest2=function(a){console.groupCollapsed("Test CrAPI storage functions");try{var b=this,c=["test1","test2"],d={test1:"root set",test2:{initial:"data"}},e={test2:{secondary:"data"}};console.debug("Clearing test storage...");b.storage().remove(c,function(){b.clone(c,function(f){console.debug("Blank storage: %s",JSON.stringify(f));console.debug("Setting testData1: %o",d);b.updateAll(d,function(){b.clone(c,function(d){console.debug("Result: %s",JSON.stringify(d));console.debug("Setting testData2: %o",
e);b.updateAll($.extend(!0,{},d,e),function(){b.clone(c,function(b){console.debug("Result: %s",JSON.stringify(b));console.groupEnd();a()})})})})})})}catch(f){console.error(f),console.groupEnd()}};
